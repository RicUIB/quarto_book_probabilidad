<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.245">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introducción a la probabilidad para el análisis de datos - 4&nbsp; Distribuciones Notables</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./4.html" rel="next">
<link href="./2.html" rel="prev">
<link href="./cover.jpg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./3.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribuciones Notables</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introducción a la probabilidad para el análisis de datos</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/RicUIB/Enlaces" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo lector">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefacio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prerrequisitos: Teoría de conjuntos y combinatoria</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probabilidad</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variables Aleatorias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribuciones Notables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Variables Aleatorias. Complementos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Vectores aleatorios bidimensionales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Vectores aleatorios</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Ley de los grandes números y Teorema Central del Límite</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#distribuciones-discretas" id="toc-distribuciones-discretas" class="nav-link active" data-scroll-target="#distribuciones-discretas"><span class="header-section-number">4.1</span> Distribuciones discretas</a>
  <ul class="collapse">
  <li><a href="#distribución-de-bernoulli" id="toc-distribución-de-bernoulli" class="nav-link" data-scroll-target="#distribución-de-bernoulli"><span class="header-section-number">4.1.1</span> Distribución de Bernoulli</a></li>
  <li><a href="#distribución-binomial" id="toc-distribución-binomial" class="nav-link" data-scroll-target="#distribución-binomial"><span class="header-section-number">4.1.2</span> Distribución binomial</a></li>
  <li><a href="#distribución-geométrica" id="toc-distribución-geométrica" class="nav-link" data-scroll-target="#distribución-geométrica"><span class="header-section-number">4.1.3</span> Distribución geométrica</a></li>
  <li><a href="#distribución-binomial-negativa" id="toc-distribución-binomial-negativa" class="nav-link" data-scroll-target="#distribución-binomial-negativa"><span class="header-section-number">4.1.4</span> Distribución binomial negativa</a></li>
  <li><a href="#distribución-de-poisson" id="toc-distribución-de-poisson" class="nav-link" data-scroll-target="#distribución-de-poisson"><span class="header-section-number">4.1.5</span> Distribución de Poisson</a></li>
  <li><a href="#distribución-hipergeométrica" id="toc-distribución-hipergeométrica" class="nav-link" data-scroll-target="#distribución-hipergeométrica"><span class="header-section-number">4.1.6</span> Distribución hipergeométrica</a></li>
  </ul></li>
  <li><a href="#cuantiles-de-distribuciones-notables-discretas" id="toc-cuantiles-de-distribuciones-notables-discretas" class="nav-link" data-scroll-target="#cuantiles-de-distribuciones-notables-discretas"><span class="header-section-number">4.2</span> Cuantiles de distribuciones notables discretas</a></li>
  <li><a href="#distribuciones-continuas" id="toc-distribuciones-continuas" class="nav-link" data-scroll-target="#distribuciones-continuas"><span class="header-section-number">4.3</span> Distribuciones continuas</a>
  <ul class="collapse">
  <li><a href="#distribución-uniforme" id="toc-distribución-uniforme" class="nav-link" data-scroll-target="#distribución-uniforme"><span class="header-section-number">4.3.1</span> Distribución uniforme</a></li>
  <li><a href="#distribución-exponencial" id="toc-distribución-exponencial" class="nav-link" data-scroll-target="#distribución-exponencial"><span class="header-section-number">4.3.2</span> Distribución exponencial</a></li>
  <li><a href="#distribución-normal-o-gaussiana" id="toc-distribución-normal-o-gaussiana" class="nav-link" data-scroll-target="#distribución-normal-o-gaussiana"><span class="header-section-number">4.3.3</span> Distribución normal o Gaussiana</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/RicUIB/Enlaces/edit/main/3.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/RicUIB/Enlaces/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Distribuciones Notables</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'reticulate' was built under R version 4.3.1</code></pre>
</div>
</div>
<p>En este tema estudiaremos diversos tipos de experimentos que son muy frecuentes y algunas de las variables aleatorias asociadas a ellos.</p>
<p>Estas variables reciben distintos nombres que aplicaremos sin distinción al tipo de población del experimento, a la variable o a su función de probabilidad, densidad o distribución.</p>
<p>Empezaremos con las variables aleatorias discretas que se presentan con frecuencia, ya que están relacionadas con situaciones muy comunes como el número de caras en varios lanzamiento de una moneda, el número de veces que una maquina funciona hasta que se estropea, el número de clientes en una cola…</p>
<section id="distribuciones-discretas" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="distribuciones-discretas"><span class="header-section-number">4.1</span> Distribuciones discretas</h2>
<section id="distribución-de-bernoulli" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="distribución-de-bernoulli"><span class="header-section-number">4.1.1</span> Distribución de Bernoulli</h3>
<p>Consideremos un experimento con dos resultados posibles: éxito (E) y fracaso (F). El espacio de sucesos será <span class="math inline">\(\Omega=\{E,F\}\)</span>.</p>
<p>Supongamos que la probabilidad de éxito es <span class="math inline">\(P(E)=p\)</span>, y naturalmente <span class="math inline">\(P(F)=1-p=q\)</span>, con <span class="math inline">\(0&lt;p&lt;1\)</span>.</p>
<p>Consideremos la aplicación</p>
<p><span class="math display">\[
X:\Omega=\{E,F\}\to \mathbb{R},
\]</span> definida por <span class="math inline">\(X(E)=1,\ X(F)=0.\)</span></p>
<p>Su función de probabilidad es: <span class="math display">\[
P_{X}(x)=
\left\{
\begin{array}{ll} 1-p=q, &amp; \mbox{si } x=0,\\
p, &amp; \mbox{si } x=1,\\
0, &amp; \mbox{en cualquier otro caso.}
\end{array}
\right.
\]</span></p>
<p>Su función de distribución es: <span class="math display">\[
F_{X}(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0, &amp; \mbox{si } x&lt;0,\\
1-p=q, &amp; \mbox{si } 0\leq x &lt;1,\\
1, &amp; \mbox{si } 1\leq x. \\
\end{array}
\right.
\]</span> Bajo estas condiciones, diremos que <span class="math inline">\(X\)</span> <strong>es una v.a. Bernoulli</strong> o que sigue una ley de <strong>distribución de probabilidad Bernoulli</strong> de parámetro <span class="math inline">\(p\)</span>.</p>
<p>Lo denotaremos por <span class="math inline">\(X\equiv Ber(p)\)</span> o también <span class="math inline">\(X\equiv B(1,p).\)</span></p>
<p>A este tipo de experimentos (éxito/fracaso) se les denomina experimentos Bernoulli.</p>
<p>Fue su descubridor un científico suizo <a href="https://es.wikipedia.org/wiki/Jakob_Bernoulli">Jacob Bernoulli</a>, uno más de la de la conocida <a href="https://es.wikipedia.org/wiki/Familia_Bernoulli">familia de científicos suizos Bernoulli</a>.</p>
<p><strong>Esperanza de una v.a. <span class="math inline">\(X\)</span> <span class="math inline">\(Ber(p)\)</span></strong></p>
<p>Su <strong>valor esperado</strong> es: <span class="math display">\[E(X)=\displaystyle\sum_{x=0}^1 x\cdot P(X=x)= 0\cdot(1-p)+1\cdot p=p.\]</span> Calculemos también <span class="math inline">\(E(X^2)\)</span>:</p>
<p><span class="math display">\[E(X^2)=\displaystyle\sum_{x=0}^1 x^2\cdot P(X=x)= 0^2\cdot(1-p)+1^2\cdot p=p.\]</span> <strong>Varianza de una v.a. <span class="math inline">\(X\)</span> <span class="math inline">\(Ber(p)\)</span></strong></p>
<p>Su <strong>varianza</strong> es:</p>
<p><span class="math display">\[Var(X)=E(X^2)-\left(E(X)\right)^2=p-p^2=p\cdot (1-p)=p\cdot q.\]</span> Su desviación típica es: <span class="math display">\[
\sqrt{Var(X)}=\sqrt{p \cdot (1-p)}.
\]</span></p>
<p><strong>Resumen v.a con distribución Bernoulli</strong></p>
<table class="table">
<colgroup>
<col style="width: 55%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X\)</span> Bernoulli</th>
<th style="text-align: left;"><span class="math inline">\(Ber(p)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{0,1\}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} q &amp; \mbox{si } x=0\\ p &amp; \mbox{si } x=1\\0 &amp; \mbox{en otro caso}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} 0 &amp; \mbox{ si } x&lt;0\\q &amp; \mbox{ si } 0\leq x&lt;1\\1 &amp; \mbox{ si } 1\leq x \end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=p\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=p\cdot q\)</span></td>
</tr>
</tbody>
</table>
<div class="example">
<p><strong>Ejemplo de Distribución Bernoulli</strong></p>
<p>Veamos los cálculos básicos usando la distribución <span class="math inline">\(Ber(p=0.25)\)</span> en <code>R</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">1</span>,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">20</span>,<span class="at">size =</span> <span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
</div>
</div>
<p>El siguiente código dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(Ber(p=0.25)\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> Ber(p=0.25)"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.75</span>,<span class="dv">0</span>,<span class="fl">0.25</span>), <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pbinom</span>(x,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> Ber(p=0.25)"</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Gráficas interactivas <span class="math inline">\(Ber(p)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sliderInput</span>(<span class="st">"p_ber"</span>, <span class="at">label =</span> <span class="st">"Probabilidad éxito p:"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fl">0.01</span>, <span class="at">max =</span> <span class="fl">0.99</span>, <span class="at">value =</span> <span class="fl">0.25</span>, <span class="at">step =</span> <span class="fl">0.01</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span>input<span class="sc">$</span>p_ber</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span>p),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">2</span>),<span class="at">xlab=</span><span class="st">"x"</span>,<span class="at">pch=</span><span class="dv">21</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="st">                   Ber(p="</span>,p,<span class="st">")"</span>),<span class="at">collapse=</span><span class="st">""</span>),<span class="at">bg=</span><span class="st">"black"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="dv">0</span>,<span class="at">y0=</span><span class="dv">0</span>,<span class="at">x1=</span><span class="dv">0</span>,<span class="at">y1=</span><span class="dv">1</span><span class="sc">-</span>p, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span><span class="dv">2</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="dv">1</span>,<span class="at">y0=</span><span class="dv">0</span>,<span class="at">x1=</span><span class="dv">1</span>,<span class="at">y1=</span>p, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span><span class="dv">2</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">y0=</span><span class="dv">1</span><span class="sc">-</span>p,<span class="at">x1=</span><span class="dv">0</span>,<span class="at">y1=</span><span class="dv">1</span><span class="sc">-</span>p, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span><span class="dv">2</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">y0=</span>p,<span class="at">x1=</span><span class="dv">1</span>,<span class="at">y1=</span>p, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span><span class="dv">2</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">pbinom</span>(x,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span>p)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pbinom</span>(x,<span class="at">size=</span><span class="dv">1</span>,<span class="at">prob=</span>p),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> Ber(p="</span>,p,<span class="st">")"</span>),<span class="at">collapse=</span><span class="st">""</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_ber1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
</div>
</section>
<section id="distribución-binomial" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="distribución-binomial"><span class="header-section-number">4.1.2</span> Distribución binomial</h3>
<p>Si repetimos <span class="math inline">\(n\)</span> veces de forma independiente un experimento Bernoulli de parámetro <span class="math inline">\(p\)</span>, el espacio muestral <span class="math inline">\(\Omega\)</span> estará formado por cadenas de <span class="math inline">\(E\)</span>’s y <span class="math inline">\(F\)</span>’s de longitud <span class="math inline">\(n\)</span>. Consideremos la v.a.: <span class="math display">\[X(\overbrace{EFFF\ldots EEF}^{n})=\mbox{número de éxitos en la cadena}.\]</span> A la variable aleatoria anterior se la conoce como distribución binomial de parámetros <span class="math inline">\(n\)</span> y <span class="math inline">\(p\)</span>, y lo denotaremos por <span class="math inline">\(X\equiv B(n,p).\)</span></p>
<p><strong>Función de probabilidad de una binomial</strong></p>
<p>Su <strong>función de probabilidad</strong> es: <span class="math display">\[
P_{X}(x)=\left\{
\begin{array}{ll}
{n\choose x}\cdot  p^x \cdot(1-p)^{n-x}, &amp;\mbox{ si } x=0,1,\ldots,n,\\
0,  &amp; \mbox{ en otro caso.}
\end{array}\right.
\]</span> <strong>Función de distribución de una binomial</strong></p>
<p>Su <strong>función de distribución</strong> no tiene una fórmula cerrada. Hay que acumular la función de probabilidad: <span class="math display">\[
\begin{array}{ll}
F_{X}(x)=P(X\leq x) &amp; =  \sum_{i=0}^x P_X(i)\\
&amp; =
\left\{
\begin{array}{ll}
0, &amp; \mbox{ si } x\leq 0,\\\displaystyle
\sum_{i=0}^k {n\choose i}\cdot  p^i \cdot (1-p)^{n-i} &amp; \mbox{ si }
\left\{
  \begin{array}{l}
  k\leq x&lt; k+1,\\
  k=0,1,\ldots,n,
  \end{array}
\right.\\
1, &amp; \mbox{ si } n\leq x.
\end{array}
\right.
\end{array}
\]</span></p>
<p><strong>Números binomiales con R</strong></p>
<p>Los números binomiales calculan el número de equipos de baloncesto distintos que (<span class="math inline">\(k=5\)</span> jugadores) se pueden hacer con 6 jugadores (<span class="math inline">\(n=6\)</span>).</p>
<p>Es decir, cuántas maneras distintas hay para elegir (<em>choose</em>) 5 jugadores en un conjunto de 6 jugadores. Todo el mundo diría ¡¡¡6!!! Efectivamente con <code>R</code> es</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">6</span>,<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Con 10 jugadores, el número de equipos de 5 distintos es bastante más grande</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">10</span>,<span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 252</code></pre>
</div>
</div>
<p>Y, por ejemplo, con un equipo de fútbol profesional que tiene en plantilla 22 jugadores (quitando los guardametas) se pueden formar ¡¡nada menos que!!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">22</span>,<span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 646646</code></pre>
</div>
</div>
<p>un bonito número capicúa que nos da el número de equipos distintos que se pueden formar.</p>
<p>Obviamente se tiene que una v.a. Bernoulli es una binomial con <span class="math inline">\(n=1\)</span>: <span class="math inline">\(B(1,p)=Ber(p).\)</span></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Calculad las funciones de distribución de una binomial <span class="math inline">\(B(n=1,p=0.3)\)</span> y comprobad que coinciden con las distribuciones de una <span class="math inline">\(Ber(p=0.3)\)</span>.</p>
</div>
<p><strong>Observaciones sobre la distribución binomial</strong></p>
<ul>
<li>La probabilidad de fracaso se suele denotar con <span class="math inline">\(q=1-p\)</span>, <strong>sin ningún aviso adicional</strong>, con el fin de acortar y agilizar la escritura de las fórmulas.</li>
<li>Su <strong>función de distribución no tienen una formula general</strong>, hay que calcularla con una función de <code>R</code> o <code>Python</code>. En el siglo pasado se tabulaban en los libros de papel :-).</li>
<li>En el material adicional os pondremos unas tablas de esta distribución para distintos valores de <span class="math inline">\(n\)</span> y <span class="math inline">\(p\)</span> para que disfrutéis de tan ancestral método de cálculo.</li>
<li>Cualquier paquete estadístico u hoja de cálculo dispone de funciones para el cálculo de estas probabilidades, así que el <strong>uso de las tablas</strong> queda <strong>totalmente anticuado</strong>.</li>
</ul>
<p><strong>Esperanza de una <span class="math inline">\(B(n,p)\)</span></strong></p>
<p>Su <strong>esperanza</strong> es: <span class="math display">\[E(X)=\displaystyle\sum_{k=0}^n k \cdot  {n \choose k }\cdot p^k\cdot q^{n-k} = n\cdot p.\]</span> La esperanza de <span class="math inline">\(X^2\)</span> es: <span class="math display">\[
E(X^2)= \displaystyle\sum_{k=0}^n k^2 \cdot  {n \choose k }\cdot p^k\cdot q^{n-k}= n\cdot p\cdot q+(n\cdot p)^2.
\]</span></p>
<p><strong>Varianza de una <span class="math inline">\(B(n,p)\)</span></strong></p>
<p>Su <strong>varianza</strong> es:</p>
<p><span class="math display">\[Var(X)=E(X^2)-\left(E(X)\right)^2=n\cdot p \cdot q=n\cdot p\cdot (1-p).\]</span></p>
<p>Su desviación típica es:</p>
<p><span class="math display">\[\sqrt{n\cdot p\cdot q}=\sqrt{n\cdot p\cdot (1-p)}.\]</span></p>
<p>En temas posteriores veremos una forma sencilla del cálculo de la esperanza y varianza de una <span class="math inline">\(B(n,p)\)</span> como las suma de <span class="math inline">\(n\)</span> v.a. <span class="math inline">\(Ber(p)\)</span> independientes.</p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Justificar de forma intuitiva que si <span class="math inline">\(X_i\)</span> con <span class="math inline">\(i=1,2,\ldots, n\)</span> son v.a. <span class="math inline">\(Ber(p)\)</span> independientes entonces <span class="math inline">\(X=\displaystyle\sum_{i=1}^n X_i\)</span> sigue una distribución <span class="math inline">\(B(n,p).\)</span></p>
</div>
<p><strong>Resumen v.a con distribución binomial <span class="math inline">\(B(n,p)\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 60%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X\)</span> binomial</th>
<th style="text-align: left;"><span class="math inline">\(B(n,p)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{0,1,\ldots n\}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll}{n\choose x} p^x (1-p)^{n-x} &amp; \mbox{si } x=0,\dots,n\\0 &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq x)=\)</span></td>
<td style="text-align: left;">no tiene fórmula (utilizad funciones de <code>R</code> o <code>Python</code>)</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=n\cdot p\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=n\cdot p \cdot (1-p)\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Cálculos de la distribución Binomial con <code>R</code></strong></p>
<p>Veamos los cálculos básicos con funciones de <code>R</code> para una v.a <span class="math inline">\(X\)</span> con distribución binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<p>Si queremos calcular con <code>R</code> algún valor de la función de distribución, como por ejemplo <span class="math inline">\(F_X(0)=P(X\leq 0)\)</span>, tenemos que hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05631351</code></pre>
</div>
</div>
<p>y si queremos por ejemplo <span class="math inline">\(F_X(4)=P(X\leq 4)\)</span>, tenemos que hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9218731</code></pre>
</div>
</div>
<p>Sin embargo, si queremos calcular algún valor de la función de probabilidad, como por ejemplo <span class="math inline">\(P(X=0)\)</span>, tenemos que hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05631351</code></pre>
</div>
</div>
<p>o, por ejemplo para <span class="math inline">\(P(X=4)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.145998</code></pre>
</div>
</div>
<p><strong>Generación de muestras aleatorias con R</strong></p>
<p>Generaremos una muestra aleatoria de 100 valores de una población con distribución <span class="math inline">\(B(20,0.5)\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2019</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">100</span>,<span class="at">size =</span> <span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 12 11  9 11  6  6 12  5  7 11 12 11  8  8 11 11  7 11  9 10  9 10 14  8  8
 [26]  5 11 14 11 10 11  5 12  8  6  7  9 10  5 12 11  9 12 11 12 10 13 13  8  8
 [51]  9  7  6  9 10  9 16 13  6  6  8  8 11  9 12 15  9  7 12 11  9  8  9  8 11
 [76] 15  7 10  9 12  6 13 14  8 10  8 10 11 11  9 10 11 12  8 10 12  9 13  9 13</code></pre>
</div>
</div>
<div class="example">
<p><strong>Ejemplo</strong></p>
<p>El ejemplo anterior correspondería a repetir 100 veces el experimento de lanzar una moneda 20 veces y contar el número de caras.</p>
</div>
<p><strong>Cálculos de la distribución Binomial con <code>Python</code></strong></p>
<p>Veamos los cálculos básicos con funciones de <code>Pyython</code> para una v.a <span class="math inline">\(X\)</span> con distribución binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<p>Primero importamos la función <code>binom</code> de la librería <code>scipy.stat</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En general, en el paquete <code>scipy</code>, la función de probabilidad se invocará con el método <code>pmf</code>, la de distribución con el método <code>cdf</code>, mientras que una muestra aleatoria que siga esta distribución, con el método <code>rvs</code>. En todos ellos aparecerá siempre el parámetro <code>loc</code> que se utiliza para desplazar el dominio de la variable aleatoria. Por ejemplo, en este caso:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>binom.pmf(k, n, p, loc) <span class="op">=</span>  binom.pmf(k <span class="op">-</span> loc, n, p)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para calcular los valores de la función de distribución como por ejemplo <span class="math inline">\(F_X(0)=P(X\leq 0)\)</span> y <span class="math inline">\(F_X(4)=P(X\leq 4)\)</span> utilizamos la función <code>cdf</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>binom.cdf(<span class="dv">0</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.056313514709472684</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>binom.cdf(<span class="dv">4</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9218730926513672</code></pre>
</div>
</div>
<p>Notemos que al no indicar el valor de <code>loc</code>, se le asume que toma el valor 0.</p>
<p>Para calcular los valores de la función de probabilidad <span class="math inline">\(P(X=0)\)</span> y <span class="math inline">\(P(X=4)\)</span> utilizamos la función <code>pmf</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>binom.pmf(<span class="dv">0</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.056313514709472656</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>binom.pmf(<span class="dv">4</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.14599800109863284</code></pre>
</div>
</div>
<p>Notemos que al no indicar el valor de <code>loc</code>, se le asume que toma el valor 0.</p>
<p>Si queremos generar una muestras aleatorias que siga una distribución binomial, podemos usar la función <code>rvs</code>. En este caso, generaremos una muestra aleatoria de 100 valores de una población <span class="math inline">\(B(20,0.5)\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size <span class="op">=</span> <span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([ 6,  5,  3,  7,  5,  3,  5,  6,  3,  4,  5,  6,  4,  4,  6,  8,  5,
        6,  6,  5,  5,  5,  4,  6,  4,  6,  5,  6,  9,  4,  6,  7,  8,  6,
        5,  7,  5,  7,  4,  6,  5,  9, 10,  5,  1,  7,  5,  8,  7,  7,  6,
        7,  6,  8,  8,  4,  4,  7,  6,  6,  8,  3,  5,  9,  6,  4,  7,  6,
        6,  8,  5,  6,  1,  3,  5,  7,  6,  6,  5,  4,  4,  7,  7,  4,  4,
        4,  4,  2,  6,  7,  5,  5,  4,  6,  2,  6,  5,  4,  7,  6],
      dtype=int64)</code></pre>
</div>
</div>
<p><l class="observ"> <strong>Observación</strong></l></p>
<p>Notemos que la secuencia aleatoria generada no es la misma que con <code>R</code>. De hecho, si volvemos a ejecutar esta función obtendremos una muestra aleatoria distinta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size <span class="op">=</span> <span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([ 4,  6,  6,  5,  4,  7,  6,  6,  5,  7,  7,  4,  5,  4,  5,  4,  3,
        6,  5,  6,  5,  1,  4,  3,  5,  5,  5,  5,  5,  8,  4,  3, 10,  1,
        6,  7,  3,  3,  5,  3,  3,  5,  6,  3,  6,  7,  3,  6,  7,  6,  6,
        6,  4,  7,  5,  8,  6,  7,  3,  7,  4,  6,  4,  5,  4,  4,  7,  5,
        7,  6,  6,  6,  5,  9,  5,  4,  7,  3,  4,  5,  7,  4,  6,  2,  5,
        7,  3,  7,  7,  6,  2,  5,  9,  5,  5,  7,  4,  7,  4,  8],
      dtype=int64)</code></pre>
</div>
</div>
</section></section></main></div>
<p>Veamos algunos cálculos básicos con funciones de <code>Python</code> para la binomial <span class="math inline">\(B(n=10,p=0.25)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>binom.cdf(<span class="dv">5</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9802722930908203</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>binom.pmf(<span class="dv">1</span>,n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1877117156982421</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>binom.rvs(n<span class="op">=</span><span class="dv">20</span>,p<span class="op">=</span><span class="fl">0.25</span>,size<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([11,  7,  7,  5,  4,  6,  8,  8,  4,  6], dtype=int64)</code></pre>
</div>
</div>
<p><strong>Gráficas de la distribución Binomial con <code>R</code></strong></p>
<p>El siguiente código de <code>R</code> dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(B(n=10,p=0.25)\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">22</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>aux[<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">22</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> B(n=10,p=0.25)"</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pbinom</span>(x,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> B(n=10,p=0.25)"</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Gráficas interactivas de la distribución Binomial</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"n_binom"</span>, <span class="at">label =</span> <span class="st">"Número de repeticiones n:"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span><span class="dv">10</span> , <span class="at">step =</span> <span class="dv">1</span>)),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"p_binom"</span>, <span class="at">label =</span> <span class="st">"Probabilidad éxito p:"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="fl">0.01</span>, <span class="at">max =</span> <span class="fl">0.99</span>, <span class="at">value =</span> <span class="fl">0.25</span>, <span class="at">step =</span> <span class="fl">0.01</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>input<span class="sc">$</span>n_binom</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  pr<span class="ot">=</span>input<span class="sc">$</span>p_binom</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">size=</span>n,<span class="at">prob=</span>pr)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">size=</span>n,<span class="at">prob=</span>pr),</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> B(n="</span>,n,<span class="st">",p="</span>,pr,<span class="st">")"</span>),<span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">pbinom</span>(x,<span class="at">size=</span>n,<span class="at">p=</span>pr),</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> B(n="</span>,n,<span class="st">",p="</span>,pr,<span class="st">")"</span>),</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_bino1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Gráficos de la distribución binomial con <code>Python</code></strong></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Buscad en la documentación de <code>Python</code> cómo se dibuja la función de probabilidad y de distribución de una binomial y recread los gráficos anteriores.</p>
<div class="exercise-sol">
<p>Pista: Necesitaremos investigar más librerías:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="dv">10</span>, <span class="fl">0.25</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(binom.ppf(<span class="fl">0.01</span>, n, p),binom.ppf(<span class="fl">0.99</span>, n, p))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, binom.pmf(x, n, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">8</span>, label<span class="op">=</span><span class="st">'binom pmf'</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, binom.pmf(x, n, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>ax.plot(x, binom.cdf(x, n, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">8</span>, label<span class="op">=</span><span class="st">'binom pmf'</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, binom.cdf(x, n, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribucion Binomial'</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="center">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&lt;string&gt;:2: MatplotlibDeprecationWarning: The label function was deprecated in Matplotlib 3.1 and will be removed in 3.8. Use Tick.label1 instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/dibu_python2-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</div>
</div>
</div>
<div class="example">
<p><strong>Ejemplo: número de bolas rojas extraídas de una urna con reposición</strong></p>
<p>Tenemos una urna con <span class="math inline">\(100\)</span> bolas de las cuales 40 son rojas y 60 son blancas. Extraemos al azar una bola, anotamos su color y la devolvemos a (reponemos en) la urna.</p>
<p>Supongamos que repetimos este proceso <span class="math inline">\(n=10\)</span> reponiendo en cada ocasión la bola extraída.</p>
<p>Consideremos la variable aleatoria <span class="math inline">\(X\)</span> como el número de bolas rojas extraídas (con reposición) en <span class="math inline">\(n=10\)</span> repeticiones del mismo experimento de Bernoulli.</p>
<p>Bajo estas condiciones repetimos <span class="math inline">\(n=10\)</span> veces el mismo experimento de Bernoulli con probabilidad de éxito (sacar bola roja) <span class="math display">\[P(Roja)=P(Éxito)=p=\frac{40}{100}=0.4.\]</span></p>
<p>Así que la variable <span class="math inline">\(X\)</span>, que es el número de bolas rojas extraídas de la urna (con reposición) en <span class="math inline">\(n=10\)</span> ocasiones, sigue una ley binomial <span class="math inline">\(B(n=10,p=0.4).\)</span></p>
<p>Nos preguntamos:</p>
<ol type="1">
<li>¿Cuál es la probabilidad de que saquemos exactamente <span class="math inline">\(4\)</span> bolas rojas?</li>
<li>¿Cuál es la probabilidad de que saquemos al menos <span class="math inline">\(4\)</span> bolas rojas?</li>
<li>¿Cuál es la probabilidad de que saquemos menos de <span class="math inline">\(3\)</span> bolas rojas?</li>
<li>¿Cuál es el valor esperado del número de bolas rojas?</li>
<li>¿Cuál es la desviación típica del número de bolas rojas?</li>
</ol>
<div class="example-sol">
<p><strong>Solución 1</strong>. ¿Cuál es la probabilidad de que saquemos exactamente <span class="math inline">\(4\)</span> rojas?</p>
<p>Utilizando la función de probabilidad, tenemos que: <span class="math display">\[
\begin{array}{ll}
P(X=4)&amp;={10\choose 4}\cdot 0.4^4\cdot (1-0.4)^{10-4}
= \frac{10!}{(10-4)!\cdot 4!}\cdot 0.4^4\cdot 0.6^6\\
&amp;= \frac{7\cdot 8\cdot 9\cdot 10}{1\cdot 2\cdot 3\cdot 4}\cdot 0.4^4\cdot 0.6^6=0.2508227.
\end{array}
\]</span></p>
<p>Con <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob =</span> <span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2508227</code></pre>
</div>
</div>
</div>
<div class="example-sol">
<p><strong>Solución 2</strong>. ¿Cuál es la probabilidad de que saquemos al menos <span class="math inline">\(4\)</span> bolas rojas?</p>
<p>La probabilidad de sacar al menos 4 rojas se expresa como <span class="math inline">\(P(X \geq 4)=1-P(X&lt;4)=1-P(X\leq 3):\)</span> <span class="math display">\[
\begin{array}{rl}
P(X\leq 3)&amp; = P(X=0)+P(X=1)+P(X=2)+P(X=3)\\
&amp;=
{10\choose 0}\cdot 0.4^0\cdot (1-0.4)^{10-0}+ {10\choose 1}\cdot 0.4^1\cdot (1-0.4)^{10-1}\\
&amp;+{10\choose 2}\cdot 0.4^2\cdot (1-0.4)^{10-2}+ {10\choose 3}\cdot 0.4^3\cdot (1-0.4)^{10-3}\\
&amp;=0.3822806.
\end{array}
\]</span></p>
<p>Con <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3822806</code></pre>
</div>
</div>
<p>Así que</p>
<p><span class="math display">\[P(X \geq 4 )=1-P(X&lt; 4)=P(X\leq 3)=1-0.3822806=0.6177194.\]</span></p>
<p>Otra manera usando <code>R</code> sería:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6177194</code></pre>
</div>
</div>
<p>Aunque en estos casos el parámetro <code>lower.tail = FALSE</code> es sin duda nuestra mejor opción:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.4</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6177194</code></pre>
</div>
</div>
</div>
<div class="example-sol">
<p><strong>Solución 3</strong>. ¿Cuál es la probabilidad de que saquemos menos de <span class="math inline">\(3\)</span> bolas rojas?</p>
<p><span class="math display">\[
\begin{array}{ll}
P(X&lt; 3)&amp;= P(X\leq 2)=  P(X=0)+P(X=1)+P(X=2)\\
&amp;=
{10\choose 0}\cdot 0.4^0\cdot (1-0.4)^{10-0}+ {10\choose 1}\cdot 0.4^1\cdot (1-0.4)^{10-1}\\
&amp;+
{10\choose 2}\cdot 0.4^2\cdot (1-0.4)^{10-2}\\
&amp;=0.1672898.
\end{array}
\]</span></p>
<p>En <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1672898</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="fl">0.4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1672898</code></pre>
</div>
</div>
</div>
<div class="example-sol">
<p><strong>Solución 4</strong>. ¿Cuál es el valor esperado del número de bolas rojas?</p>
<p>Como <span class="math inline">\(X\)</span> es una <span class="math inline">\(B(n=10,p=0.4)\)</span> sabemos que</p>
<p><span class="math display">\[E(X)=n\cdot p = 10\cdot 0.4=4.\]</span></p>
<p>Aunque en <code>Python</code> tenemos la función <code>stats</code> que nos lo calcula directamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"E(X) = </span><span class="sc">{m}</span><span class="st">"</span>.<span class="bu">format</span>(m<span class="op">=</span>binom.stats(n <span class="op">=</span> <span class="dv">10</span>, p <span class="op">=</span> <span class="fl">0.4</span>, moments<span class="op">=</span><span class="st">'m'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</div>
<div class="example-sol">
<p><strong>Solución 5</strong>. ¿Cuál es la desviación típica del número de bolas rojas?</p>
<p>La varianza es: <span class="math display">\[
Var(X)=n\cdot p \cdot(1-p)=10\cdot 0.4\cdot 0.6=2.4.
\]</span> Por lo tanto, la desviación típica es:</p>
<p><span class="math display">\[\sqrt{Var(X)}=\sqrt{2.4}= 1.5491933.\]</span></p>
<p>Aunque en <code>Python</code> tenemos la función <code>stats</code> que nos lo calcula directamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Var(X) = </span><span class="sc">{v}</span><span class="st">"</span>.<span class="bu">format</span>(v<span class="op">=</span>binom.stats(n <span class="op">=</span> <span class="dv">10</span>, p <span class="op">=</span> <span class="fl">0.4</span>, moments<span class="op">=</span><span class="st">'v'</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid" width="480"></p>
</div>
</div>
</div>
</div>

<section id="distribución-geométrica" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" data-anchor-id="distribución-geométrica"><span class="header-section-number">4.1.3</span> Distribución geométrica</h3>
<p>Todos hemos jugado a, por ejemplo, tirar una moneda hasta que obtengamos la primera cara.</p>
<p>O también tirar una pelota a una canasta de baloncesto hasta obtener la primera canasta.</p>
<p>Desde otro punto de vista, también podemos intentar modelar el número de veces que accionamos una interruptor y la bombilla se ilumina hasta que falla.</p>
<p>O también, el número de veces que un cajero automático nos da dinero hasta que falla.</p>
<p>La <strong>modelización de este tipo de problemas se consigue con la llamada distribución geométrica</strong>.</p>
<p><l class="definition"> <strong>Distribución geométrica</strong> </l></p>
<p>Repitamos un experimento Bernoulli, de parámetro <span class="math inline">\(p\)</span>, de forma independiente hasta obtener el primer éxito.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de fracasos antes del primer éxito. Por ejemplo, que hayamos tenido <span class="math inline">\(x\)</span> fracasos será una cadena de <span class="math inline">\(x\)</span> fracasos culminada con un éxito. Más concretamente</p>
<p><span class="math display">\[P(\overbrace{FFF\ldots F}^{x}E)=P(F)^{x}\cdot P(E)=(1-p)^{x}\cdot p=q^{x}\cdot p.\]</span> Su función de probabilidad es: <span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}
(1-p)^{x}\cdot p, &amp; \mbox{ si } x=0,1,2,\ldots,\\
0, &amp;\mbox{ en otro caso.}
\end{array}\right.
\]</span> La v.a. definida anteriormente diremos que sigue una distribución geométrica de parámetro <span class="math inline">\(p\)</span>. La denotaremos por <span class="math inline">\(Ge(p)\)</span>. Su dominio será: <span class="math inline">\(D_X=\{0,1,2,\ldots\}\)</span>.</p>
<p>Calculemos como ejemplo P(<span class="math inline">\(X\leq 3\)</span>). Por la propiedad de la probabilidad del suceso complementario tenemos que</p>
<p><span class="math display">\[
P(X\leq 3 )=1-P(X&gt; 3)=1-P(X\geq 4)
\]</span></p>
<p>Efectivamente, el complementario del evento <span class="math inline">\(X\leq 3\)</span> nos dice que hemos fracasado más de tres veces hasta conseguir el primer éxito, es decir, <strong>hemos fracasado 4 o más veces</strong>. Podemos simbolizar dicho evento de la forma siguiente: <span class="math display">\[
\{X&gt;3\}=\{X\geq 4\}= \{FFFF\}
\]</span></p>
<p>Ahora, al ser los intentos independientes, tenemos que: <span class="math display">\[
\begin{array}{ll}
P(X&gt;3) &amp; =  P(\{FFFF\})= P(F)\cdot P(F)\cdot P(F)\cdot P(F)\\
&amp;= (1-p)\cdot (1-p)\cdot (1-p)\cdot (1-p)= (1-p)^{3+1}=(1-p)^{4}.
\end{array}
\]</span></p>
<p>El valor de la función de distribución de <span class="math inline">\(X\)</span> en <span class="math inline">\(x=3\)</span> será, pues: <span class="math display">\[F_X(3)=P(X\leq 3)=1-P(X&gt;3)=1-(1-p)^{3+1}.\]</span> Generalizando el resultado anterior a cualquier entero positivo <span class="math inline">\(k=0,1,2,\ldots\)</span>, tenemos: <span class="math display">\[F_X(k)=P(X\leq k)=1-(1-p)^{k+1},\mbox{ si } k=0,1,2,\ldots\]</span></p>
<p>En general, tendremos que: <span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{\begin{array}{ll}
0, &amp; \mbox{ si } x&lt;0,\\
1- (1-p),  &amp; \mbox{ si } k=0\leq x &lt;1,\\
1- (1-p)^2, &amp; \mbox{ si } k=1\leq x &lt;2,\\
1- (1-p)^3, &amp; \mbox{ si } k=2\leq x &lt;3,\\
1- (1-p)^{k+1}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq x&lt; k+1,\\\mbox{para } k=0,1,2,\ldots\end{array}
    \right.\end{array}\right.
\]</span> De forma más compacta, tendremos que <span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{\begin{array}{ll}
0, &amp; \mbox{ si } x&lt;0,\\
1- (1-p)^{k+1}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq x&lt; k+1,\\\mbox{para } k=0,1,2,\ldots\end{array}
    \right.\end{array}
    \right.
\]</span></p>
<p>Notemos que el límite de la función de distribución es: <span class="math display">\[
\displaystyle\lim_{k\to +\infty } F_X(k)=\lim_{k\to +\infty } 1-(1-p)^{k+1}=
1,
\]</span> ya que <span class="math inline">\(0&lt;1-p&lt;1\)</span>.</p>
<p><strong>Sumas derivadas series geométricas</strong></p>
<p>Recordemos las propiedades siguientes del tema de variables aleatorias:</p>
<ul>
<li>Si <span class="math inline">\(|r|&lt;1\)</span> también son convergentes las derivadas, respecto de <span class="math inline">\(r\)</span>, de la serie geométrica y convergen a la derivada correspondiente. Así, tenemos que: <span class="math display">\[
\begin{array}{ll}
\left(\sum_{k=0}^{+\infty} r^k\right)' &amp;= \sum_{k=1}^{+\infty}k\cdot
r^{k-1}\\
&amp;= \left(\frac{1}{1-r}\right)'=\frac{1}{(1-r)^2}.\\
\left(\sum_{k=0}^{+\infty} r^k\right)^{''} &amp;= \sum_{k=2}^{+\infty}k \cdot(k-1)\cdot r^{k-2} \\
&amp;= \left(\frac{1}{1-r}\right)^{''}=\frac{2}{(1-r)^3}.
\end{array}
\]</span></li>
</ul>
<p><strong>Esperanza de una v.a. <span class="math inline">\(Ge(p)\)</span></strong></p>
<p>Recordemos que <span class="math inline">\(P(X=x)=(1-p)^x\cdot p\)</span> si <span class="math inline">\(x=0,1,2,\ldots\)</span> y aplicado la fórmula anterior con <span class="math inline">\(r=1-p\)</span>, tenemos: <span class="math display">\[
\begin{array}{rll}
E(X)&amp;=&amp;\sum_{x=0}^{+\infty} x\cdot P_x(x)=\sum_{x=0}^{+\infty} x\cdot (1-p)^x\cdot p=
p\cdot (1-p) \cdot \sum_{x=1}^{+\infty} x\cdot (1-p)^{x-1}\\
&amp;=&amp; p\cdot (1-p)\cdot \frac{1}{(1-(1-p))^2}=p\cdot (1-p)\cdot \frac{1}{p^2}=\frac{1-p}{p}.
\end{array}
\]</span></p>
<p><strong>Valor <span class="math inline">\(E(X^2)\)</span> de una v.a. <span class="math inline">\(Ge(p)\)</span></strong></p>
<p><span class="math display">\[
\begin{array}{rll}
E(X^2)&amp;=&amp;\sum_{x=0}^{+\infty} x^2\cdot P_X(x)=\sum_{x=1}^{+\infty} x^2\cdot (1-p)^x\cdot p\\
&amp;=&amp;
\sum_{x=1}^{+\infty} (x\cdot (x-1)+x)\cdot (1-p)^{x}\cdot p\\
&amp;=&amp;
\sum_{x=1}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x}\cdot p+\sum_{x=1}^{+\infty} x \cdot (1-p)^{x}\cdot p\\
&amp;=&amp;
(1-p)^{2}\cdot p\cdot \sum_{x=2}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x-2}\\
&amp; &amp; +    (1-p)\cdot p\sum_{x=1}^{+\infty} x \cdot (1-p)^{x-1}
\\  &amp;=&amp;
(1-p)^{2}\cdot p\cdot \sum_{x=2}^{+\infty} x\cdot (x-1)\cdot (1-p)^{x-2}\\
&amp; &amp;+   (1-p)\cdot p\sum_{x=1}^{+\infty} x \cdot (1-p)^{x-1}\\
&amp;=&amp;
p\cdot (1-p)^2 \frac{2}{(1-(1-p))^3}+  (1-p)\cdot p \frac{1}{(1-(1-p))^2}\\
&amp;=&amp;
p\cdot (1-p)^2 \frac{2}{p^3}+  (1-p)\cdot p \frac{1}{p^2}\\
&amp;=&amp;\frac{2\cdot (1-p)^2}{p^2}+\frac{1-p}{p}.
\end{array}
\]</span></p>
<p><strong>Varianza de una v.a. <span class="math inline">\(Ge(p)\)</span></strong></p>
<p><span class="math display">\[
\begin{array}{rll}
Var(X)&amp;=&amp;E(X^2)-E(X)^2=\frac{2\cdot (1-p)^2}{p^2}+\frac{1-p}{p}-\left(\frac{1-p}{p}\right)^2\\
&amp;=&amp;
\frac{2\cdot (1-p)^2+p\cdot(1-p)-(1-p)^2}{p^2}=\frac{(1-p)^2+p\cdot(1-p)}{p^2}\\
&amp;=&amp;
\frac{1-2\cdot p + p^2+p-p^2}{p^2}\\
&amp;=&amp; \frac{1-p}{p^2},
\end{array}
\]</span> y su desviación típica será <span class="math display">\[\sqrt{Var(X)}=\sqrt{\frac{1-p}{p^2}}.\]</span></p>
<p><strong>Resumen <span class="math inline">\(Ge(p)\)</span> empezando en <span class="math inline">\(0\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 53%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X=\)</span> Geométrica (empieza en <span class="math inline">\(0\)</span>)</th>
<th style="text-align: left;">número de fracasos para conseguir el primer éxito</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{0,1,\ldots n,\ldots\}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll}(1-p)^{x}\cdot p, &amp; \mbox{ si } x=0,1,2,\ldots \\0, &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} 0 &amp; \mbox{ si } x&lt;0\\  1- (1-p)^{k+1}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq x&lt; k+1,\\\mbox{para } k=0,1,\dots\end{array}  \right.\end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=\frac{1-p}{p}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=\frac{1-p}{p^2}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>La variable geométrica que cuenta los intentos para obtener el primer éxito</strong></p>
<p>Supongamos que sólo estamos interesados en el <strong>número de intentos</strong> para obtener el primer éxito.</p>
<p>Si definimos <span class="math inline">\(Y\)</span> como número de intentos para obtener el primer éxito, entonces <span class="math inline">\(Y=X+1\)</span>, donde <span class="math inline">\(X\equiv Ge(p)\)</span>.</p>
<p>Su dominio es <span class="math inline">\(D_Y=\{1,2,\ldots\}\)</span></p>
<p>La media se incrementa en un intento debido al éxito <span class="math inline">\(E(Y)=E(X+1)=E(X)+1=\frac{1-p}{p}+1=\frac1{p}\)</span>.</p>
<p>La varianza es la misma <span class="math inline">\(Var(Y)=Var(X+1)=Var(X)=\frac{1-p}{p^2}\)</span>.</p>
<p><strong>Resumen <span class="math inline">\(Ge(p)\)</span> comenzando en <span class="math inline">\(1\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 53%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(Y\)</span> geométrica (que cuenta el éxito empieza en 1)</th>
<th style="text-align: left;">número de INTENTOS para OBTENER el primer éxito</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_Y=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{1,2,\ldots n,\ldots\}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(P_Y(y)=P(Y=y)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll}(1-p)^{y-1}\cdot p, &amp; \mbox{ si } y=1,2,3,\ldots\\ 0, &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_Y(y)=P(Y\leq y)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} 0, &amp; \mbox{ si } y&lt;1\\ 1- (1-p)^{k}, &amp; \mbox{ si } \left\{ \begin{array}{l}k\leq y&lt; k+1,\\\mbox{para } k=1,2,3,\dots \end{array} \right.\end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=\frac1{p}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=\frac{1-p}{p^2}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Propiedad de la falta de memoria</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una v.a. discreta con dominio <span class="math inline">\(D_X=\{0,1,2,\ldots\}\)</span>, con <span class="math inline">\(P(X=0)=p\)</span>.</p>
<p>Entonces <span class="math inline">\(X\)</span> sigue una ley <span class="math inline">\(Ge(p)\)</span> si, y sólo si, <span class="math display">\[
P\left(X&gt; k+j\big| X\geq j\right)=P(X&gt; k)
\]</span> para todo <span class="math inline">\(k,j=0,1,2,3\ldots\)</span>.</p>
<div class="dem">
<p><strong>Demostración</strong></p>
<p>Si <span class="math inline">\(X\)</span> es geométrica, entonces el lado derecho de la igualdad es</p>
<p><span class="math display">\[
P(X&gt;k)=1-P(X\leq k)=1-\left(1-(1-p)^{k+1}\right)=(1-p)^{k+1},
\]</span> y el lado de izquierdo es: <span class="math display">\[
\begin{array}{rll}
P\left(X&gt; k+j\big| X\geq j\right)&amp;=&amp;\frac{P\left(\{X&gt; k+j\}\cap \{X\geq j\} \right)}{P\left(X\geq j\right)}=
\frac{P\left(X&gt;k+j \right)}{P\left(X\geq j \right)} = \frac{1-P(X\leq k+j)}{1-P(X\leq j-1)}\\
&amp;=&amp;  \frac{1-(1-(1-p)^{k+j+1})}{1-(1-(1-p)^{j-1+1})} =\frac{(1-p)^{k+j+1}}{(1-p)^{j}} = (1-p)^{k+1},
\end{array}
\]</span> lo que demuestra la igualdad.</p>
<p>Para demostrar el recíproco, tomemos <span class="math inline">\(j=1\)</span> y <span class="math inline">\(k\geq 0\)</span>. Entonces, por la propiedad de la pérdida de memoria: <span class="math display">\[
P\left(X&gt; k+1\big| X\geq 1\right)=P(X&gt; k)
\]</span></p>
<p>Como <span class="math inline">\(P(X=0)=p\)</span>, tenemos que <span class="math inline">\(P(X \geq 1 )=1-P(X&lt;1)=1-P(X=0)=1-p\)</span>.</p>
<p>Combinado las igualdades, tenemos que: <span class="math display">\[
P\left(X&gt; k+1\big| X\geq 1\right)=\frac{P(X&gt;k+1, X\geq 1)}{P(X\geq 1)}=\frac{P(X&gt;k+1)}{P(X\geq 1)}=P(X&gt;k).
\]</span> Así podemos poner que</p>
<p><span class="math display">\[
\begin{array}{rll}
P(X&gt;k+1)&amp;=&amp;P(X\geq 1)\cdot P(X&gt;k)=\left(1-P(X&lt;1)\right)\cdot P(X&gt;k)\\
&amp;=&amp;\left(1-P(X=0)\right)\cdot P(X&gt;k)=(1-p)\cdot P(X&gt;k).
\end{array}
\]</span></p>
<p>En general tenemos que:</p>
<p><span class="math display">\[
P(X&gt;k+1)=(1-p)\cdot P(X&gt;k).
\]</span> Del mismo modo para <span class="math inline">\(j=2\)</span>, <span class="math display">\[
P(X&gt;k+2)=(1-p)\cdot P(X&gt;k+1).
\]</span> Restando la primera igualdad de la última obtenemos: <span class="math display">\[
P(X&gt;k+1)-P(X&gt;k+2)=(1-p)\cdot P(X&gt;k)-(1-p)\cdot P(X&gt;k+1),
\]</span> de donde operando en cada lado de la igualdad obtenemos la recurrencia: <span class="math display">\[
[1-P(X\leq k+1)]-[1-P(X\leq k+2)]=(1-p)\cdot [P(X&gt;k)-P(X&gt;k+1)]
\]</span></p>
<p>Ahora operando, <span class="math display">\[
\begin{array}{rl}
P(X\leq k+2)-P(X\leq k+1) &amp; =(1-p)\cdot[1-P(X\leq k)-\left(1-P(X\leq k+1)\right)],\\
P(X=k+2) &amp; =(1-p)\cdot[P(X\leq k+1)-P(X\leq k)], \\
P(X=k+2) &amp; =(1-p)\cdot P(X=k+1).
\end{array}
\]</span> De forma similar, obtenemos</p>
<p><span class="math display">\[
P(X=k+1)=(1-p)\cdot P(X=k).
\]</span> Utilizando la recurrencia anterior, podemos calcular todas las probabilidades <span class="math inline">\(P(X=k)\)</span> a partir de la <span class="math inline">\(P(X=0)=p\)</span>: <span class="math display">\[
\begin{array}{rl}
P(X=0)&amp;= p,\\
P(X=1)&amp;=P(X=0+1)= (1-p)\cdot P(X=0) =(1-p)\cdot  p,\\
P(X=2)&amp;=P(X=1+1)= (1-p)\cdot P(X=1)=(1-p)\cdot (1-p)\cdot p=(1-p)^2\cdot p,\\
\vdots&amp; \vdots \\
P(X=k)&amp;=P(X=(k-1)+1)= (1-p)\cdot P(X=k-1)=(1-p)\cdot (1-p)^{k-1}\cdot p \\
&amp; =(1-p)^{k}\cdot p,
\end{array}
\]</span> lo que demuestra el recíproco, es decir, que <span class="math inline">\(X\)</span> es <span class="math inline">\(Geom(p)\)</span>.</p>
</div>
<p><l class="observ"> <strong>Observación: Interpretación de la propiedad de la falta de memoria</strong></l></p>
<p>La propiedad de la falta de memoria <span class="math display">\[
P(X&gt; k+j\big|X \geq j)=P(X &gt; k),
\]</span><br>
significa que, aunque <strong>ya llevemos al menos <span class="math inline">\(j\)</span> fracasos</strong>, la probabilidad de <strong>que fracasemos <span class="math inline">\(k\)</span> veces más</strong> no disminuye, es la misma que era cuando empezamos el experimento.</p>
<p>A este efecto se le suele etiquetar con la frase <strong>el experimento carece de memoria</strong> o es un <strong>experimento sin memoria</strong> (<em>Memoryless Property</em>).</p>
<p><strong>Ejemplo falta de memoria</strong></p>
<p>Un ejemplo muy sencillo nos aclarará el alcance de esta propiedad es el ejercicio siguiente:</p>
<div class="exercise">
<p><strong>Ejercicio: la llave que abre la puerta</strong></p>
<p>Tenemos un llavero con 10 llaves, sólo una de ellas abre una puerta. Cada vez que probamos una llave y falla olvidamos que llave hemos probado. ¿Cuál es la probabilidad de que si ya lo hemos intentado 5 veces necesitemos más de 4 intentos adicionales para abrir la puerta?</p>
<div class="example-sol">
<p>Tomemos <span class="math inline">\(k=4,j=5\)</span>, aplicando la propiedad de la falta de memoria</p>
<p><span class="math display">\[
P(X&gt; 4+5/X \geq 5)=P(X &gt; 4)
\]</span></p>
<p>Después de 5 fracasos no estamos “más cerca” de abrir la puerta. La propiedad de la falta de memoria nos dice que en <strong>después de cada intento es como si empezásemos de nuevo a abrir la puerta</strong>. Tras 5 fracasos la probabilidad de que fallemos más de 4 veces más es la misma que cuando lo intentamos la primera vez.</p>
<p>¿Cuál es el número esperado de fracasos hasta abrir la puerta?</p>
<p><span class="math display">\[
E(X)=\frac{1-p}{p}=\frac{1-\frac{1}{10}}{\frac{1}{10}}=\frac{\frac{9}{10}}{\frac{1}{10}}=9.
\]</span></p>
<p>La varianza es <span class="math display">\[
Var(X)=\frac{1-p}{p^2}=\frac{1-\frac{1}{10}}{\left(\frac{1}{10}\right)^2}=\frac{\frac{9}{10}}{\frac{1}{100}}=
90.
\]</span></p>
<p>La desviación típica es <span class="math inline">\(\sqrt{90}=9.486833.\)</span></p>
</div>
</div>
<div class="exercise">
<p><strong>Ejemplo: partidos hasta que el Barça gana al Madrid</strong></p>
<p>Los partidos Real Madrid vs FC Barcelona de <strong>la liga</strong> española se suelen denominar <strong>El Clásico</strong>, sean en el Bernabeu (estadio del Real Madrid) o en el Camp Nou (estadio del Barça).</p>
<p>Sea <span class="math inline">\(X\)</span> la variable que cuenta el número de veces consecutivas que en un partido de fútbol de la liga el Barça no gana al Madrid sea en el Camp Nou o el Bernabeu.</p>
<p>Nuestra amiga Aina es muy culé (hincha del Barça) y quiere averiguar cuántos partidos consecutivos de <strong>El Clásico</strong> tiene que ver hasta ver ganar al Barça por primera vez.</p>
<p>Le interesa estimar cuánto le va a costar este capricho. Tendrá que comprar las entradas y pagar los viajes de Barcelona a Madrid.</p>
<p>En <a href="https://es.wikipedia.org/wiki/El_Cl%C3%A1sico">datos historicos de <strong>El clásico</strong> en la wikipedia</a> están los datos hasta el 3 de marzo de 2019: se han jugado en total 178 <strong>Clásicos</strong> donde el Real Madrid ganó en 72 ocasiones, el Barça en 72 y empataron 34 veces.</p>
<p>La pregunta es: ¿Cuántos partidos se tienen que jugar de media para ver ganar al Barça por primera vez?</p>
<div class="example-sol">
<p>Con los datos anteriores, podemos estimar que la probabilidad de que el Barça gane un clásico cualquiera es: <span class="math display">\[P(\mbox{Barça})=\frac{72}{178}=0.4045.\]</span></p>
<p>Por tanto, podemos modelar la variable <span class="math inline">\(X\)</span> con una ley geométrica con probabilidad de éxito <span class="math inline">\(p=P(\mbox{Barça})=\frac{72}{178}.\)</span></p>
<p>El número de partidos esperado para que el Barça gane por primera vez es:</p>
<p><span class="math display">\[E(X)=\frac{1-p}{p}=\frac{1-0.4045}{0.4045}=1.4722,\]</span> con una varianza de: <span class="math display">\[Var(X)=\frac{1-p}{p^2}=\frac{1-0.4045}{0.4045^2}=3.6397\]</span> y desviación típica: <span class="math display">\[\sqrt{3.6397}=1.9078.\]</span></p>
</div>
</div>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Veamos los cálculos básicos con <code>R</code> para la distribución geométrica <span class="math inline">\(Ge(p=0.25)\)</span>. <code>R</code> implementa la geométrica que cuenta el número de fracasos, <span class="math inline">\(P(X=0)=(1-0.25)^0\cdot 0.25^1=0.25\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dgeom</span>(<span class="dv">0</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
</div>
<p><span class="math inline">\(P(X\leq 0)=1- (1-0.25)^{0+1}=1-0.75=0.25\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgeom</span>(<span class="dv">0</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
</div>
<p><span class="math inline">\(P(X\leq 4)=1-(1-0.25)^{4+1}=1-0.75=1-0.75^5=0.7626953\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgeom</span>(<span class="dv">4</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7626953</code></pre>
</div>
</div>
<p>Una muestra aleatoria de tamaño 25 de una <span class="math inline">\(Ge(0.25)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rgeom</span>(<span class="at">n=</span><span class="dv">25</span>,<span class="at">prob=</span><span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  5  4  1  6 10  0  0 10  7  0  6  2  1  3  0  2  5  0  0  5  5  3  3  2  2</code></pre>
</div>
</div>
<p><strong>Gráficos con <code>R</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">dgeom</span>(x,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> Ge(p=0.25)"</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>aux0<span class="ot">=</span><span class="fu">dgeom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">prob=</span><span class="fl">0.25</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>ceros<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">21</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>ceros</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span>ceros</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>aux[<span class="dv">2</span><span class="sc">*</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>))]<span class="ot">&lt;-</span>aux0</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pgeom</span>(x,<span class="at">prob=</span><span class="fl">0.25</span>),</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">10</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> Ge(p=0.25)"</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/graficos22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Gráficas interactivas de la distribución Geométrica</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sliderInput</span>(<span class="st">"p_geom"</span>, <span class="at">label =</span> <span class="st">"Probabilidad de éxito:"</span>,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fl">0.01</span>, <span class="at">max =</span> <span class="fl">0.99</span>, <span class="at">value =</span><span class="fl">0.25</span> , <span class="at">step =</span> <span class="fl">0.01</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span>input<span class="sc">$</span>p_geom</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="dv">30</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dgeom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">prob=</span>p)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dgeom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">prob=</span>p),</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> Ge(p="</span>,p,<span class="st">")"</span>),<span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">pgeom</span>(x,<span class="at">prob=</span>p),</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> Ge(p="</span>,p,<span class="st">")"</span>),<span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_geometrica1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Cálculos con <code>Python</code></strong></p>
<p>Veamos los cálculos básicos con python para la distribución geométrica <span class="math inline">\(Ge(p=0.25)\)</span>. <code>scipy.stats</code> implementa la distribución geométrica que cuenta el número intentos, así que empieza en 1.</p>
<p>Cargamos la función de la librería</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> geom</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/geom1-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>La función de probabilidad es <code>geom.pmf(x,p,loc=0)=geom.pmf(x,p)</code>. Es una geométrica que cuenta el número de intentos para obtener el primer éxito y el valor por defecto del último parámetro es <code>loc=0</code>.</p>
<p>Si queremos la que cuenta el número de fracasos para obtener el primer éxito (la geométrica que empieza en 0) tenemos que usar <code>geom.pmf(x,p,loc=-1)</code>.</p>
<p>Es decir <code>geom.pmf(x,p,loc=-1)=geom.pmf(x-1,p,loc=0)</code></p>
<p>Veamos pues los cálculos para la <span class="math inline">\(Ge(p)\)</span> que empieza en <span class="math inline">\(0\)</span>.</p>
<p><span class="math inline">\(P(X=0)=(1-0.25)^0\cdot 0.25^1=0.25\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>geom.pmf(<span class="dv">0</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/py_geom_funciones1-3.png" class="img-fluid" width="480"></p>
</div>
</div>
<p><span class="math inline">\(P(X\leq 0)=1- (1-0.25)^{0+1}=1-0.75=0.25\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>geom.cdf(<span class="dv">0</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/py_geom_funciones2-5.png" class="img-fluid" width="480"></p>
</div>
</div>
<p><span class="math inline">\(P(X\leq 4)=1-(1-0.25)^{4+1}=1-0.75=1-0.75^5=0.7626953\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>geom.cdf(<span class="dv">4</span>,p<span class="op">=</span><span class="fl">0.25</span>,loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/py_geom_funciones3-7.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Una muestra aleatoria de tamaño 25 de una <span class="math inline">\(Ge(0.25)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>geom.rvs(p<span class="op">=</span><span class="fl">0.25</span>, size<span class="op">=</span><span class="dv">20</span>, loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/py_random_binom-9.png" class="img-fluid" width="480"></p>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>¿Qué probabilidades son las que calcula el siguiente código y qué tipo de variables geométricas son?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>geom.cdf(<span class="bu">range</span>(<span class="dv">5</span>),p<span class="op">=</span><span class="fl">0.3</span>,loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>geom.cdf(<span class="bu">range</span>(<span class="dv">5</span>),p<span class="op">=</span><span class="fl">0.3</span>,loc<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/unnamed-chunk-25-11.png" class="img-fluid" width="480"></p>
</div>
</div>
</div>
<p><strong>Cálculos con <code>Python</code> de la esperanza y varianza</strong></p>
<p>Con <code>Python</code> también podemos calcular directamente algunos parámetros asociados a una función de distribución predefinida</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>geom.stats(p<span class="op">=</span><span class="fl">0.25</span>, loc<span class="op">=</span><span class="dv">0</span>, moments<span class="op">=</span><span class="st">'mv'</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>geom.stats(p<span class="op">=</span><span class="fl">0.25</span>, loc<span class="op">=-</span><span class="dv">1</span>, moments<span class="op">=</span><span class="st">'mv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/py_mean_var_stats-13.png" class="img-fluid" width="480"></p>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Comprobad que las medias y las varianzas calculadas en el código anterior corresponden a una <span class="math inline">\(Ge(p=0.3)\)</span> empezando en <span class="math inline">\(1\)</span> y a una <span class="math inline">\(Ge(p=0.3)\)</span> empezando en <span class="math inline">\(0\)</span>.</p>
<p>¿Son las varianzas siempre iguales?</p>
</div>
<p><strong>Gráficos con <code>Python</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(geom.ppf(<span class="fl">0.01</span>, p),geom.ppf(<span class="fl">0.99</span>, p))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, geom.pmf(x, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'geom pmf'</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, geom.pmf(x, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>ax.plot(x, geom.cdf(x, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'geom pmf'</span>)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, geom.cdf(x, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribucion Geometrica'</span>)</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="3_files/figure-html/unnamed-chunk-26-15.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="distribución-binomial-negativa" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" data-anchor-id="distribución-binomial-negativa"><span class="header-section-number">4.1.4</span> Distribución binomial negativa</h3>
<p><strong>El problema de la puerta con dos cerraduras</strong></p>
<p>Supongamos que disponemos de 10 llaves distintas y tenemos que abrir una puerta con <strong>dos cerraduras</strong>.</p>
<p>Comenzamos por la primera cerradura, de tal forma que cada vez olvidamos qué llave hemos probado.</p>
<p>Una vez abierta la primera cerradura probamos de igual forma con la segunda hasta que también la abrimos.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de fracasos hasta abrir la puerta.</p>
<p>Acertar una llave de la puerta es un experimento Bernoulli con probabilidad de éxito <span class="math inline">\(p=0.1\)</span>. Lo repetiremos hasta obtener 2 éxitos.</p>
<p>En general, tendremos un experimento de Bernoulli con probabilidad de éxito <span class="math inline">\(0&lt;p&lt;1\)</span> tal que:</p>
<ul>
<li>Repetimos el experimento hasta obtener el <span class="math inline">\(n\)</span>-ésimo éxito ¡¡abrir la maldita puerta!!.</li>
<li>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número fallos hasta abrir la puerta, es decir, hasta conseguir el <span class="math inline">\(n\)</span>-ésimo éxito. Notemos que no contamos los éxitos, solo contamos los fracasos.</li>
</ul>
<p>Si representamos como es habitual un suceso como una cadena de F’s y E’s, para <span class="math inline">\(n=2\)</span>, algunos sucesos elementales serán: <span class="math display">\[\{EE,FEE,EFE, FFEE,FEFE,EFFE,FFFEE,FFEFE,FEFFE,EFFFE\}.\]</span></p>
<p>Calculemos algunas probabilidades para <span class="math inline">\(n=2\)</span>: <span class="math display">\[
\begin{array}{rl}
P(X=0) &amp; =P(\{EE\})=p^2, \\
P(X=1) &amp; =P(\{FEE,EFE\})=2\cdot (1-p)\cdot p^2, \\
P(X=2) &amp; =P(\{FFEE,FEFE,EFFE\})=3\cdot (1-p) 2\cdot p^2, \\
P(X=3) &amp; =P(\{FFFEE,FFEFE,FEFFE,EFFFE\})=4\cdot (1-p)^3\cdot p^2.
\end{array}
\]</span> En general, su función de probabilidad es <span class="math display">\[
P_{X}(k)=P(X=k)=\left\{\begin{array}{ll}
     {{k+n-1}\choose{n-1}} \cdot (1-p)^{k}\cdot p^n, &amp; \mbox{si } k=0,1,\ldots\\
     0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>Una v.a. con este tipo de distribución recibe el nombre de <strong>binomial negativa</strong> y la denotaremos por <span class="math inline">\(BN(n,p)\)</span>.</p>
<p>Notemos que <span class="math inline">\(BN(1,p)=Ge(p)\)</span>.</p>
<div class="dem">
<p><strong>Demostración</strong></p>
<p>Justifiquemos el resultado. Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(BN(n,p)\)</span> y sea <span class="math inline">\(k=0,1,2,\ldots\)</span></p>
<p><span class="math display">\[P(X=k)=P(\mbox{Todas las cadenas de E's y F' con $k$ F, con $n$ E y acabadas en E})\]</span></p>
<p><span class="math display">\[
\overbrace{\underbrace{\overbrace{EFFF\ldots EEF}^{n-1 \quad \mbox{Éxitos}.}}}_{k \quad\mbox{Fracasos}}^{k+n-1\mbox{ posiciones}}E
\]</span></p>
<p>De estas cadenas hay tantas como maneras de elegir de entre las <span class="math inline">\(k+n-1\)</span> primeras posiciones <span class="math inline">\(n-1\)</span> para colocar los éxitos. Esta cantidad es el número binomial <span class="math inline">\({k+n-1\choose n-1}\)</span>.</p>
</div>
<p><strong>Números binomiales negativos</strong></p>
<p>Dados dos enteros positivos <span class="math inline">\(n\)</span> y <span class="math inline">\(k\)</span>, se define el número binomial negativo como: <span class="math display">\[\binom{-n}{k}=\frac{(-n)(-n-1)\cdots (-n-k+1)}{k!}.\]</span> Los números binomiales negativos generalizan la fórmula de Newton para exponentes negativos: <span class="math display">\[
(t+1)^{-n}=\sum_{k=0}^{+\infty}\left(\begin{array}{c} -n
\\ k\end{array}\right) t^{k}.
\]</span></p>
<p><code>R</code> usa la función <code>choose</code> para calcular números binomiales, sean negativos o no. Veámoslo con un ejemplo: <span class="math display">\[
{-6\choose 4}=\frac{-6\cdot (-6-1)\cdot \cdot (-6-2)\cdot (-6-3) }{4!}= \frac{-6\cdot(-7)\cdot (-8)\cdot (-9)}{24}
= \frac{3024}{24}=126.
\]</span> Si realizamos el cálculo con <code>R</code> obtenemos el mismo resultado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 126</code></pre>
</div>
</div>
<p><strong>Esperanza de una <span class="math inline">\(BN(n,p)\)</span></strong></p>
<p>Su <strong>esperanza es</strong>:</p>
<p><span class="math display">\[E(X)=\sum_{k=0}^{+\infty} k\cdot {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n=n\cdot\frac{1-p}{p}.\]</span></p>
<p>La <strong>esperanza de <span class="math inline">\(X^2\)</span></strong> es:</p>
<p><span class="math display">\[E(X^2)=\sum_{k=0}^{+\infty} k^2\cdot {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n=n\cdot\frac{1-p}{p^2}+\left(n\cdot \frac{1-p}{p}\right)^2.\]</span></p>
<p><strong>Varianza de una <span class="math inline">\(BN(n,p)\)</span></strong></p>
<p>Por último, la <strong>varianza</strong> es: <span class="math display">\[
Var(X)=E(X^2)-E(X)^2=n\cdot \frac{1-p}{p^2}+\left(n\cdot \frac{1-p}{p}\right)^2-\left(n\cdot \frac{1-p}{p}\right)^2=
n\cdot \frac{1-p}{p^2},
\]</span> y la desviación típica es:</p>
<p><span class="math display">\[\sqrt{Var(X)} = \frac{\sqrt{n(1-p)}}{p}.\]</span></p>
<p><strong>Resumen Binomial Negativa <span class="math inline">\(BN(n,p)\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 53%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X = BN(n,p)\)</span></th>
<th style="text-align: left;">Número de fracasos antes de conseguir el <span class="math inline">\(n\)</span>-ésimo éxito. Probabilidad de éxito <span class="math inline">\(p\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{0,1,2,3\ldots\}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(P_X(k)=P(X=k)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} {k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n, &amp; \mbox{si } k=0,1,\ldots \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\begin{array}{l}\left\{\begin{array}{ll} 0, &amp; \mbox{si } x&lt;0\\\displaystyle\sum_{i=0}^{k} P(X=i) &amp; \mbox{si }\left\{\begin{array}{l}k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.\end{array}\right.\end{array}\)</span> Calcular la suma o utilizar funciones de <code>R</code> o <code>Python</code>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=n\cdot\frac{1-p}{p}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=n\cdot \frac{1-p}{p^2}\)</span></td>
</tr>
</tbody>
</table>
<div class="exercise">
<p><strong>Ejercicio: Puerta con dos cerraduras</strong></p>
<p>Recordemos nuestra puerta con dos cerraduras que se abren secuencialmente. Tenemos un manojo de 10 llaves casi idénticas de manera que cada vez que probamos una llave olvidamos qué llave hemos usado.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a que nos da el número de intentos fallidos hasta abrir abrir la puerta.</p>
<p>Estamos interesado en modelar este problema. La preguntas son:</p>
<ol type="1">
<li>¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span> la v.a que nos da el número fallos hasta abrir la puerta?</li>
<li>¿Cuál es la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>?</li>
<li>¿Cuál es la probabilidad de fallar exactamente 5 veces antes de abrir la puerta?</li>
<li>¿Cuál es la probabilidad de fallar más de 4?</li>
<li>¿Cuál es el número esperado de fallos? ¿Y su desviación típica?</li>
</ol>
<div class="example-sol">
<p><strong>Solución 1.</strong> ¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span> la v.a que nos da el número fallos hasta abrir la puerta?</p>
<p>Bajo estados condiciones tenemos que la probabilidad de “éxito” de cada intento es <span class="math inline">\(p=\frac{1}{10}=0.1\)</span>. Como cada vez <em>olvidamos</em> qué llave hemos probado, cada intento será independiente del anterior.</p>
<p>Así que la variable <span class="math inline">\(X\)</span> que queremos modelar cuenta el número de fallos de repeticiones sucesivas e independientes de un experimento <span class="math inline">\(Ber(p=0.1)\)</span> hasta conseguir 2 éxitos en un experimento.</p>
<p>Por lo tanto podemos asegurar que <span class="math inline">\(X\)</span> sigue un distribución <span class="math inline">\(BN(n=2,p=0.1).\)</span></p>
<p><strong>Solución 2.</strong> ¿Cuál es la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>?</p>
<p>En general la función de probabilidad de una <span class="math inline">\(BN(n,p)\)</span> es</p>
<p><span class="math display">\[
P_X(X=k)=
\left\{
\begin{array}{cc}
{k+n-1\choose n-1} \cdot (1-p)^{k}\cdot p^n, &amp; \mbox{si }  k=0,1,\ldots \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span> Si aplicamos la expresión anterior para <span class="math inline">\(n=2\)</span> y <span class="math inline">\(p=0.1\)</span>, obtenemos:</p>
<p><span class="math display">\[
P_X(X=k)=
\left\{
\begin{array}{cc}
{k+2-1\choose 2-1} \cdot 0.9^{k}\cdot 0.1^2, &amp; \mbox{si }  k=0,1,2,\ldots \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span> Simplificando, <span class="math display">\[
P_X(X=k)=P(X=k)=
\left\{
\begin{array}{cc}
0.01\cdot (k+1)\cdot 0.9^{k}, &amp; \mbox{si }  k=0,1,2,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span> La función de distribución en general es</p>
<p><span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0, &amp; \mbox{si } x&lt;0, \\
\displaystyle\sum_{i=0}^{k }{i+n-1\choose n-1} \cdot (1-p)^{i+n-1}\cdot p^n,
&amp; \mbox{si }\left\{\begin{array}{l} k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.
\end{array}
\right.
\]</span> Simplificando para <span class="math inline">\(n=2\)</span>, <span class="math inline">\(p=0.1\)</span>.</p>
<p><span class="math display">\[
F_X(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0, &amp; \mbox{si } x&lt;0, \\
\displaystyle\sum_{i=0}^{k }0.01\cdot (i+1) \cdot 0.9^{i+1},
&amp; \mbox{si }\left\{\begin{array}{l} k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.
\end{array}
\right.
\]</span></p>
<p><strong>Solución 3.</strong> ¿Cuál es la probabilidad de fallar exactamente 5 veces antes de abrir la puerta? <span class="math display">\[
P(X=5)= 0.01\cdot (5+1) \cdot 0.9^{5}= 0.06 \cdot 0.9^{5}= 0.0354294.
\]</span></p>
<p><strong>Solución 4.</strong> ¿Cuál es la probabilidad de fallar más de 4?</p>
<p>Nos piden calcular <span class="math inline">\(P(X&gt;4)=1-P(X\leq 4).\)</span></p>
<p>Calculemos primero <span class="math inline">\(P(X\leq 4):\)</span></p>
<p><span class="math display">\[
\begin{array}{rl}
P(X\leq 4) &amp;=  \displaystyle\sum_{x=0}^{4} P(X=x) \\ &amp; =P(X=0)+P(X=1)+P(X=2)+P(X=3)+P(X=4)\\
&amp;= 0.01\cdot (0+1) \cdot 0.9^{0}+0.01\cdot (1+1) \cdot 0.9^{1}+0.01\cdot (2+1) \cdot 0.9^{2} \\ &amp;\ \
+0.01\cdot (3+1) \cdot 0.9^{3} + 0.01\cdot (4+1) \cdot 0.9^{4} \\ &amp; =
0.01 +0.018+0.0243+0.02916+0.032805 = 0.114265.
\end{array}
\]</span></p>
<p>Por lo tanto</p>
<p><span class="math display">\[
P(X&gt;4)=1-P(X\leq 4)=1-0.114265=
0.885735.
\]</span></p>
</div>
<div class="example-sol">
<p><strong>Solución 5.</strong> ¿Cuál es el número esperado de fallos? ¿Y su desviación típica?</p>
<p>Como <span class="math inline">\(X\)</span> sigue una ley <span class="math inline">\(BN(n=2,p=0.1)\)</span></p>
<p><span class="math display">\[E(X)=n\cdot \frac{1-p}{p}=2\cdot \frac{1-0.1}{0.1}=18.\]</span></p>
<p>El número de fallos esperado es 18.</p>
<p>La varianza será: <span class="math display">\[
Var(X)=n\cdot\frac{1-p}{p^2}=2 \cdot \frac{1-0.1}{0.1^2}=180.
\]</span> La varianza de <span class="math inline">\(X\)</span> es 180 y su desviación típica <span class="math inline">\(\sqrt{180}=13.41641.\)</span></p>
</div>
</div>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>La función de <code>R</code> que calcula la función de probabilidad de la binomial negativa con sus parámetros básicos es:</p>
<pre><code>dnbinom(x, size, prob,...)`</code></pre>
<p>donde <code>size</code> (<span class="math inline">\(n\)</span>) es el número de éxitos y <code>prob</code> (<span class="math inline">\(p\)</span>), la probabilidad de éxito.</p>
<p>Así, en el ejemplo de la puerta con dos cerraduras, <span class="math inline">\(X\)</span> es una <span class="math inline">\(BN(n=size=2,p=prob=0.1)\)</span>. Por ejemplo, <span class="math inline">\(P(X=5)\)</span> que hemos calculado en el ejemplo anterior, vale:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnbinom</span>(<span class="dv">5</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">p=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0354294</code></pre>
</div>
</div>
<p>De forma similar calculamos calculamos <span class="math inline">\(P(X\leq 4)\)</span>, <span class="math inline">\(P(X&gt;4)=1-P(X\leq 4)\)</span> y <span class="math inline">\(P(X&gt;4)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">p=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.114265</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">p=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.885735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnbinom</span>(<span class="dv">4</span>,<span class="at">size=</span><span class="dv">2</span>,<span class="at">p=</span><span class="fl">0.1</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.885735</code></pre>
</div>
</div>
<p><strong>Cálculos con <code>Python</code></strong></p>
<p>La función con <code>Python</code> es <code>nbinom.pmf(k, n, p, loc)</code>. Hay que cargarla desde <code>scpi.stats</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> nbinom</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recordemos que de nuevo se cumple que</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>nbinom.pmf(k, n, p, loc) <span class="op">=</span> nbinom.pmf(k<span class="op">-</span>loc, n, p)`</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>nbinom.pmf(k<span class="op">=</span><span class="dv">5</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0354294</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>nbinom.pmf(k<span class="op">=</span><span class="dv">5</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>,loc<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0354294</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>nbinom.cdf(k<span class="op">=</span><span class="dv">4</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.11426500000000002</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>nbinom.cdf(k<span class="op">=</span><span class="dv">4</span>,n<span class="op">=</span><span class="dv">2</span>,p<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8857349999999999</code></pre>
</div>
</div>
<p>Generemos 100 observaciones aleatorias de una <span class="math inline">\(BN(n=2,0.1)\)</span>. Es decir serán las veces que hemos fallado hasta abrir la puerta 100 veces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>nbinom.rvs(n<span class="op">=</span><span class="dv">2</span>, p<span class="op">=</span><span class="fl">0.1</span>, size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([41, 11, 29, 23, 67, 14, 16,  9, 10, 14, 33, 24, 17, 42, 11, 10, 30,
        8, 17,  7, 10,  9, 19, 29, 22, 15, 10, 12, 48, 12, 24, 20,  0,  6,
       28, 14, 34, 15, 28, 28, 44,  1, 20,  6, 18, 58,  9, 20,  1, 21, 24,
       24, 19, 30, 10,  2, 17,  7, 34, 34,  5, 24, 32, 15, 49,  8,  8,  7,
       14, 36, 23, 16, 19, 27, 20, 16, 23, 12, 22, 16,  6,  4,  6, 14,  9,
       11, 23,  6,  7, 29, 22, 20,  4,  6, 22, 12,  9, 11,  8,  8],
      dtype=int64)</code></pre>
</div>
</div>
<p>La <strong>esperanza</strong> y la <strong>varianza</strong>de una <span class="math inline">\(BN(n=2,0.1)\)</span> valen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>n, p<span class="op">=</span><span class="dv">2</span>,<span class="fl">0.1</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> nbinom.stats(n,p,moments<span class="op">=</span><span class="st">'mv'</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"E(X)=</span><span class="sc">{m}</span><span class="st">"</span>.<span class="bu">format</span>(m<span class="op">=</span>params[<span class="dv">0</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(X)=18.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Var(X)=</span><span class="sc">{v}</span><span class="st">"</span>.<span class="bu">format</span>(v<span class="op">=</span>params[<span class="dv">1</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Var(X)=179.99999999999997</code></pre>
</div>
</div>
<p><strong>Gráficas de la binomial negativa con <code>R</code></strong></p>
<p>El siguiente código de <code>R</code> dibuja las función de probabilidad y la de distribución de una <span class="math inline">\(BN(n=2,p=0.1)\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">22</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>aux[<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">22</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dnbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size=</span><span class="dv">2</span>,<span class="at">prob=</span><span class="fl">0.1</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">y=</span><span class="fu">dnbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size=</span><span class="dv">2</span>,<span class="at">prob=</span><span class="fl">0.1</span>),</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> BN(n=2,p=0.1)"</span>)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pnbinom</span>(x,<span class="at">size=</span><span class="dv">2</span>,<span class="at">prob=</span><span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">11</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> BN(n=2,p=0.1)"</span>)</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Gráficas interactivas binomial negativa</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"n_nbinom"</span>, <span class="at">label =</span> <span class="st">"Número de éxitos n:"</span>,</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span><span class="dv">20</span> , <span class="at">step =</span> <span class="dv">1</span>)),</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"p_nbinom"</span>, <span class="at">label =</span> <span class="st">"Probabilidad de un éxito p:"</span>,</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="fl">0.01</span>, <span class="at">max =</span> <span class="fl">0.99</span>, <span class="at">value =</span> <span class="fl">0.8</span>, <span class="at">step =</span> <span class="fl">0.01</span>)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>input<span class="sc">$</span>n_nbinom</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>  pr<span class="ot">=</span>input<span class="sc">$</span>p_nbinom</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dnbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">size=</span>n,<span class="at">prob=</span>pr)</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dnbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">size=</span>n,<span class="at">prob=</span>pr),</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> BN(n="</span>,n,<span class="st">",p="</span>,pr,<span class="st">")"</span>),</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">pnbinom</span>(x,<span class="at">size=</span>n,<span class="at">p=</span>pr),</span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> BN(n="</span>,n,<span class="st">",p="</span>,pr,<span class="st">")"</span>),</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_binomial_negativa1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Buscad en los manuales de <code>Python</code> cómo se dibuja la función de probabilidad y de distribución de una binomial. negativa</p>
<div class="exercise-sol">
<p>Necesitamos de nuevo más librerías</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> nbinom</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="dv">10</span>, <span class="fl">0.25</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>,nbinom.ppf(<span class="fl">0.99</span>, n, p))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>ax.plot(x, nbinom.pmf(x, n, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'nbinom pmf'</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, nbinom.pmf(x, n, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>ax.plot(x, nbinom.cdf(x, n, p), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'nbinom pmf'</span>)</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, nbinom.cdf(x, n, p), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribucion Binomial Negativa'</span>)</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&lt;string&gt;:2: MatplotlibDeprecationWarning: The label function was deprecated in Matplotlib 3.1 and will be removed in 3.8. Use Tick.label1 instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="3_files/figure-html/negativa_py_show-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio: acceso aleatorio a un sistema con triple clave</strong></p>
<p>Supongamos que tenemos un sistema informático que tiene un programa de seguridad que genera accesos con claves de 3 dígitos <span class="math inline">\(000,001,\ldots 999\)</span>. En total tenemos 1000 posibilidades.</p>
<p>Como una clave de tres dígitos es fácil de romper, proponemos considerar tres claves consecutivas de acceso al sistema, cada una de 3 dígitos.</p>
<p>Para acceder al sistema hay que dar las tres claves de forma consecutiva y por orden.</p>
<p>Es decir hasta que no averiguamos la primera clave no pasamos a la segunda clave.</p>
<p>Supongamos que cada vez que ponemos las dos claves olvidamos el resultado y seguimos poniendo claves al azar hasta adivinar la contraseña.</p>
<p>Así hasta conseguir entrar en el sistema.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a que nos da el número de fallos antes de entrar en el sistema.</p>
<p>Estamos interesados en modelar este problema. La preguntas son:</p>
<ol type="1">
<li>¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span>, la v.a que nos da el número de fallos antes de acceder al sistema.</li>
<li>¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span>?</li>
<li>¿Cuál es la probabilidad de fallar 150 veces antes de acceder en el sistema?</li>
<li>¿Cuál es la probabilidad de fallar más de 150 veces antes de entrar en el sistema?</li>
<li>¿Cuál es el número esperado de fallos antes de acceder al sistema? ¿Y su varianza?</li>
</ol>
<div class="exercise-sol">
<p><strong>Solución 1.</strong> ¿Cuál es la distribución de probabilidad de <span class="math inline">\(X\)</span>, la v.a que nos da el número de fallos antes de acceder al sistema?</p>
<p>Bajo estas dos condiciones tenemos que la probabilidad de “éxito” de cada intento es <span class="math inline">\(p=\frac{1}{1000}=0.001\)</span>. Y como cada vez <em>olvidamos</em> los dígitos cada intento será independiente del anterior.</p>
<p>Así que la variable <span class="math inline">\(X\)</span> cuenta el número de fracasos independientes hasta conseguir 3 éxitos en un experimento <span class="math inline">\(Ber(p=0.001)\)</span>, por lo tanto <span class="math inline">\(X\)</span> sigue un distribución <span class="math inline">\(BN(n=3,p=0.001).\)</span></p>
<p><strong>Solución 2.</strong> ¿Cuál es la función de probabilidad y de distribución del <span class="math inline">\(X\)</span></p>
<p>En general la función de probabilidad de una <span class="math inline">\(BN(n,p)\)</span> es:</p>
<p><span class="math display">\[
P_X(X=x)=P(X=x)=
\left\{
\begin{array}{cc}
{x+n-1\choose n-1} \cdot (1-p)^{x}\cdot p^n, &amp; \mbox{si }  x=0,1,\ldots \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span> En particular la función de probabilidad de una <span class="math inline">\(BN(n=3,p=0.001)\)</span> es</p>
<p><span class="math display">\[
P_X(X=x)=P(X=x)=
\left\{
\begin{array}{cc}
{x+2\choose 2} \cdot 0.999^{x}\cdot 0.001^3 &amp; \mbox{si }  x=0,1,2,\ldots \\ 0 &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p><strong>Solución 3.</strong> ¿Cuál es la probabilidad de fallar 150 veces antes de acceder en el sistema?</p>
<p>Nos piden calcular la probabilidad siguiente: <span class="math display">\[
P(X=150)= {152\choose 2} \cdot 0.999^{150}\cdot 0.001^3.
\]</span> Realizaremos el cálculo anterior con ayuda de <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">choose</span>(<span class="dv">152</span>,<span class="dv">2</span>)<span class="sc">*</span><span class="fl">0.999</span><span class="sc">^</span><span class="dv">150</span><span class="sc">*</span><span class="fl">0.001</span><span class="sc">^</span><span class="dv">3</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.876743e-06</code></pre>
</div>
</div>
<p>o, usando la función de <code>R</code> que nos calcula la función de probabilidad:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnbinom</span>(<span class="dv">150</span>,<span class="at">size=</span><span class="dv">3</span>,<span class="at">p=</span><span class="fl">0.001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.876743e-06</code></pre>
</div>
</div>
<p>Si queremos calcular la probabilidad anterior con <code>Python</code>, tenemos que hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span>  scipy.special <span class="im">import</span> binom</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>binom(<span class="dv">152</span>,<span class="dv">2</span>)<span class="op">*</span><span class="fl">0.999</span><span class="op">**</span><span class="dv">150</span><span class="op">*</span><span class="fl">0.001</span><span class="op">**</span><span class="dv">3</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9.876743459670526e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>nbinom.pmf(<span class="dv">150</span>,n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9.876743459670532e-06</code></pre>
</div>
</div>
<p>Vemos que es muy improbable fallar 150 veces antes de acceder al sistema.</p>
<p><strong>Solución 4.</strong> ¿Cuál es la probabilidad de fallar más de 150 veces antes de entrar en el sistema?</p>
<p>Nos piden calcular la probabilidad siguiente: <span class="math display">\[P(X&gt;150)=1-P(X\leq 150).\]</span></p>
<p>Calculemos <span class="math inline">\(P(X\leq 150)\)</span> <span class="math display">\[
\begin{array}{rl}
P(X\leq 150) &amp;= P(X=0)+P(X=1)+P(X=2)+\ldots+P(X=150) \\ &amp; = \sum\limits_{k=0}^{150} {k+3-1\choose 3-1} \cdot (0.999)^{k}\cdot 0.001^3= \ldots = 5.2320035\times 10^{-4}
\end{array}
\]</span> Si hacemos el cálculo con <code>R</code>, obtenemos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnbinom</span>(<span class="dv">150</span>,<span class="dv">3</span>,<span class="fl">0.001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0005232003</code></pre>
</div>
</div>
<p>Si lo hacemos en <code>Python</code>, obtenemos el mismo resultado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>nbinom.cdf(<span class="dv">150</span>,n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0005232003490824064</code></pre>
</div>
</div>
<p>El valor pedido será pues: <span class="math display">\[
P(X&gt;150)=1-P(X\leq 150)=1-5.2320035\times 10^{-4}=0.9994768.
\]</span> Vemos que es muy probable que fallemos más de 150 veces antes de entrar en el sistema.</p>
<p><strong>Solución 5.</strong> ¿Cuál es el número esperado de fallos antes de acceder al sistema? ¿Y su varianza?</p>
<p><span class="math display">\[E(X)=n\cdot \frac{1-p}{p}=3\cdot \frac{1- 0.001}{0.001}=2997.\]</span> <span class="math display">\[Var(X)=n\cdot \frac{1-p}{p^2}=3\cdot \frac{1- 0.001^2}{0.001^2}=2.997\times 10^{6}.\]</span></p>
<p>Con <code>Python</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> nbinom.stats(n<span class="op">=</span><span class="dv">3</span>,p<span class="op">=</span><span class="fl">0.001</span>,moments<span class="op">=</span><span class="st">'mv'</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"E(X) = </span><span class="sc">{m}</span><span class="st">"</span>.<span class="bu">format</span>(m<span class="op">=</span>params[<span class="dv">0</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>E(X) = 2997.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Var(X) = </span><span class="sc">{v}</span><span class="st">"</span>.<span class="bu">format</span>(v<span class="op">=</span>params[<span class="dv">1</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Var(X) = 2997000.0</code></pre>
</div>
</div>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio: ¿Tres claves de tres dígitos o una de 9 dígitos?</strong></p>
<p>Supongamos que ponemos una sola clave de 9 dígitos. Estudiemos en este caso la variable aleatoria que da el número de fallos antes de entrar en el sistema y comparemos los resultados.</p>
<div class="exercise-sol">
<p>Si seguimos suponiendo que cada vez ponemos la contraseña al azar, pero esta vez con una clave de 9 dígitos. La probabilidad de éxito será ahora <span class="math inline">\(p=\frac{1}{10^{9}}\)</span>.</p>
<p>Si llamamos <span class="math inline">\(X_9\)</span> a la variable aleatoria que nos da el número de fallos antes de entra en el sistema seguirá una distribución <span class="math inline">\(Ge(p=\frac{1}{10^9}=0.000000001)\)</span>.</p>
<p>Su valor esperado es</p>
<p><span class="math display">\[
E(X_9)=\frac{1-p}{p}=\frac{1-0.000000001}{0.000000001}=10\times 10^{8}.
\]</span></p>
<p><span class="math inline">\(1000 000 000\)</span> son 1000 millones de fallos esperados hasta abrir la puerta.</p>
<p>Recordemos que con tres contraseñas de 3 dígitos el valor esperado de fallos era:</p>
<p><span class="math display">\[3\cdot \frac{1-0.001}{0.001}=2997.\]</span></p>
<p>Por lo tanto, desde el punto de vista de la seguridad, es mejor una clave larga de 9 dígitos que tres cortas si escribimos las contraseñas al azar.</p>
</div>
</div>
</section>
<section id="distribución-de-poisson" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" data-anchor-id="distribución-de-poisson"><span class="header-section-number">4.1.5</span> Distribución de Poisson</h3>
<p>Diremos que una v.a. discreta <span class="math inline">\(X\)</span> con <span class="math inline">\(X(\Omega)=\mathbb{N}\)</span> tiene distribución de Poisson con parámetro <span class="math inline">\(\lambda&gt;0\)</span>, y lo denotaremos por <span class="math inline">\(Po(\lambda)\)</span> si su función de probabilidad es:</p>
<p><span class="math display">\[
P_{X}(x)=P(X=x)=
\left\{\begin{array}{ll}
\frac{\lambda^x}{x!} e^{-\lambda},&amp; \mbox{ si } x=0,1,\ldots\\
0, &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>Usando que el desarrollo en serie de Taylor de la función exponencial es <span class="math display">\[
e^{\lambda}=\sum_{x=0}^{+\infty} \frac{\lambda^x}{x!},
\]</span> es fácil comprobar que la suma de la función de probabilidad en todos los valores del dominio de <span class="math inline">\(X\)</span>, o sea, los enteros positivos, vale 1.</p>
<p>Además, recordemos que dado <span class="math inline">\(x\in\mathbb{R}-\{0\}\)</span> se tiene que</p>
<p><span class="math display">\[
\lim_{n\to\infty} \left(1+\frac{x}{n}\right)^n=e^x.
\]</span></p>
<p>Usando la expresión anterior para <span class="math inline">\(x=-\lambda\)</span>, tenemos: <span class="math display">\[
\lim_{n\to\infty} \left(1-\frac{\lambda}{n}\right)^n=\lim_{n\to\infty} \left(1+\frac{-\lambda}{n}\right)^n=e^{-\lambda}.
\]</span></p>
<p><strong>La distribución de Poisson como “límite” de una binomial</strong></p>
<p>La distribución de Poisson (<a href="https://es.wikipedia.org/wiki/Sim%C3%A9on_Denis_Poisson">Siméon Denis Poisson</a>) aparece en el conteo de determinados eventos que se producen en un intervalo de tiempo o en el espacio.</p>
<p>Supongamos que nuestra variable de interés es <span class="math inline">\(X\)</span>, el número de eventos en el intervalo de tiempo <span class="math inline">\((0,t]\)</span>, como por ejemplo el número de llamadas a un <em>call center</em> en una hora donde suponemos que se cumplen las siguientes condiciones:</p>
<ol type="1">
<li>El número promedio de eventos en el intervalo <span class="math inline">\((0,t]\)</span> es <span class="math inline">\(\lambda&gt;0\)</span>.</li>
<li>Es posible dividir el intervalo de tiempo en un gran número de subintervalos (denotemos por <span class="math inline">\(n\)</span> al número de intervalos) de forma que:
<ul>
<li>La probabilidad de que se produzcan dos o más eventos en un subintervalo es despreciable.</li>
<li>El número de ocurrencias de eventos en un intervalo es independiente del número de ocurrencias en otro intervalo.</li>
<li>La probabilidad de que un evento ocurra en un subintervalo es <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>·</li>
</ul></li>
</ol>
<p>Bajo estas condiciones, podemos considerar que el número de eventos en el intervalo <span class="math inline">\((0,t]\)</span> será el número de “éxitos” en <span class="math inline">\(n\)</span> repeticiones independientes de un proceso Bernoulli de parámetro <span class="math inline">\(p_n\)</span>.</p>
<p>Entonces si <span class="math inline">\(n\to\infty\)</span> y <span class="math inline">\(p_n\cdot n\)</span> se mantiene igual a <span class="math inline">\(\lambda\)</span>, resulta que la función de probabilidad de <span class="math inline">\(X_n\)</span> se puede escribir como</p>
<p><span class="math display">\[
\begin{array}{rl}
P(X_n=k)&amp;=\left(\begin{array}{c} n\\ k\end{array}\right) \cdot p_n^k\cdot  (1-p_n)^{n-k}
\\
&amp;= {n\choose k}\cdot \left(\frac{\lambda}{n}\right)^{k}\cdot \left(1-\frac{\lambda}{n}\right)^{n-k}\\
&amp;=
\frac{\lambda^k}{k!}\cdot\frac{n!}{(n-k)!\cdot n^k}\cdot
\left(1-\frac{\lambda}{n}\right)^{n}\cdot \left(1-\frac{\lambda}{n}\right)^{-k}.
\end{array}
\]</span> Si hacemos tender <span class="math inline">\(n\)</span> hacia <span class="math inline">\(\infty\)</span>, obtenemos: <span class="math display">\[
\displaystyle\lim_{n\to \infty} P(X_n=k) = \lim_{n\to \infty} \frac{\lambda^k}{k!}\cdot\frac{n!}{(n-k)!\cdot n^k} \cdot
\left(1-\frac{\lambda}{n}\right)^{n}\cdot \left(1-\frac{\lambda}{n}\right)^{-k}.
\]</span></p>
<p>Calculemos el límite de algunos de los factores de la expresión</p>
<p><span class="math display">\[
\begin{array}{rl}
\lim\limits_{n\to \infty}\frac{n!}{(n-k)!\cdot n^k} &amp; = \lim\limits_{n\to \infty}\frac{n\cdot (n-1)\cdots (n-k-1)}{n^k}
=\lim\limits_{n\to \infty}\frac{n^{k}+\cdots}{n^k}=1, \\
\lim\limits_{n\to \infty} \left(1-\frac{\lambda}{n}\right)^{n} &amp; =e^{-\lambda},\\
\lim\limits_{n\to \infty} \left(1-\frac{\lambda}{n}\right)^{-k} &amp; =\lim\limits_{n\to \infty} 1^{-k}=\lim\limits_{n\to \infty}  1=1,
\end{array}
\]</span> donde en el último límite, hemos tenido en cuenta que <span class="math inline">\(k\)</span> es constante.</p>
<p>Usando las expresiones halladas anteriormente, tenemos que el límite de la función de probabilidad de la variable <span class="math inline">\(X_n\)</span> tiende a la función de probabilidad de la variable de Poisson de parámetro <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[
\displaystyle\lim_{n\to\infty} P(X_n=k)=
\lim_{n\to\infty} \left(\begin{array}{c} n\\ k\end{array}\right)
\cdot p_n^k \cdot (1-p_n)^{n-k}= \frac{\lambda^k}{k!}\cdot 1 \cdot e^{-\lambda}\cdot 1=\frac{\lambda^k}{k!}\cdot e^{-\lambda}.
\]</span> Usando que las variables <span class="math inline">\(X_n\)</span> tienen distribución <span class="math inline">\(B(n,p_n=\frac{\lambda}{n})\)</span>, tenemos que el límite de binomiales de parámetros <span class="math inline">\(n\)</span> y <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span> es una distribución de Poisson de parámetro <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(Po(\lambda)\)</span>.</p>
<p><strong>Procesos de Poisson</strong></p>
<p>Lo interesante de las variables Poisson es que podemos modificar (si el modelo lo permite) el intervalo de tiempo <span class="math inline">\((0,t]\)</span> en el que contamos los eventos, siempre y cuando se cumplan las condiciones 1 y 2 enunciadas anteriormente en el nuevo intervalo de tiempo.</p>
<p>En general, podemos afirmar si la variable es Poisson en <span class="math inline">\((0,t]\)</span>, también lo será en cualquier subintervalo <span class="math inline">\((0,t']\)</span> para todo <span class="math inline">\(t'\)</span> tal que <span class="math inline">\(0&lt;t'&lt;t\)</span>.</p>
<p>De esta forma, podremos definir una serie de variables <span class="math inline">\(X_t\)</span> de distribución <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<p><l class="prop"> <strong>Definición de procesos de Poisson</strong> </l></p>
<p>Consideremos un experimento <em>Poisson</em> con <span class="math inline">\(\lambda\)</span> igual al promedio de eventos en una unidad de tiempo (u.t.).</p>
<p>Si <span class="math inline">\(t\)</span> es una cantidad de tiempo en u.t., la v.a. <span class="math inline">\(X_{t}\)</span> definida como el número de eventos en el intervalo <span class="math inline">\((0,t]\)</span> es una <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<p>El conjunto de variables <span class="math inline">\(\{X_t\}_{t&gt;0}\)</span> recibe el nombre de <strong>proceso de Poisson</strong>.</p>
<p><strong>Resumen de la distribución de Poisson <span class="math inline">\(X\equiv Po(\lambda)\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X\)</span> Poisson</th>
<th style="text-align: left;"><span class="math inline">\(\lambda\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{0,1,\ldots \}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} \frac{\lambda^x}{x!}e^{-\lambda}, &amp; \mbox{ si } x=0,1,\ldots\\ 0, &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq x)=\sum_{i=0}^kP(X = i)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\begin{array}{l}\left\{\begin{array}{ll} 0, &amp; \mbox{si } x&lt;0,\\\displaystyle\sum_{i=0}^{k} \frac{\lambda^i}{i!}\cdot e^{-\lambda}, &amp; \mbox{si }\left\{\begin{array}{l}k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.\end{array}\right.\end{array}\)</span> Calcular la suma o utilizar funciones de <code>R</code> o <code>Python</code>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=\lambda\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=\lambda\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Resumen proceso Poisson <span class="math inline">\(X_t\equiv Po(\lambda\cdot t)\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X_t\)</span> <span class="math inline">\(Po(\lambda\cdot t)\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\lambda\)</span> promedio por u.t.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\{0,1,\ldots \}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} \frac{(\lambda\cdot t)^x}{x!}e^{-\lambda\cdot t} &amp; \mbox{ si } x=0,1,\ldots\\ 0 &amp; \mbox{ en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq X)=\sum_{i=0}^kP(X = i)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\begin{array}{l}\left\{\begin{array}{ll} 0, &amp; \mbox{si } x&lt;0,\\\displaystyle\sum_{i=0}^{k} \frac{(\lambda\cdot t)^i}{i!}\cdot e^{-\lambda\cdot t}, &amp; \mbox{si }\left\{\begin{array}{l}k\leq x&lt; k+1,\\k=0,1,2,\ldots\end{array}\right.\end{array}\right.\end{array}\)</span> Calcular la suma o utilizar funciones de <code>R</code> o <code>Python</code>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=\lambda\cdot t\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=\lambda\cdot t\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Aproximación de la distribución binomial por la Poisson</strong></p>
<p>Dada una variable aleatoria de distribución <span class="math inline">\(B(n,p)\)</span>, si <span class="math inline">\(n\)</span> es grande y <span class="math inline">\(p\)</span> es pequeño podemos aproximar la distribución anterior por una distribución Poisson de parámetro <span class="math inline">\(\lambda=n\cdot p\)</span>, <span class="math inline">\(Po(\lambda = n\cdot p)\)</span>.</p>
<p>Un criterio para decidir que la aproximación anterior es buena es que <span class="math inline">\(n\geq 20\)</span>, o mejor, <span class="math inline">\(n\geq 30\)</span>, <span class="math inline">\(n\cdot p &lt; 10\)</span> y <span class="math inline">\(p\leq 0.05.\)</span></p>
<p>La aproximación de la función de probabilidad de una variable binomial a una variable de Poisson es óptima en los valores cercanos a <span class="math inline">\(E(X)=\lambda\)</span>.</p>
<p><strong>Gráficos de la aproximación binomial a la de Poisson</strong></p>
<p>Suponemos que estamos en las condiciones anteriores: <span class="math inline">\(n\geq 20\)</span>, <span class="math inline">\(n\cdot p &lt; 10\)</span>, <span class="math inline">\(p\leq 0.05\)</span>.</p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"n_binomP"</span>, <span class="at">label =</span> <span class="st">"Número de repeticiones n:"</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">100</span>, <span class="at">value =</span><span class="dv">20</span> , <span class="at">step =</span> <span class="dv">1</span>)),</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"p_binomP"</span>, <span class="at">label =</span> <span class="st">"Probabilidad éxito p:"</span>,</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="fl">0.001</span>, <span class="at">max =</span> <span class="fl">0.9</span>, <span class="at">value =</span> <span class="fl">0.05</span>, <span class="at">step =</span> <span class="fl">0.001</span>)</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>input<span class="sc">$</span>n_binomP</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>  pr<span class="ot">=</span>input<span class="sc">$</span>p_binomP</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">size=</span>n,<span class="at">prob=</span>pr)</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">size=</span>n,<span class="at">prob=</span>pr),</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Funciones de probabilidad</span><span class="sc">\n</span><span class="st"> B(n="</span>,n,<span class="st">",p="</span>,pr,<span class="st">"), </span></span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a><span class="st">                     Po(lambda="</span>,n<span class="sc">*</span>pr,<span class="st">")"</span>),<span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux,<span class="at">pch=</span><span class="dv">21</span>, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),n<span class="sc">*</span>pr)</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),n<span class="sc">*</span>pr),</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,<span class="at">pch=</span><span class="dv">25</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">3</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Binomial"</span>,<span class="st">"Poisson"</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>), </span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">25</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">pbinom</span>(x,<span class="at">size=</span>n,<span class="at">p=</span>pr),</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Funciones de distribución </span><span class="sc">\n</span><span class="st"> B(n="</span>,n,<span class="st">",p="</span>,pr,<span class="st">"),</span></span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a><span class="st">                       Po(lambda="</span>,n<span class="sc">*</span>pr,<span class="st">")"</span>),<span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">ppois</span>(x,n<span class="sc">*</span>pr),</span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"red"</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">c</span>(n<span class="sc">&gt;=</span><span class="dv">20</span>,n<span class="sc">*</span>pr<span class="sc">&lt;</span><span class="dv">10</span>,pr<span class="sc">&lt;=</span> <span class="fl">0.05</span>))){aux_l<span class="ot">=</span><span class="st">"Condición</span><span class="sc">\n</span><span class="st"> TRUE"</span>} <span class="cf">else</span> </span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>    {aux_l<span class="ot">=</span><span class="st">"Condición</span><span class="sc">\n</span><span class="st"> FALSE"</span>}</span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(aux_l,<span class="fu">paste0</span>(<span class="st">"n="</span>,n),<span class="fu">paste0</span>(<span class="st">"n*p="</span>,n<span class="sc">*</span>pr),</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">"p="</span>,pr)),<span class="at">bg=</span><span class="st">"transparent"</span>,<span class="at">cex=</span><span class="fl">0.8</span>,<span class="at">bty =</span> <span class="st">"n"</span>)</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_Poisson1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<div class="example">
<p><strong>Ejemplo de una distribución de Poisson <span class="math inline">\(Po(\lambda)\)</span>: trampa para insectos</strong></p>
<p>La conocida <a href="https://es.wikipedia.org/wiki/Insecticida_el%C3%A9ctrico">lámpara antiinsectos o insecticida eléctrico</a> atrae a los insectos voladores con una luz ultravioleta y los mata por electrocución.</p>
<p>Consideremos la v.a. <span class="math inline">\(X\)</span> que cuenta el número de insectos caídos en la trampa en una hora. Supongamos que el número promedio de insectos que captura la trampa en una hora es <span class="math inline">\(E(X)=20\)</span> y que podemos admitir que <span class="math inline">\(X\)</span> sigue una ley de probabilidad <span class="math inline">\(Po(\lambda=20)\)</span>.</p>
<p>Nos piden</p>
<ol type="1">
<li>Comentar de forma breve si se cumplen intuitivamente las condiciones para tener una distribución Poisson.</li>
<li>Escribir de forma explícita la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>.</li>
<li>Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</li>
<li>Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</li>
<li>¿Cuál es el valor esperando, la varianza y la desviación típica de <span class="math inline">\(X\)</span>?</li>
</ol>
<div class="example-sol">
<p><strong>Solución 1.</strong> Comentar de forma breve si se cumplen intuitivamente las condiciones para tener una distribución Poisson.</p>
<ol type="1">
<li>El número promedio de eventos en el intervalo <span class="math inline">\((0,1]\)</span>, una hora es <span class="math inline">\(\lambda=20&gt;0\)</span>.</li>
<li>Es posible dividir el intervalo de tiempo de una hora en un gran número de subintervalos (denotemos por <span class="math inline">\(n\)</span> al número de intervalos) de forma que:
<ul>
<li>La probabilidad de que se produzcan dos o más electrocuciones un subintervalo es despreciable. No es posible que dos mosquitos se electrocuten al mismo tiempo.</li>
<li>El número de ocurrencias, electrocuciones de insectos, en un intervalo es independiente del número de electrocuciones en otro intervalo.</li>
<li>La probabilidad de que un evento ocurra en un subintervalo es <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>· Podemos dividir los 20 insectos promedio entre los <span class="math inline">\(n\)</span> intervalos (trozo de hora) de forma que <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>.</li>
<li>Por ejemplo si <span class="math inline">\(n=60\)</span> tenemos que <span class="math inline">\(p_n=\frac{20}{60}=\frac{1}{3}\)</span>. La probabilidad de que en un minuto la trampa chisporrotee es <span class="math inline">\(\frac{1}{3}\)</span>.</li>
</ul></li>
</ol>
<p><strong>Solución 2.</strong> Escribid de forma explícita la función de probabilidad y de distribución de <span class="math inline">\(X\)</span>.</p>
<p>La distribución de probabilidad de un <span class="math inline">\(Po(\lambda)\)</span> es</p>
<p><span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}  \frac{\lambda^x}{x!}e^{-\lambda}, &amp; \mbox{ si } x=0,1,\ldots\\ 0,  &amp; \mbox{ en otro caso.}\end{array}\right.
\]</span></p>
<p>En nuestro caso, <span class="math inline">\(\lambda =20\)</span>: <span class="math display">\[
P_X(x)=P(X=x)=\left\{\begin{array}{ll}\frac{20^x}{x!}e^{-20}, &amp; \mbox{ si } x=0,1,\ldots\\ 0,  &amp; \mbox{ en otro caso.}\end{array}\right.
\]</span> La función de distribución es:</p>
<p><span class="math display">\[
F_X(x)=P(X\leq X)=
\left\{\begin{array}{ll}
0, &amp; \mbox{si } x&lt;0,\\
\displaystyle\sum_{i=0}^{k} P(X=i)=\sum_{i=0}^{k}\frac{\lambda^i}{i!}\cdot e^{-\lambda}, &amp; \mbox{si  }
\left\{\begin{array}{l}
k\leq x&lt; k+1,\\k=0,1,2,\ldots
\end{array}
\right.
\end{array}
\right.
\]</span><br>
En nuestro caso: <span class="math display">\[
F_X(x)=P(X\leq X)=
\left\{\begin{array}{ll}
0, &amp; \mbox{si } x&lt;0,\\
\displaystyle\sum_{i=0}^{k} P(X=i)=\sum_{i=0}^{k}\frac{20^i}{i!}\cdot e^{-20}, &amp; \mbox{si  }
\left\{\begin{array}{l}
k\leq x&lt; k+1,\\k=0,1,2,\ldots
\end{array}
\right.
\end{array}
\right.
\]</span> <strong>Solución 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>Nos piden la probabilidad siguiente: <span class="math display">\[
P(X=21)=\frac{20^{21}}{21!} e^{-20}=0.0846051.
\]</span></p>
<p>Para realizar el cálculo anterior, podemos usar <code>R</code> como calculadora o usar la función <code>dpois</code> que nos calcula la función de distribución de la variable de Poisson:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span><span class="sc">^</span>(<span class="dv">21</span>)<span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">21</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08460506</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">21</span>,<span class="at">lambda =</span> <span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08460506</code></pre>
</div>
</div>
<p><strong>Solución 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>Nos piden la probabilidad siguiente: <span class="math display">\[
\begin{array}{rl}
P(X\geq 6)&amp;=1- P(X&lt;6)=1-P(X\leq 5)=1-F_X(5)=1-\displaystyle\sum_{x=0}^{5} \frac{20^{x}}{x!}\cdot e^{-20}\\
&amp;=
1-\left(\frac{20^{0}}{0!}\cdot e^{-20}+\frac{20^{1}}{1!}\cdot e^{-20}+\frac{20^{2}}{2!}\cdot e^{-20}+\frac{20^{3}}{3!}\cdot e^{-20}+\frac{20^{4}}{4!}\cdot e^{-20}+\frac{20^{5}}{5!}\cdot e^{-20}\right)\\[1ex]
&amp;=
1-e^{-20}\cdot \left(1+20+\frac{400}{4}+\frac{8000}{6}+\frac{160000}{24}+\frac{3200000}{120}\right)\\[1ex]
&amp;=
1-e^{-20} \cdot \left(\frac{1 \cdot 120+20\cdot 120+400\cdot 30+8000\cdot 20+160000\cdot 24+3200000\cdot 1}{120}\right)\\[1ex]
&amp;= 1-e^{-20}\cdot\left(\frac{4186520}{120}\right)=1-7.1908841\times 10^{-5} =0.9999281.
\end{array}
\]</span></p>
<p><strong>Solución 5.</strong> ¿Cuál es el valor esperado, la varianza y la desviación típica de <span class="math inline">\(X\)</span>?</p>
<p>El valor esperado del número de insectos caídos en la trampa en una hora es: <span class="math display">\[E(X)=\lambda=20.\]</span> Su varianza es <span class="math display">\[Var(X)=\lambda=20,\]</span> y su desviación típica vale: <span class="math display">\[\sqrt{Var(X)}=+\sqrt{\lambda}=+\sqrt{20}=4.47214.\]</span></p>
</div>
</div>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Consideremos por ejemplo una v.a. <span class="math inline">\(X\)</span> con distribución <span class="math inline">\(Po(\lambda=3)\)</span>. Calculemos <span class="math inline">\(P_X(0)=P(X=0), P_X(1)=P(X=1)\)</span> con <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">0</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04978707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">1</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1493612</code></pre>
</div>
</div>
<p>Si quisiéramos hallar la función de distribución en los mismos valores anteriores, <span class="math inline">\(F_X(0)=P(X\leq 0), F_X(1)=P(X\leq 1)\)</span>, haríamos lo siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">0</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04978707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">1</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1991483</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">0</span>,<span class="at">lambda =</span> <span class="dv">3</span>)<span class="sc">+</span><span class="fu">dpois</span>(<span class="dv">1</span>,<span class="at">lambda =</span> <span class="dv">3</span>) <span class="co"># es igual a ppois(1,lambda=3)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1991483</code></pre>
</div>
</div>
<p>A continuación, comprobemos que <span class="math inline">\(F_X(10)=\sum\limits_{x=0}^{10} P_X(x)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.0497870684 0.1493612051 0.2240418077 0.2240418077 0.1680313557
 [6] 0.1008188134 0.0504094067 0.0216040315 0.0081015118 0.0027005039
[11] 0.0008101512</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9997077</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">10</span>,<span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9997077</code></pre>
</div>
</div>
<p>Si quisiéramos generar una secuencia de <span class="math inline">\(100\)</span> observaciones para una distribución de Poisson de parámetro <span class="math inline">\(\lambda=3\)</span>, <span class="math inline">\(Po(3)\)</span>, tendríamos que hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpois</span>(<span class="at">n=</span><span class="dv">100</span>,<span class="at">lambda =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 2 5 3 3 2 2 5 2 4 4 2 3 2 2 2 2 2 3 3 5 3 3 2 4 2 3 2 1 1 3 4 6 2 5 3 4 1
 [38] 1 6 3 4 1 4 3 4 3 0 2 1 4 3 0 2 4 2 3 5 2 1 3 3 4 2 5 0 3 1 1 4 6 4 5 0 4
 [75] 0 3 3 3 4 1 2 6 2 2 2 2 1 2 5 2 5 3 7 3 5 2 3 2 1 3</code></pre>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio de la trampa para insectos (continuación)</strong></p>
<p>En el ejercicio de la trampa para insectos teníamos que <span class="math inline">\(X\)</span> es una <span class="math inline">\(Po(20)\)</span>. Responded con <code>R</code> a la preguntas 3 y 4 de este ejercicio</p>
<div class="example-sol">
<p><strong>Pregunta 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>Recordemos que la probabilidad pedida es <span class="math inline">\(P(X=21)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">21</span>,<span class="at">lambda=</span><span class="dv">20</span>) <span class="co"># P(X=21)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08460506</code></pre>
</div>
</div>
<p><strong>Pregunta 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>Recordemos que la probabilidad pedida es <span class="math inline">\(P(X\geq 6)=1-P(X&lt;6)=1-P(X\leq 5)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">5</span>,<span class="at">lambda=</span><span class="dv">20</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.190884e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">ppois</span>(<span class="dv">5</span>,<span class="at">lambda=</span><span class="dv">20</span>) <span class="co"># es 1-P(X&lt;=5)=P(X&gt;=6)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9999281</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># acumula hacia arriba P(X&gt;5)=P(X&gt;=6)=P(X=6)+P(X=7)+..</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">5</span>,<span class="at">lambda=</span><span class="dv">20</span>,<span class="at">lower.tail =</span><span class="cn">FALSE</span> ) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9999281</code></pre>
</div>
</div>
</div>
</div>
<p><strong>Gráficos de la distribución Poisson con <code>R</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">qpois</span>(<span class="fl">0.99</span>,<span class="at">lambda=</span>lambda)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">lambda=</span>lambda)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>ymax<span class="ot">=</span><span class="fu">max</span>(<span class="fu">ppois</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">lambda=</span>lambda))</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">lambda=</span>lambda),</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,ymax),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st">  Po(lambda="</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux,<span class="at">pch=</span><span class="dv">21</span>, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">ppois</span>(x,<span class="at">lambda=</span>lambda),</span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución </span><span class="sc">\n</span><span class="st"> Po(lambda="</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/graficosPOISON-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Gráficos interactivos con <code>R</code></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sliderInput</span>(<span class="st">"lambda"</span>, <span class="at">label =</span> <span class="st">"Promedio de eventos lambda"</span>,</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">100</span>, <span class="at">value =</span><span class="dv">20</span> , <span class="at">step =</span> <span class="dv">1</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span>input<span class="sc">$</span>lambda</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">qpois</span>(<span class="fl">0.99</span>,<span class="at">lambda=</span>lambda)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">lambda=</span>lambda)</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>  ymax<span class="ot">=</span><span class="fl">0.45</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">lambda=</span>lambda),</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,ymax),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st">  Po(lambda="</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux,<span class="at">pch=</span><span class="dv">21</span>, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">ppois</span>(x,<span class="at">lambda=</span>lambda),</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución </span><span class="sc">\n</span><span class="st"> Po(lambda="</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_Poisson2.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Cálculos con <code>Python</code></strong></p>
<p>Realicemos los mismos cálculos realizados con <code>R</code> pero ahora usando <code>Python</code>. Recordemos que considerábamos una v.a. <span class="math inline">\(X\)</span> con distribución <span class="math inline">\(Po(\lambda=3)\)</span>. Calculemos <span class="math inline">\(P_X(0)=P(X=0), P_X(1)=P(X=1)\)</span> con <code>Python</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> poisson</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.049787068367863944</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="dv">1</span>,mu <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.14936120510359185</code></pre>
</div>
</div>
<p>Si quisiéramos hallar las funciones de distribución en los mismos valores anteriores, <span class="math inline">\(F_X(0)=P(X\leq 0), F_X(1)=P(X\leq 1)\)</span>, tendríamos que hacer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>poisson.cdf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.04978706836786395</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>poisson.cdf(<span class="dv">1</span>,mu <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1991482734714558</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="dv">0</span>,mu <span class="op">=</span> <span class="dv">3</span>)<span class="op">+</span>poisson.pmf(<span class="dv">1</span>,mu<span class="op">=</span> <span class="dv">3</span>) <span class="co"># es igual a poisson.cdf(1,lambda=3)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1991482734714558</code></pre>
</div>
</div>
<p>La comprobación de que <span class="math inline">\(F_X(10)=\displaystyle\sum_{0}^{10} P_X(x)\)</span> en <code>Python</code> se realiza de la forma siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>range(0, 10)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>),mu<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0.04978707, 0.14936121, 0.22404181, 0.22404181, 0.16803136,
       0.10081881, 0.05040941, 0.02160403, 0.00810151, 0.0027005 ])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(poisson.pmf(<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>),mu<span class="op">=</span><span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9988975118698846</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>poisson.cdf(<span class="dv">10</span>,mu<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9997076630493527</code></pre>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio de la trampa para insectos (continuación)</strong></p>
<p>En el ejercicio de la trampa para insectos teníamos que <span class="math inline">\(X\)</span> es una <span class="math inline">\(Po(20)\)</span>. Responded con <code>Python</code> a la preguntas 3 y 4 de este ejercicio</p>
<div class="example-sol">
<p><strong>Pregunta 3.</strong> Calculad la probabilidad de que en una hora caigan en la trampa exactamente 21 insectos.</p>
<p>Recordemos que la probabilidad pedida es <span class="math inline">\(P(X=21)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>poisson.pmf(<span class="dv">21</span>,mu<span class="op">=</span><span class="dv">20</span>) <span class="co"># P(X=21)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.08460506418293791</code></pre>
</div>
</div>
<p><strong>Pregunta 4.</strong> Calculad la probabilidad de que en una hora caigan en la trampa al menos 6 insectos.</p>
<p>La probabilidad pedida es <span class="math inline">\(P(X\geq 6)=1-P(X\leq 5)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>poisson.cdf(<span class="dv">5</span>,mu<span class="op">=</span><span class="dv">20</span>)  <span class="co"># es 1-P(X&lt;=5)=P(X&gt;=6)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.9999280911594716</code></pre>
</div>
</div>
<p>Como ya hemos visto con <code>scipy.stats</code>, podemos pedir los momentos de una variable aleatoria <span class="math inline">\(Po(3)\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>poisson.stats(mu<span class="op">=</span><span class="dv">3</span>, moments<span class="op">=</span><span class="st">'mv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(3.0, 3.0)</code></pre>
</div>
</div>
<p>Y también generar secuencias de observaciones aleatorias de una población <span class="math inline">\(Po(3)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>poisson.rvs(mu<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">40</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([4, 5, 4, 4, 2, 5, 3, 1, 2, 5, 1, 2, 4, 2, 1, 6, 4, 4, 3, 1, 3, 2,
       5, 6, 2, 4, 2, 5, 6, 6, 4, 5, 2, 1, 5, 6, 2, 4, 3, 2], dtype=int64)</code></pre>
</div>
</div>
</div>
</div>
<p><strong>Gráficos con <code>Python</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> poisson</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">10</span> <span class="co">## mu = lambda</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(poisson.ppf(<span class="fl">0.01</span>, mu),poisson.ppf(<span class="fl">0.99</span>, mu))</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>ax.plot(x, poisson.pmf(x, mu), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'Poisson pmf'</span>)</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, poisson.pmf(x, mu), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>ax.plot(x, poisson.cdf(x, mu), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'Poisson cdf'</span>)</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>ax.vlines(x, <span class="dv">0</span>, poisson.cdf(x, mu), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>  tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Distribucion de Poisson'</span>)</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="3_files/figure-html/py_poiss2-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p><strong>Gráficos interactivos para un proceso de Poisson <span class="math inline">\(Po(\lambda\cdot t\)</span>)</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fluidRow</span>(</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">column</span>(<span class="dv">6</span>,</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">sliderInput</span>(<span class="st">"lambdapp"</span>, <span class="at">label=</span><span class="st">"Promedio eventos por unidad de tiempo"</span>, </span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">min =</span> <span class="fl">0.1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span><span class="dv">10</span> , <span class="at">step =</span> <span class="fl">0.01</span>)),</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column</span>(<span class="dv">6</span>,<span class="fu">sliderInput</span>(<span class="st">"t"</span>, <span class="at">label =</span> <span class="st">"Intervalo de tiempo (0,t]"</span>, </span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">120</span>, <span class="at">value =</span><span class="dv">1</span> , <span class="at">step =</span> <span class="fl">0.5</span>))</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>  lambda1<span class="ot">=</span>input<span class="sc">$</span>lambdapp</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">=</span>input<span class="sc">$</span>t</span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span>lambda1<span class="sc">*</span>t <span class="do">## es lambda* t</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">qpois</span>(<span class="fl">0.99</span>,<span class="at">lambda=</span>lambda)</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n</span></span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span>,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">lambda=</span>lambda)</span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>  ymax<span class="ot">=</span><span class="fu">ppois</span>(<span class="fu">which.max</span>(<span class="fu">ppois</span>(<span class="dv">0</span><span class="sc">:</span>n,lambda))<span class="sc">-</span><span class="dv">1</span>,lambda)<span class="sc">*</span><span class="fl">0.7</span></span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">y=</span><span class="fu">dpois</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>n),<span class="at">lambda=</span>lambda),</span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,ymax),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st">  Po(lambda="</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux,<span class="at">pch=</span><span class="dv">21</span>, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">ppois</span>(x,<span class="at">lambda=</span>lambda),</span>
<span id="cb191-28"><a href="#cb191-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,n<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb191-29"><a href="#cb191-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">"Función de distribución </span><span class="sc">\n</span><span class="st"> Po(lambda="</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb191-30"><a href="#cb191-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb191-31"><a href="#cb191-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb191-32"><a href="#cb191-32" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--![[](Images/noshinyImages/interactivos_proceso_Poisson1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<div class="example">
<p><strong>Ejemplo: Número de impactos de insectos en la visera de un casco</strong></p>
<p>Un colega de trabajo, al que llamaremos JG, es muy aficionado a los grandes premios de velocidad tanto en coches como en motos.</p>
<p>Como es tan aficionado, está obsesionado con muchas de las más extravagantes estadísticas de estos deportes. En particular le propusimos que estudiara el número de insectos que chocan contra la visera de un casco de un motorista GP o de un conductor de fórmula 1 .</p>
<p>La idea es que el número de insectos está igualmente repartido por todo el circuito y de promedio impactan <span class="math inline">\(\lambda&gt;0\)</span> insectos por minuto. También es razonable suponer que:</p>
<ul>
<li>podemos dividir la superficie de la visera en cuadrados suficientemente pequeños de forma que la probabilidad de que caigan dos insectos en la misma zona es prácticamente 0.</li>
<li>la probabilidad de que un insecto impacte en un cuadrado cualquiera de la visera es independiente de cualquier otro cuadrado.</li>
<li>si hemos dividido la visera en <span class="math inline">\(n\)</span> cuadrados la probabilidad <span class="math inline">\(p_n\)</span> de impacto de un cuadrado vale <span class="math inline">\(p_n=\frac{\lambda}{n}\)</span>.</li>
</ul>
<p>Bajo estas condiciones, si denotamos por <span class="math inline">\(X_t\)</span> como el número de insectos que ha impactado en la visera en el intervalo <span class="math inline">\((0,t]\)</span> (en <span class="math inline">\(t\)</span> minutos), podemos afirmar que <span class="math inline">\(X_t\)</span> es un proceso de Poisson <span class="math inline">\(Po(\lambda\cdot t)\)</span>.</p>
<p>Supongamos que nos dicen que <span class="math inline">\(\lambda=3\)</span> insectos por minuto. Entonces el proceso de Poisson <span class="math inline">\(X_t\)</span> seguirá un ley <span class="math inline">\(Po(3\cdot t).\)</span></p>
<p>Nos piden las probabilidades siguientes:</p>
<ol type="1">
<li>¿Cuál es la probabilidad de que en 10 minutos impacten más de 25 insectos?</li>
<li>¿Cuál es la probabilidad de que tengamos que esperar más de 2 minutos para observar el primer impacto?</li>
</ol>
<div class="exercise-sol">
<p><strong>Solución de 1. ¿Cuál es la probabilidad de que en 10 minutos impacten más de 25 insectos?</strong></p>
<p>En este caso <span class="math inline">\(t=10\)</span> y <span class="math inline">\(X_{10}\)</span> es la variable aleatoria que nos da el número de insectos que impactan en 10 minutos o durante el intervalo <span class="math inline">\([0,10)\)</span>. La distribución de <span class="math inline">\(X_{10}\)</span> será de Poisson de parámetro <span class="math inline">\(\lambda=3\cdot 10=30)\)</span>, <span class="math inline">\(Po(30)\)</span>.</p>
<p>Nos piden la probabilidad siguiente: <span class="math inline">\(P(X&gt;25)=1-P(X\leq 25)\)</span>, que calculamos con ayuda de <code>R</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">ppois</span>(<span class="dv">25</span>,<span class="at">lambda=</span><span class="dv">30</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7916426</code></pre>
</div>
</div>
<p><strong>Solución de 2. ¿Cuál es la probabilidad de que tengamos que esperar más de 2 minutos para observar el primer impacto?</strong></p>
<p>Nos piden la probabilidad siguiente <span class="math inline">\(P(X_2=0)\)</span> ya que la variable <span class="math inline">\(X_2\)</span> nos dice el número de impactos en dos minutos. La distribución de <span class="math inline">\(X_2\)</span> será de Poisson de parámetro <span class="math inline">\(\lambda =2\cdot 3=6\)</span>, <span class="math inline">\(Po(6)\)</span>. Si hemos de esperar más de dos minutos para el primer impacto, significa que <span class="math inline">\(X_2=0\)</span>: <span class="math display">\[P(X_2=0)=\frac{(6)^0}{0!}\cdot e^{-6}= e^{-6}=0.002479.\]</span> Si usamos <code>R</code>, obtenemos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="sc">^</span><span class="dv">0</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">0</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">6</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002478752</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">0</span>,<span class="at">lambda=</span><span class="dv">3</span><span class="sc">*</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002478752</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="distribución-hipergeométrica" class="level3" data-number="4.1.6">
<h3 data-number="4.1.6" data-anchor-id="distribución-hipergeométrica"><span class="header-section-number">4.1.6</span> Distribución hipergeométrica</h3>
<p>Supongamos que disponemos de una urna de sorteos que contiene <span class="math inline">\(m\)</span> bolas blancas y <span class="math inline">\(n\)</span> bolas rojas.</p>
<p>En total en esta urna hay <span class="math inline">\(m+n\)</span> bolas, <span class="math inline">\(m\)</span> blancas y <span class="math inline">\(n\)</span> rojas. Si extraemos dos bolas de la urna lo podemos hacer de dos formas:</p>
<ul>
<li>Extraer una, anotar su color y reponerla. Sacar otra y anotar su color. Hemos extraído la bola con reposición.</li>
<li>Extraer simultáneamente dos bolas (sin reposición) y contar el número de bolas blancas.</li>
</ul>
<p>Sea <span class="math inline">\(X\)</span> es la v.a. que cuenta el número de bolas blancas extraídas.</p>
<ul>
<li>En el primer caso, <span class="math inline">\(X\)</span> es una <span class="math inline">\(B(n=2,p=\frac{m}{m+n})\)</span> ya que consiste en repetir dos veces el mismo experimento de Bernoulli.</li>
<li>En el segundo caso, <span class="math inline">\(X\)</span> sigue una distribución hipergeométrica que estudiaremos en esta sección.</li>
</ul>
<p><l class="definition"> <strong>Distribución hipergeométrica</strong> </l></p>
<p>Sean <span class="math inline">\(n\)</span>, <span class="math inline">\(m\)</span> y <span class="math inline">\(k\)</span> tres número enteros positivos y tales que <span class="math inline">\(k&lt;m+n\)</span>.</p>
<p>Consideremos una urna que contiene <span class="math inline">\(m+n\)</span> bolas de las que <span class="math inline">\(m\)</span> son blancas y las restantes <span class="math inline">\(n\)</span> no (son no blancas).</p>
<p>El número total de bolas es <span class="math inline">\(m+n\)</span>. Extraemos de forma aleatoria <span class="math inline">\(k\)</span> bolas de la urna sin reemplazarlas.</p>
<p>Sea <span class="math inline">\(X\)</span> la v.a. que cuenta el número de bolas blancas extraídas. Diremos que la distribución de <span class="math inline">\(X\)</span> es hipergeométrica de parámetros <span class="math inline">\(m\)</span>, <span class="math inline">\(n\)</span> y <span class="math inline">\(k\)</span> y la denotaremos por <span class="math inline">\(H(m,n,k)\)</span>.</p>
<p>Su dominio es</p>
<p><span class="math display">\[D_X=\left\{x\in\mathbb{N}\mid \max\{0,k-n\}\leq  x \leq \min\{m,k\}\right\}\]</span></p>
<p>Para explicarlo, veamos varios ejemplos:</p>
<ul>
<li><span class="math inline">\(H(m=5,n=2,k=3)\)</span>. Tenemos <span class="math inline">\(m=5\)</span> bolas blancas, <span class="math inline">\(n=2\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso el mínimo de bolas blancas extraídas es <span class="math inline">\(1=k-n=3-2\)</span>, ya que sólo hay dos no blancas.</li>
<li>En cambio, el máximo sí es <span class="math inline">\(k=3\)</span>, ya que tenemos bolas blancas de “sobra”.</li>
</ul></li>
<li><span class="math inline">\(H(m=2,n=5,k=3)\)</span>. Tenemos <span class="math inline">\(m=2\)</span> bolas blancas, <span class="math inline">\(n=5\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso el mínimo de bolas blancas es <span class="math inline">\(0\)</span> ya que puedo sacar 3 no blancas.</li>
<li>En cambio, el máximo sí es <span class="math inline">\(m=2\)</span>, ya que aunque saquemos <span class="math inline">\(k=3\)</span> bolas, al llegar a 2 ya hemos extraído todas las bolas blancas de la urna.</li>
</ul></li>
<li><span class="math inline">\(H(m=10,n=10,k=3)\)</span>. Tenemos <span class="math inline">\(m=10\)</span> bolas blancas, <span class="math inline">\(n=10\)</span> no blancas y sacamos <span class="math inline">\(k=3\)</span> bolas sin reposición.
<ul>
<li>En este caso podemos obtener desde <span class="math inline">\(0\)</span> blancas hasta <span class="math inline">\(k=3\)</span> blancas.</li>
</ul></li>
</ul>
<p>Su función de probabilidad es: <span class="math display">\[
P_{X}(x)=\left\{
\begin{array}{ll}
\frac{\binom{m}{x}\cdot \binom{n}{k-x}}{\binom{m+n}{k}}, &amp; \mbox{ si }
\max\{0,k-n\}\leq x \leq \min\{m,k\}, \mbox { para  } x\in \mathbb{N},\\
0,  &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p><l class="observ"> <strong>Observación: otras parametrizaciones</strong> </l></p>
<p>En ocasiones se parametriza una v.a. hipergeométrica mediante <span class="math inline">\(N=m+n\)</span>, número total de bolas, <span class="math inline">\(k\)</span>, número de extracciones y <span class="math inline">\(p\)</span>, probabilidad de extraer una bola blanca.</p>
<p>Así, podemos <strong>parametrizar alternativamente</strong> la distribución hipergeométrica como <span class="math inline">\(H(N,k,p)\)</span> donde <span class="math inline">\(p=\frac{m}{N}.\)</span></p>
<p><strong>Resumen hipergeométrica <span class="math inline">\(H(m,n,k)\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X=H(m,n,k)\)</span></th>
<th style="text-align: left;">Número de bolas blancas en <span class="math inline">\(k\)</span> extracciones sin reposición de una urna con <span class="math inline">\(m\)</span> bolas blancas y <span class="math inline">\(n\)</span> no blancas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X\)</span>=</td>
<td style="text-align: left;"><span class="math inline">\(\left\{x\in\mathbb{N}\mid \max\{0,k-n\}\leq x \leq \min\{m,k\}\right\}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(P_X(x)=P(X=x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{ \begin{array}{ll} \frac{\binom{m}{x}\cdot \binom{n}{k-x}}{\binom{m+n}{k}}, &amp; \mbox{si } x\in[\max\{0,k-n\},\min\{m,k\}] \\ 0, &amp; \mbox{en otro caso.}\end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq x)\)</span></td>
<td style="text-align: left;">Hay que sumarla. Utilizad funciones de <code>R</code> o de <code>Python</code>.</td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=\frac{k\cdot m}{m+n}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=k\cdot\frac{m}{m+n}\cdot\left(1-\frac{m}{m+n}\right) \cdot\frac{m+n-k}{m+n-1}\)</span></td>
</tr>
</tbody>
</table>
<div class="example">
<p><strong>Ejemplo: urna con <span class="math inline">\(m=15\)</span> blancas, <span class="math inline">\(n=10\)</span> rojas y <span class="math inline">\(k=3\)</span> extracciones sin reposición</strong></p>
<p>Tenemos una urna con 15 bolas blancas y 10 bolas rojas. Extraemos al azar tres bolas de la urna sin reposición. Sea <span class="math inline">\(X\)</span> el número de bolas <strong>blancas</strong> extraídas. Bajo estas condiciones, la v.a. <span class="math inline">\(X\)</span> sigue una ley de distribución <span class="math inline">\(H(m=15,n=10,k=3)\)</span>.</p>
<p>Nos piden:</p>
<ol type="1">
<li>Hallar la función de probabilidad de <span class="math inline">\(X\)</span>.</li>
<li>Probabilidad de sacar dos bolas blancas.</li>
<li>Probabilidad de sacar más de una bola blanca.</li>
<li>Esperanza, varianza y desviación típica de <span class="math inline">\(X\)</span>.</li>
</ol>
<div class="example-sol">
<p><strong>Solución de 1. Hallar la función de probabilidad de <span class="math inline">\(X\)</span></strong></p>
<p>La función de probabilidad de <span class="math inline">\(X\)</span> es: <span class="math display">\[
P_X(x)=P(X=x)=\left\{
\begin{array}{ll}
\frac{\binom{m}{x}\cdot \binom{n}{k-x}}{\binom{m+n}{k}}, &amp; \mbox{ si }
\max\{0,k-n\}\leq x \leq \min\{m,k\}, \mbox { para  } x\in \mathbb{N},\\
0,  &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p>Sustituyendo los parámetros <span class="math inline">\(m,n\)</span> y <span class="math inline">\(k\)</span> por <span class="math inline">\(m=15\)</span>, <span class="math inline">\(n=10\)</span> y <span class="math inline">\(k=3\)</span>, obtenemos:</p>
<p><span class="math display">\[
P_X(x)=P(X=x)=\left\{
\begin{array}{ll}
\frac{\binom{15}{x}\cdot \binom{10}{3-x}}{\binom{25}{3}}= \frac{\binom{15}{x}\cdot \binom{10}{3-x}}{2300}, &amp; \mbox{ si }
0\leq x \leq 3, \mbox { para  } x\in \mathbb{N},\\
0,  &amp; \mbox{en otro caso.}\end{array}\right.
\]</span></p>
<p><strong>Solución de 2. Probabilidad de sacar dos bolas blancas</strong></p>
<p>La probabilidad de sacar 2 blancas será: <span class="math display">\[
P(X=2)=\frac{\binom{15}{2}\cdot \binom{10}{3-2}}{\binom{25}{3}}
\]</span></p>
<p>Si calculamos con ayuda de <code>R</code> los números binomiales involucrados en la expresión anterior, obtenemos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">choose</span>(<span class="dv">15</span>,<span class="dv">2</span>), <span class="fu">choose</span>(<span class="dv">10</span>,<span class="dv">1</span>), <span class="fu">choose</span>(<span class="dv">25</span>,<span class="dv">3</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  105   10 2300</code></pre>
</div>
</div>
<p>La probabilidad pedida, será, pues: <span class="math inline">\(P(X=2)=\frac{105\cdot10 }{2300}=0.4565217.\)</span></p>
<p><strong>Solución de 3. Probabilidad de sacar más de una bola blanca</strong></p>
<p>La probabilidad de que saquemos más de 1 bola blanca es: <span class="math display">\[
\begin{array}{rl}
P(X&gt; 1)&amp;= 1-P(X\leq 1)=1-(P(X=0)+P(X=1))\\
&amp;=
1-\left(\frac{\binom{15}{0}\cdot \binom{10}{3}}{\binom{25}{3}}+
\frac{\binom{15}{1}\cdot \binom{10}{2}}{\binom{25}{3}}\right)\\
&amp;=
1-\left(
\frac{1\cdot120 }{2300}+\frac{15\cdot45 }{2300}
\right)=1-\frac{120+15\cdot 45}{2300}=0.6543478.
\end{array}
\]</span></p>
<p><strong>Solución de 4. Esperanza, varianza y desviación típica de <span class="math inline">\(X\)</span></strong></p>
<p>El número esperado de bolas blancas extraídas para una v.a. <span class="math inline">\(X\)</span> de distribución <span class="math inline">\(H(m=15,n=10,k=3)\)</span> es:</p>
<p><span class="math display">\[E(X)=\frac{k\cdot m}{m+n}=\frac{3\cdot 15}{15+10}=\frac{45}{35}=1.285714.\]</span> La varianza vale: <span class="math display">\[
\begin{array}{rl}
Var(X)&amp;=k\cdot\frac{m}{m+n}\cdot\left(1-\frac{m}{m+n}\right) \cdot\frac{m+n-k}{m+n-1}\\
&amp;=3\cdot\frac{15}{15+10}\cdot\left(1-\frac{15}{15+10}\right) \cdot\frac{15+10-3}{15+10-1}\\
&amp;=
3\cdot\frac{15}{25}\cdot\left(1-\frac{15}{25}\right) \cdot\frac{22}{24}=
3\cdot\frac{15}{25}\cdot\frac{25-15}{25} \cdot\frac{22}{24}\\
&amp;=
3\cdot\frac{15}{25}\cdot\frac{10}{25}\cdot\frac{22}{24}=0.66.
\end{array}
\]</span></p>
<p>Y por lo tanto, su desviación típica es:</p>
<p><span class="math display">\[
+\sqrt{Var(X)}=+\sqrt{0.66}=0.812404.
\]</span></p>
</div>
</div>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Sea <span class="math inline">\(X\)</span> una v.a. <span class="math inline">\(H(m,n,k)\)</span>. La función de <code>R</code> para calcular la función de probabilidad en un valor <span class="math inline">\(x\)</span>, <span class="math inline">\(P(X=x)\)</span>, es <code>dhyper(x,m,n,k)</code> y para calcular la función de distribución en un valor <span class="math inline">\(q\)</span>, <span class="math inline">\(P(X\leq q)\)</span>, es <code>phyper(q,m,n,k)</code>. Para generar una muestra de valores que siga la distribución <span class="math inline">\(H(m,n,k)\)</span>, hay que usar la función <code>rhyper(nn,m,n,k)</code> donde <code>nn</code> es el número de observaciones aleatorias deseado de la muestra.</p>
<p>Por ejemplo, si <span class="math inline">\(X\)</span> es una <span class="math inline">\(H(m=15,n=10,k=3)\)</span>, los valores de <span class="math inline">\(P(X=2)\)</span> y que <span class="math inline">\(P(X&gt;1)=1-P(X\leq 1)\)</span> son:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dhyper</span>(<span class="at">x=</span><span class="dv">2</span>,<span class="at">m=</span><span class="dv">15</span>,<span class="dv">10</span>,<span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4565217</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">phyper</span>(<span class="at">q=</span><span class="dv">1</span>,<span class="at">m=</span><span class="dv">15</span>,<span class="at">n=</span><span class="dv">10</span>,<span class="at">k=</span><span class="dv">3</span>)<span class="do">## sí, le han puesto q ya veremos el porqué</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3456522</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">phyper</span>(<span class="at">q=</span><span class="dv">1</span>,<span class="at">m=</span><span class="dv">15</span>,<span class="at">n=</span><span class="dv">10</span>,<span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6543478</code></pre>
</div>
</div>
<p>Una muestra aleatoria de este experimento de tamaño 200 sería:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rhyper</span>(<span class="at">nn=</span><span class="dv">200</span>,<span class="at">m=</span><span class="dv">15</span>,<span class="at">n=</span><span class="dv">10</span>,<span class="at">k=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 2 3 1 3 1 2 2 3 2 2 1 2 1 2 2 3 3 1 1 1 1 0 2 3 2 1 3 2 2 2 2 3 2 3 3 2 0
 [38] 1 2 1 3 2 2 3 2 3 2 2 3 2 3 1 2 2 2 2 3 2 2 1 3 2 2 3 1 2 2 2 2 2 3 0 2 0
 [75] 3 2 2 2 1 2 2 3 1 1 1 2 2 2 2 1 1 3 2 2 3 2 2 1 1 1 3 3 2 2 2 1 3 2 2 2 1
[112] 1 2 3 2 2 1 2 2 2 2 2 2 3 1 2 3 3 1 1 2 2 1 1 3 2 1 1 2 2 3 1 1 1 2 1 1 3
[149] 1 2 2 3 3 2 3 1 2 1 2 2 2 1 2 3 1 3 3 3 2 2 1 3 3 1 1 2 2 2 2 2 3 2 1 2 1
[186] 1 1 1 2 1 1 2 2 2 2 3 3 1 0 2</code></pre>
</div>
</div>
<p><strong>Gráficas con <code>R</code></strong></p>
<p>Los gráficos de la función de probabilidad y de la función de distribución en <code>R</code> se realizan de la forma siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">15</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">0</span>,k<span class="sc">-</span>n))</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(m,k))</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>l<span class="ot">=</span>b<span class="sc">-</span>a<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>l)</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>aux[<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="sc">*</span>l,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dhyper</span>(<span class="fu">c</span>(a<span class="sc">:</span>b),<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k)</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>a<span class="sc">:</span>b</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">y=</span><span class="fu">dhyper</span>(x,<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k),</span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="at">xlim=</span><span class="fu">c</span>(a<span class="dv">-1</span>,b<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> H(m="</span>,m,<span class="st">", n="</span>,n,<span class="st">", k="</span>,k,<span class="st">")"</span>))</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(a<span class="sc">:</span>b,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">phyper</span>(x,<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k),</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(a<span class="dv">-1</span>,b<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> H(m="</span>,m,<span class="st">", n="</span>,n,<span class="st">", k="</span>,k,<span class="st">")"</span>))</span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Gráficos interactivos <span class="math inline">\(H(m,n,k)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"mh"</span>, <span class="at">label =</span> <span class="st">"Número de bolas blancas m"</span>,</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span><span class="dv">15</span>, <span class="at">step =</span> <span class="dv">1</span>)),</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"nh"</span>, <span class="at">label =</span> <span class="st">"Número de bolas rojas n"</span>,</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span><span class="dv">10</span> , <span class="at">step =</span> <span class="dv">1</span>)),</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"kh"</span>, <span class="at">label =</span> <span class="st">"Número bolas extraídas k"</span>,</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max=</span><span class="dv">25</span>, <span class="at">value =</span> <span class="dv">3</span>, <span class="at">step =</span> <span class="dv">1</span>)</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span>input<span class="sc">$</span>mh</span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>input<span class="sc">$</span>nh</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span>input<span class="sc">$</span>kh</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n=10</span></span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#k=3</span></span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#m=15</span></span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">0</span>,k<span class="sc">-</span>n))</span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(m,k))</span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>  l<span class="ot">=</span>b<span class="sc">-</span>a<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">times=</span><span class="dv">2</span><span class="sc">*</span>l)</span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="sc">*</span>l,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dhyper</span>(<span class="fu">c</span>(a<span class="sc">:</span>b),<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k)</span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>a<span class="sc">:</span>b</span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x,<span class="at">y=</span><span class="fu">dhyper</span>(x,<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k),</span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="at">xlim=</span><span class="fu">c</span>(a<span class="dv">-1</span>,b<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb209-32"><a href="#cb209-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función de probabilidad</span><span class="sc">\n</span><span class="st"> H(m="</span>,m,<span class="st">", n="</span>,n,<span class="st">", k="</span>,k,<span class="st">")"</span>))</span>
<span id="cb209-33"><a href="#cb209-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(a<span class="sc">:</span>b,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb209-34"><a href="#cb209-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">phyper</span>(x,<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k),</span>
<span id="cb209-35"><a href="#cb209-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(a<span class="dv">-1</span>,b<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb209-36"><a href="#cb209-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función de distribución</span><span class="sc">\n</span><span class="st"> H(m="</span>,m,<span class="st">", n="</span>,n,<span class="st">", k="</span>,k,<span class="st">")"</span>))</span>
<span id="cb209-37"><a href="#cb209-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb209-38"><a href="#cb209-38" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactivos_hiper_geom1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Comparación <span class="math inline">\(H(m,n,k)\)</span> y <span class="math inline">\(B\left(k,\frac{m}{n+m}\right)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"mh2"</span>, <span class="at">label =</span> <span class="st">"Número de bolas blancas m"</span>,</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span><span class="dv">15</span>, <span class="at">step =</span> <span class="dv">1</span>)),</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"nh2"</span>, <span class="at">label =</span> <span class="st">"Número de bolas rojas n"</span>,</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">50</span>, <span class="at">value =</span><span class="dv">10</span> , <span class="at">step =</span> <span class="dv">1</span>)),</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"kh2"</span>, <span class="at">label =</span> <span class="st">"Número bolas extraídas k"</span>,</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max=</span><span class="dv">25</span>, <span class="at">value =</span> <span class="dv">3</span>, <span class="at">step =</span> <span class="dv">1</span>)</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span>input<span class="sc">$</span>mh2</span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>input<span class="sc">$</span>nh2</span>
<span id="cb210-19"><a href="#cb210-19" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">=</span>input<span class="sc">$</span>kh2</span>
<span id="cb210-20"><a href="#cb210-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n=10</span></span>
<span id="cb210-21"><a href="#cb210-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#k=3</span></span>
<span id="cb210-22"><a href="#cb210-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#m=15</span></span>
<span id="cb210-23"><a href="#cb210-23" aria-hidden="true" tabindex="-1"></a>  pr<span class="ot">=</span><span class="fu">round</span>(m<span class="sc">/</span>(n<span class="sc">+</span>m),<span class="dv">4</span>)</span>
<span id="cb210-24"><a href="#cb210-24" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">0</span>,k<span class="sc">-</span>n))</span>
<span id="cb210-25"><a href="#cb210-25" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(m,k))</span>
<span id="cb210-26"><a href="#cb210-26" aria-hidden="true" tabindex="-1"></a>  l<span class="ot">=</span>b<span class="sc">-</span>a<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb210-27"><a href="#cb210-27" aria-hidden="true" tabindex="-1"></a>  aux<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">times=</span><span class="dv">2</span><span class="sc">*</span>l)</span>
<span id="cb210-28"><a href="#cb210-28" aria-hidden="true" tabindex="-1"></a>  auxB<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">times=</span><span class="dv">2</span><span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb210-29"><a href="#cb210-29" aria-hidden="true" tabindex="-1"></a>  aux[<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="sc">*</span>l,<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dhyper</span>(<span class="fu">c</span>(a<span class="sc">:</span>b),<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k)</span>
<span id="cb210-30"><a href="#cb210-30" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>a<span class="sc">:</span>b</span>
<span id="cb210-31"><a href="#cb210-31" aria-hidden="true" tabindex="-1"></a>  auxB[<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">2</span><span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>),<span class="dv">2</span>)]<span class="ot">=</span><span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span>k,k,pr)</span>
<span id="cb210-32"><a href="#cb210-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb210-33"><a href="#cb210-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>k),<span class="at">y=</span><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>k),<span class="at">size=</span>k,<span class="at">prob=</span>pr),</span>
<span id="cb210-34"><a href="#cb210-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,k<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,</span>
<span id="cb210-35"><a href="#cb210-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Funciones de probabilidad</span><span class="sc">\n</span><span class="st"> B(n="</span>,n,<span class="st">"p="</span>,pr,<span class="st">")  </span></span>
<span id="cb210-36"><a href="#cb210-36" aria-hidden="true" tabindex="-1"></a><span class="st">                   H(m="</span>,m,<span class="st">"n="</span>, n,<span class="st">"k="</span>,k,<span class="st">")"</span>))</span>
<span id="cb210-37"><a href="#cb210-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>k,<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux,<span class="at">pch=</span><span class="dv">21</span>, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb210-38"><a href="#cb210-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#aux=rep(0,(n+1)*2)</span></span>
<span id="cb210-39"><a href="#cb210-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">#aux[seq(2,(n+1)*2,2)]=dpois(c(0:n),n*pr)</span></span>
<span id="cb210-40"><a href="#cb210-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x=</span><span class="fu">c</span>(a<span class="sc">:</span>b),<span class="at">y=</span><span class="fu">dhyper</span>(<span class="fu">c</span>(a<span class="sc">:</span>b),<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k),</span>
<span id="cb210-41"><a href="#cb210-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,k<span class="sc">+</span><span class="dv">1</span>),<span class="at">xlab=</span><span class="st">"x"</span>,<span class="at">pch=</span><span class="dv">25</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb210-42"><a href="#cb210-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span>(l<span class="dv">-1</span>),<span class="at">each=</span><span class="dv">2</span>),<span class="at">y=</span>aux, <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">lty =</span> <span class="dv">3</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb210-43"><a href="#cb210-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Binomial"</span>,<span class="st">"Hipergeométrica"</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>),</span>
<span id="cb210-44"><a href="#cb210-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">25</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb210-45"><a href="#cb210-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">pbinom</span>(x,<span class="at">size=</span>k,<span class="at">p=</span>pr),</span>
<span id="cb210-46"><a href="#cb210-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,k<span class="sc">+</span><span class="dv">1</span>), <span class="at">col=</span><span class="st">"blue"</span>, </span>
<span id="cb210-47"><a href="#cb210-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Funciones de distribución</span><span class="sc">\n</span><span class="st"> B("</span>,k,<span class="st">","</span>,pr,<span class="st">") </span></span>
<span id="cb210-48"><a href="#cb210-48" aria-hidden="true" tabindex="-1"></a><span class="st">                     H(m="</span>,m,<span class="st">"n="</span>, n,<span class="st">"k="</span>,k,<span class="st">")"</span>))</span>
<span id="cb210-49"><a href="#cb210-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">phyper</span>(x,<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">k=</span>k),</span>
<span id="cb210-50"><a href="#cb210-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,k<span class="sc">+</span><span class="dv">1</span>),<span class="at">col=</span><span class="st">"red"</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb210-51"><a href="#cb210-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">#if(all(c(n&gt;=20,n*pr&lt;10,pr&lt;= 0.05))){aux_l="Condición VERDADERA"} </span></span>
<span id="cb210-52"><a href="#cb210-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {aux_l<span class="ot">=</span><span class="st">"Condición FALSA"</span>}</span>
<span id="cb210-53"><a href="#cb210-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#legend("topleft",legend=c(aux_l,paste0("n=",n),paste0("n*p=",n*pr),</span></span>
<span id="cb210-54"><a href="#cb210-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"p="</span>,pr)<span class="er">)</span>,bg<span class="ot">=</span><span class="st">"transparent"</span>,cex<span class="ot">=</span><span class="fl">0.5</span><span class="er">)</span></span>
<span id="cb210-55"><a href="#cb210-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb210-56"><a href="#cb210-56" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactivos_hipergeom_binom1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Cálculos con <code>Python</code></strong></p>
<p>Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(H(m,n,k)\)</span>. Las funciones de <code>scipy.stats</code> cambian los parámetros de la forma siguiente:</p>
<ul>
<li><span class="math inline">\(M\)</span> es el número total de bolas. Con nuestra parametrización <span class="math inline">\(M=m+n\)</span>.</li>
<li><span class="math inline">\(n\)</span> es el número de bolas blancas. Con nuestra parametrización <span class="math inline">\(n=m\)</span>.</li>
<li><span class="math inline">\(N\)</span> es el número de extracciones. Con nuestra parametrización <span class="math inline">\(N=k\)</span>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> hypergeom</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Los cálculos realizados anteriormente en <code>R</code> serían:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>hypergeom.pmf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.2934782608695652</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>hypergeom.cdf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.3456521739130434</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>hypergeom.cdf(<span class="dv">1</span>,M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.6543478260869566</code></pre>
</div>
</div>
<p>Una muestra aleatoria de este experimento sería:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>hypergeom.rvs(M<span class="op">=</span><span class="dv">15</span><span class="op">+</span><span class="dv">10</span>,n<span class="op">=</span><span class="dv">15</span>,N<span class="op">=</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([3, 3, 2, 2, 2, 0, 0, 3, 2, 2, 1, 2, 0, 1, 2, 1, 0, 1, 1, 1, 3, 1,
       3, 2, 1, 1, 1, 1, 1, 1, 2, 3, 3, 2, 1, 1, 3, 2, 1, 1, 1, 0, 2, 2,
       1, 2, 1, 3, 2, 2, 2, 3, 1, 3, 1, 1, 2, 1, 1, 2, 3, 2, 1, 1, 2, 0,
       3, 1, 3, 2, 0, 3, 2, 1, 2, 1, 3, 3, 1, 3, 3, 0, 3, 2, 2, 1, 0, 3,
       1, 1, 3, 1, 2, 3, 0, 2, 2, 3, 2, 1], dtype=int64)</code></pre>
</div>
</div>
<p>Los gráficos de la función de probabilidad y de la función de distribución en python se realizan de la forma siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> hypergeom</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>[M, n, N] <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">7</span>, <span class="dv">12</span>] <span class="co">##20 elementos, 7 del tipo, extraemos 12</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">max</span>(<span class="dv">0</span>, N<span class="op">-</span>M<span class="op">+</span>n),<span class="bu">min</span>(n, N))</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="fl">2.7</span>))</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.plot(x, hypergeom.pmf(x, M, n, N), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'hypergeom pmf'</span>)</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.vlines(x, <span class="dv">0</span>, hypergeom.pmf(x, M, n, N), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.set_ylim([<span class="dv">0</span>, <span class="bu">max</span>(hypergeom.pmf(x, M, n, N))<span class="op">*</span><span class="fl">1.1</span>])</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>) </span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.plot(x, hypergeom.cdf(x, M, n, N), <span class="st">'bo'</span>, ms<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'hypergeom cdf'</span>)</span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>ax.vlines(x, <span class="dv">0</span>, hypergeom.cdf(x, M, n, N), colors<span class="op">=</span><span class="st">'b'</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.xaxis.get_major_ticks():</span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a>   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb220-19"><a href="#cb220-19" aria-hidden="true" tabindex="-1"></a>   <span class="op">=</span>tick.label.set_fontsize(<span class="dv">5</span>)</span>
<span id="cb220-20"><a href="#cb220-20" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>fig.suptitle(<span class="st">'Distribucion Hipergeometrica'</span>)</span>
<span id="cb220-21"><a href="#cb220-21" aria-hidden="true" tabindex="-1"></a> <span class="op">=</span>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="3_files/figure-html/py_hyper2-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>

<section id="cuantiles-de-distribuciones-notables-discretas" class="level2" data-number="4.2">
<h2 data-number="4.2" data-anchor-id="cuantiles-de-distribuciones-notables-discretas"><span class="header-section-number">4.2</span> Cuantiles de distribuciones notables discretas</h2>
<div class="example">
<p><strong>Ejemplo</strong></p>
<p>Consideremos una v.a. <span class="math inline">\(X\)</span> de distribución <span class="math inline">\(B(5,0.5)\)</span>.</p>
<p>Los cuantiles <span class="math inline">\(x_{0.3}\)</span>, <span class="math inline">\(x_{0.6}\)</span> y <span class="math inline">\(x_{0.8}\)</span> son los siguientes:</p>
<div class="cell" data-sixe="small">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>),<span class="dv">5</span>,<span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3 3</code></pre>
</div>
</div>
<p>Calculemos a mano, el valor <span class="math inline">\(x_{0.3}\)</span> y verifiquemos que da el mismo resultado que nos ha dado <code>R</code>.</p>
<p>La función de distribución de <span class="math inline">\(X\)</span> es: <span class="math display">\[
\small{
F_x(x)=P(X\leq x)=
\left\{
\begin{array}{ll}
0, &amp; x&lt; 0, \\
0.03125, &amp; \mbox{ si } 0 \leq x&lt; 1, \\
0.18750, &amp; \mbox{ si } 1 \leq x&lt; 2, \\
0.50000, &amp; \mbox{ si } 2 \leq x&lt; 3, \\
0.81250, &amp; \mbox{ si } 3 \leq x&lt; 4, \\
0.96875, &amp; \mbox{ si } 4 \leq x&lt; 5, \\
1.00000, &amp; \mbox{ si }  5\leq x. \\
\end{array}
\right.}
\]</span></p>
<p>El cuantil <span class="math inline">\(q=0.3\)</span> es el primer valor <span class="math inline">\(x\in D_X\)</span> tal que <span class="math inline">\(F_X(x)=P(X\leq x_{0.3})\geq 0.3\)</span>. Mirando la expresión anterior, comprobamos que <span class="math inline">\(x_{0.3}=2\)</span> ya que <span class="math inline">\(F_X(2)=P(X\leq 2)=0.5 \geq 0.3\)</span>.</p>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Calcular los cuantiles de <span class="math inline">\(0.6\)</span> y <span class="math inline">\(0.8\)</span> de una <span class="math inline">\(B(5,0.5).\)</span></p>
</div>
<p><strong>Gráfico interactivo que muestra los cuantiles de las distribuciones <span class="math inline">\(B(n,p)\)</span> y <span class="math inline">\(Po(\lambda)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">3</span>,</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"nq"</span>, <span class="at">label =</span> <span class="st">"Par. n B(n,p)"</span>,</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">20</span>, <span class="at">value =</span><span class="dv">10</span> , <span class="at">step =</span> <span class="dv">1</span>)</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">3</span>,</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"pq"</span>, <span class="at">label =</span> <span class="st">"Par. p B(n,p)"</span>,</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="fl">0.01</span>, <span class="at">max =</span> <span class="fl">0.99</span>, <span class="at">value =</span> <span class="fl">0.5</span>, <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">3</span>,</span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"qq"</span>, <span class="at">label=</span><span class="st">" Cuantil q"</span>, <span class="at">value=</span><span class="fl">0.75</span>, <span class="at">min =</span> <span class="fl">0.01</span>, <span class="at">max =</span> <span class="fl">0.99</span>, </span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">step =</span> <span class="fl">0.01</span>)</span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">3</span>,</span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"lq"</span>, <span class="at">label=</span><span class="st">"Par. lambda Po(lambda)"</span>, <span class="at">value=</span><span class="dv">5</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">20</span>, </span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">step =</span> <span class="dv">1</span>)</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span>input<span class="sc">$</span>nq</span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span>input<span class="sc">$</span>pq</span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>  q<span class="ot">=</span>input<span class="sc">$</span>qq</span>
<span id="cb223-27"><a href="#cb223-27" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span>input<span class="sc">$</span>lq</span>
<span id="cb223-28"><a href="#cb223-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb223-29"><a href="#cb223-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#n=10;p=0.5;q=0.75;lambda=5</span></span>
<span id="cb223-30"><a href="#cb223-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xx=c(seq(min(a,x),min(b,x),by=0.001))</span></span>
<span id="cb223-31"><a href="#cb223-31" aria-hidden="true" tabindex="-1"></a>  probsB<span class="ot">=</span><span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span>n,n,p)</span>
<span id="cb223-32"><a href="#cb223-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">pbinom</span>(x,n,p),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span><span class="fl">-0.25</span>,n<span class="fl">+0.25</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(probsB<span class="fl">+0.05</span>,<span class="fl">0.1</span>)),</span>
<span id="cb223-33"><a href="#cb223-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función distribución</span><span class="sc">\n</span><span class="st"> B(n="</span>,n,<span class="st">", p="</span>,p,<span class="st">")"</span>),</span>
<span id="cb223-34"><a href="#cb223-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"dbinom(x,"</span>,n,<span class="st">", "</span>,p,<span class="st">")"</span>),<span class="at">yaxt=</span><span class="st">"n"</span>)</span>
<span id="cb223-35"><a href="#cb223-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0 =</span> <span class="fu">qbinom</span>(q,n,p),<span class="at">y0 =</span> <span class="dv">0</span>,<span class="at">x1 =</span> <span class="fu">qbinom</span>(q,n,p),<span class="at">y1 =</span> q,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb223-36"><a href="#cb223-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0 =</span> <span class="fu">qbinom</span>(q,n,p),<span class="at">y0 =</span> q,<span class="at">x1 =</span> <span class="sc">-</span><span class="fl">0.25</span>,<span class="at">y1 =</span> q,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb223-37"><a href="#cb223-37" aria-hidden="true" tabindex="-1"></a>  ytick<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.0</span>,q,<span class="dv">1</span>)</span>
<span id="cb223-38"><a href="#cb223-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span>ytick, <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb223-39"><a href="#cb223-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="fu">qbinom</span>(q,n,p), <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb223-40"><a href="#cb223-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">ppois</span>(x,lambda),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span><span class="fl">-0.25</span>,<span class="fl">2.5</span><span class="sc">*</span>lambda),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="fl">+0.1</span>),</span>
<span id="cb223-41"><a href="#cb223-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función distribución </span><span class="sc">\n</span><span class="st"> Po(lambda="</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb223-42"><a href="#cb223-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"dpois(x, lambda"</span>,lambda,<span class="st">")"</span>),<span class="at">yaxt=</span><span class="st">"n"</span>)</span>
<span id="cb223-43"><a href="#cb223-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0 =</span> <span class="fu">qpois</span>(q,lambda),<span class="at">y0 =</span> <span class="dv">0</span>,<span class="at">x1 =</span> <span class="fu">qpois</span>(q,lambda),<span class="at">y1 =</span> q,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb223-44"><a href="#cb223-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0 =</span> <span class="fu">qpois</span>(q,lambda),<span class="at">y0 =</span> q,<span class="at">x1 =</span> <span class="sc">-</span><span class="fl">0.25</span>,<span class="at">y1 =</span> q,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb223-45"><a href="#cb223-45" aria-hidden="true" tabindex="-1"></a>  ytick<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.0</span>,q,<span class="dv">1</span>)</span>
<span id="cb223-46"><a href="#cb223-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span>ytick, <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb223-47"><a href="#cb223-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="fu">qpois</span>(q,lambda), <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb223-48"><a href="#cb223-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb223-49"><a href="#cb223-49" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_cuantiles1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
</section>
<section id="distribuciones-continuas" class="level2" data-number="4.3">
<h2 data-number="4.3" data-anchor-id="distribuciones-continuas"><span class="header-section-number">4.3</span> Distribuciones continuas</h2>
<section id="distribución-uniforme" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" data-anchor-id="distribución-uniforme"><span class="header-section-number">4.3.1</span> Distribución uniforme</h3>
<p>Una v.a. continua <span class="math inline">\(X\)</span> tiene una distribución uniforme sobre el intervalo real <span class="math inline">\((a,b)\)</span> ,con <span class="math inline">\(a&lt;b\)</span>, si su función de densidad es</p>
<p><span class="math display">\[
f_X(x)=\left\{\begin{array}{ll}
\frac1{b-a}, &amp; \mbox{si } a&lt;x&lt;b,\\ 0,  &amp; \mbox{en cualquier otro caso.}
\end{array}
\right.
\]</span></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Comprobar que el área comprendida entre <span class="math inline">\(f_X\)</span> y la horizontal vale 1.</p>
<div class="exercise-sol">
<p>El área pedida vale: <span class="math display">\[
\int_{-\infty}^{+\infty} f_x(x)\cdot dx=\int_{a}^{b} \frac{1}{b-a} \cdot dx=\left.\frac{x}{b-a}\right]_{x=a}^{x=b}=\frac{b}{b-a}-\frac{a}{b-a}=
\frac{b-a}{b-a}=1.
\]</span></p>
</div>
</div>
<p>Su función de distribución es: <span class="math display">\[
F_X(x)=\left\{\begin{array}{ll} 0,  &amp; \mbox{si } x\leq a,\\
\frac{x-a}{b-a}, &amp; \mbox{si } a&lt;x&lt;b,\\ 1,  &amp; \mbox{si } b\leq x.
\end{array}
\right.
\]</span> Efectivamente:</p>
<ul>
<li>Si <span class="math inline">\(x\leq a\)</span>, entonces <span class="math display">\[F_X(x)=\int_{-\infty}^{x} f(t)\cdot dt= \int_{-\infty}^{x} 0\cdot dt.\]</span></li>
<li>Si <span class="math inline">\(a&lt;x&lt;b\)</span> entonces , <span class="math display">\[
\begin{array}{rl}
F_X(x)&amp;=\displaystyle\int_{-\infty}^{x} f(t)\cdot dt= \int_{-\infty}^{a} 0\cdot dt+\int_{a}^{x} \frac1{b-a} \cdot dt\\
&amp;= \displaystyle 0 +\left.\frac{t}{b-a}\right]_{t=a}^{t=x}= \frac{x}{b-a}-\frac{a}{b-a}=\frac{x-a}{b-a}.
\end{array}
\]</span></li>
<li>Por último si <span class="math inline">\(x\geq b\)</span> entonces,</li>
</ul>
<p><span class="math display">\[
\begin{array}{rl}
F_X(x)&amp;=\displaystyle\int_{-\infty}^{x} f(t) dt=\int_{a}^{b} \frac{1}{b-a} dt=
  \left.  \frac{t}{b-a} \right]_{t=a}^{t=b}
\\&amp;=\displaystyle \frac{b}{b-a}-\frac{a}{b-a}=\frac{b-a}{b-a}=1.
\end{array}
\]</span></p>
<p>Denotaremos a la v.a. <span class="math inline">\(X\)</span> uniforme en el intervalo <span class="math inline">\((a,b)\)</span> por <span class="math inline">\(U(a,b)\)</span>.</p>
<p><strong>Esperanza y varianza para una v.a. <span class="math inline">\(X\)</span> <span class="math inline">\(U(a,b)\)</span></strong></p>
<p>Calculemos la esperanza de <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
\begin{array}{rl}
E(X)&amp;=\displaystyle\int_{-\infty}^{+\infty} x\cdot f_X(x) dx =\int_{a}^{b} x \cdot \frac{1}{b-a} dx =
\left.\frac{x^2}{2\cdot (b-a)}\right]_{x=a}^{x=b}\\
&amp;=\displaystyle \frac{b^2}{2\cdot (b-a)}-\frac{a^2}{2\cdot (b-a)}=
\frac{b^2-a^2}{2\cdot (b-a)}=\frac{(b+a)\cdot (b-a)}{2\cdot (b-a)}=
\frac{b+a}{2}.
\end{array}
\]</span></p>
<p>De cara a calcular su varianza, calculemos primero la esperanza de <span class="math inline">\(X^2\)</span>:</p>
<p><span class="math display">\[
\begin{array}{rl}
E(X^2)&amp;=\displaystyle\int_{-\infty}^{+\infty} x^2 f_X(x) dx=\int_{a}^{b} x^2 \frac1{b-a}
dx =\left.\frac{x^3}{3\cdot (b-a)}\right]_{x=a}^{x=b} \\
&amp;=\displaystyle\frac{b^3-a^3}{3\cdot (b-a)}=\frac{b^2+ab+a^2}{3}.
\end{array}
\]</span></p>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<ul>
<li><p>Demostrad que la igualdad <span class="math inline">\(b^3-a^3=(b-a)\cdot (b^2+ab+a^2)\)</span> es cierta.</p></li>
<li><p>Utilizadla para el cálculo final del valor de <span class="math inline">\(E(X^2)\)</span>.</p></li>
</ul>
</div>
<p>Calculemos <span class="math inline">\(Var(X)\)</span>. <span class="math display">\[
\begin{array}{rl}
Var(X)&amp;=\displaystyle E(X^2)-(E(X))^2=\frac{b^2+ab+a^2}3-\left(\frac{b+a}2\right)^2\\&amp;=\displaystyle
\frac{b^2+ab+a^2}{3}-\frac{b^2+2ab+a^2}{4}\\
&amp;=\displaystyle
\frac{4\cdot (b^2+ab+a^2)-3\cdot (b^2+2ab+a^2)}{4\cdot 3}
\\
&amp;=\displaystyle
\frac{b^2-2ab+a^2}{12}=
\frac{(b-a)^2}{12}.
\end{array}
\]</span></p>
<p><strong>Gráficas <span class="math inline">\(U(0,1)\)</span></strong></p>
<p>El código en <code>R</code> para dibujar la función de densidad y la función de distribución de una distribución <span class="math inline">\(U(0,1)\)</span> es el siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">0</span>;b<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dunif</span>(x,a,b),<span class="at">xlim=</span><span class="fu">c</span>(a<span class="fl">-0.25</span>,b<span class="fl">+0.25</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="dv">1</span><span class="sc">/</span>(b<span class="sc">-</span>a)<span class="sc">+</span><span class="fl">0.05</span>,<span class="fl">0.1</span>)),</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función densidad  U("</span>,a,<span class="st">","</span>,b,<span class="st">")"</span>),</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"dunif(x,"</span>,a,<span class="st">", "</span>,b,<span class="st">")"</span>)</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">punif</span>(x,a,b),<span class="at">xlim=</span><span class="fu">c</span>(a<span class="dv">-1</span>,b<span class="sc">+</span><span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función de distribución U("</span>,a,<span class="st">","</span>,b,<span class="st">")"</span>),</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"punif(x,"</span>,a,<span class="st">", "</span>,b,<span class="st">")"</span>,<span class="at">cex.axis=</span><span class="fl">0.8</span>)</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/grafica_unif10_vista-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Gráficas interactivas <span class="math inline">\(U(a,b)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"a1"</span>, <span class="at">label =</span> <span class="st">"Parámetro a"</span>,</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">9</span>, <span class="at">value =</span><span class="dv">0</span> , <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"b1"</span>, <span class="at">label =</span> <span class="st">"Parámetro b"</span>,</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="dv">10</span>, <span class="at">max =</span> <span class="dv">15</span>, <span class="at">value =</span> <span class="dv">5</span>, <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"x1"</span>, <span class="at">label=</span><span class="st">"x"</span>, <span class="at">value=</span><span class="dv">9</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>, <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">=</span>input<span class="sc">$</span>a1</span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span>input<span class="sc">$</span>b1</span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>input<span class="sc">$</span>x1</span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#a=0;b=1;x=0.25</span></span>
<span id="cb225-24"><a href="#cb225-24" aria-hidden="true" tabindex="-1"></a>  xx<span class="ot">=</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="fu">min</span>(a,x),<span class="fu">min</span>(b,x),<span class="at">by=</span><span class="fl">0.001</span>))</span>
<span id="cb225-25"><a href="#cb225-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dunif</span>(x,a,b),<span class="at">xlim=</span><span class="fu">c</span>(a<span class="fl">-0.25</span>,b<span class="fl">+0.25</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(<span class="dv">1</span><span class="sc">/</span>(b<span class="sc">-</span>a)<span class="sc">+</span><span class="fl">0.05</span>,<span class="fl">0.1</span>)),</span>
<span id="cb225-26"><a href="#cb225-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="st">"blue"</span>,<span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función densidad U("</span>,a,<span class="st">","</span>,b,<span class="st">")"</span>),</span>
<span id="cb225-27"><a href="#cb225-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"dunif(x,"</span>,a,<span class="st">", "</span>,b,<span class="st">")"</span>),<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb225-28"><a href="#cb225-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(a,x,b), <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb225-29"><a href="#cb225-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x=</span><span class="fu">c</span>(a,xx,<span class="fu">min</span>(x,b)),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dunif</span>(xx,a,b),<span class="dv">0</span>),</span>
<span id="cb225-30"><a href="#cb225-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">density=</span><span class="dv">20</span>,<span class="at">col=</span><span class="st">"skyblue"</span>)</span>
<span id="cb225-31"><a href="#cb225-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">punif</span>(x,a,b),<span class="at">xlim=</span><span class="fu">c</span>(a<span class="dv">-1</span>,b<span class="sc">+</span><span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb225-32"><a href="#cb225-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función de distribución U("</span>,a,<span class="st">","</span>,b,<span class="st">")"</span>),</span>
<span id="cb225-33"><a href="#cb225-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"punif(x,"</span>,a,<span class="st">", "</span>,b,<span class="st">")"</span>),<span class="at">xaxt=</span><span class="st">"n"</span>,<span class="at">yaxt=</span><span class="st">"n"</span>)</span>
<span id="cb225-34"><a href="#cb225-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0=</span>x,<span class="at">y0=</span><span class="dv">0</span>,<span class="at">x1=</span>x,<span class="at">y1=</span><span class="fu">punif</span>(x,a,b),<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb225-35"><a href="#cb225-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0=</span>a<span class="fl">-1.01</span>,<span class="at">y0=</span><span class="fu">punif</span>(x,a,b),<span class="at">x1=</span>x,<span class="at">y1=</span><span class="fu">punif</span>(x,a,b),<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb225-36"><a href="#cb225-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">round</span>(<span class="fu">punif</span>(x,a,b),<span class="dv">1</span>),<span class="dv">2</span>), <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb225-37"><a href="#cb225-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(a,x,b), <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb225-38"><a href="#cb225-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb225-39"><a href="#cb225-39" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_uniforme1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Transformación lineal de la v.a. uniforme</strong></p>
<p>Si <span class="math inline">\(X\)</span> sigue una distribución <span class="math inline">\(U(a,b)\)</span> entonces <span class="math inline">\(Z=\frac{X-a}{b-a}\)</span> sigue una distribución <span class="math inline">\(U(0,1)\)</span>.</p>
<div class="prop">
<p><strong>Propiedad: Transformación lineal de la v.a. uniforme</strong></p>
</div>
<p>Sea <span class="math inline">\(X\)</span> una v.a <span class="math inline">\(U(a,b)\)</span>.</p>
<p>Si <span class="math inline">\(scale\not=0\)</span> y <span class="math inline">\(loc\)</span> son dos constantes reales, entonces</p>
<ul>
<li>si <span class="math inline">\(scale&gt;0\)</span>, <span class="math inline">\(T=scale\cdot X+loc\)</span> sigue una ley <span class="math inline">\(U(scale\cdot a +loc,scale\cdot b +loc)\)</span><br>
</li>
<li>si <span class="math inline">\(scale&lt;0\)</span>, <span class="math inline">\(T=scale\cdot X+loc\)</span> sigue una ley <span class="math inline">\(U(scale\cdot b +loc,scale\cdot a +loc)\)</span></li>
</ul>
<div class="dem">
<p><strong>Demostración</strong></p>
<p>Supongamos que <span class="math inline">\(X\)</span> sigue una ley <span class="math inline">\(U(a,b)\)</span>, que <span class="math inline">\(scale&gt;0\)</span> y que <span class="math inline">\(T=scale\cdot X+loc\)</span>. Dejamos el caso <span class="math inline">\(scale&lt;0\)</span> como ejercicio.</p>
<p>La función de distribución de <span class="math inline">\(X\)</span> es: <span class="math display">\[
F_X(x)=P(X\leq x)=\left\{\begin{array}{ll} 0, &amp; \mbox{ si } x\leq a,\\\frac{x-a}{b-a}, &amp; \mbox{ si } a\leq x\leq b, \\1, &amp; \mbox{ si } b\leq x.\end{array}\right.
\]</span></p>
<p>Si <span class="math inline">\(T\)</span> vale <span class="math inline">\(T=scale\cdot X+loc\)</span>, su función de distribución será: <span class="math display">\[
\begin{array}{rl}
F_T(t)&amp;=P(T\leq t)= P(scale\cdot X+ loc\leq t)= P\left(X\leq \frac{t-loc}{scale}\right)=F_X\left(\frac{t-loc}{scale}\right)\\
&amp;=
\left\{\begin{array}{ll} 0, &amp; \mbox{ si } \frac{t-loc}{scale}\leq a\\\frac{\frac{t-loc}{scale}-a}{b-a}, &amp; \mbox{ si } a\leq \frac{t-loc}{scale}\leq b,\\1, &amp; \mbox{ si } b\leq \frac{t-loc}{scale},\end{array}\right. \\ &amp; =
\left\{\begin{array}{ll} 0, &amp; \mbox{ si }  t\leq scale\cdot a +loc, \\
\frac{t-(scale\cdot a+loc)}{scale\cdot (b-a)}, &amp; \mbox{ si } scale\cdot a+loc \leq t\leq scale\cdot b+loc, \\
1, &amp; \mbox{ si } scale\cdot b+loc\leq t, \end{array}\right.\\
&amp; =
\left\{\begin{array}{ll} 0, &amp; \mbox{ si }  t\leq scale\cdot a +loc, \\
\frac{t-(scale\cdot a+loc)}{scale\cdot b+loc-(scale\cdot a+loc)}, &amp; \mbox{ si } scale\cdot a+loc \leq t\leq scale\cdot b+loc, \\
1, &amp; \mbox{ si } scale\cdot b+loc\leq t,\end{array}\right.
\end{array}
\]</span> función que corresponde a la función de distribución de una v.a. <span class="math inline">\(U(scale\cdot a+loc,scale\cdot b+loc)\)</span>, como queríamos demostrar.</p>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una variable <span class="math inline">\(U(0,1)\)</span> y sea <span class="math inline">\(T=scale\cdot X+loc\)</span>:</p>
<ul>
<li><p>Si <span class="math inline">\(T\)</span> es <span class="math inline">\(U(-5,5)\)</span> ¿qué valores toman <span class="math inline">\(scale\)</span> y <span class="math inline">\(loc\)</span>?</p></li>
<li><p>Si <span class="math inline">\(loc=-10\)</span> y <span class="math inline">\(scale=10\)</span> ¿qué distribución de probabilidad sigue <span class="math inline">\(T\)</span>?</p></li>
<li><p>Si <span class="math inline">\(loc=0\)</span> y <span class="math inline">\(scale=-1\)</span> ¿qué distribución probabilidad sigue <span class="math inline">\(T\)</span>?</p></li>
</ul>
</div>
<p><strong>Resumen v.a con distribución uniforme, <span class="math inline">\(U(a,b)\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 45%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Distribución uniforme</th>
<th style="text-align: left;"><span class="math inline">\(U(a,b)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Dominio</td>
<td style="text-align: left;"><span class="math inline">\(D_X=(a,b)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(f_{X}(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll}\frac1{b-a}, &amp; \mbox{si } a&lt;x&lt;b,\\ 0, &amp; \mbox{en cualquier otro caso.}\end{array} \right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} 0, &amp; \mbox{ si } x\leq a\\\frac{x-a}{b-a}, &amp; \mbox{ si } a\leq x\leq b,\\1, &amp; \mbox{ si } b\leq x.\end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)= \frac{a+b}2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=\frac{(b-a)^2}{12}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(v.a.\)</span> <span class="math inline">\(U(a,b)\)</span>. Las funciones <code>dunif(x,a,b)</code> y <code>punif(x,a,b)</code> calculan la función de densidad y de distribución de <span class="math inline">\(X\)</span> en el valor <span class="math inline">\(X\)</span>. Por ejemplo, para <span class="math inline">\(a=-1\)</span>, <span class="math inline">\(b=1\)</span> y <span class="math inline">\(x=0.5\)</span>, los valores <span class="math inline">\(f_X(x)\)</span> y <span class="math inline">\(F_X(x)\)</span> valen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dunif</span>(<span class="at">x=</span><span class="fl">0.5</span>, <span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(<span class="at">q=</span><span class="fl">0.5</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.75</code></pre>
</div>
</div>
<p>La función <code>runif(n,a,b)</code> calcula una muestra de observaciones de tamaño <span class="math inline">\(n\)</span> que sigan la distribución <span class="math inline">\(U(a,b)\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">5</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5502232 -0.4271506 -0.0515360  0.8052209  0.8983523</code></pre>
</div>
</div>
<p>Por defecto, el valor de los parámetros <code>a</code> y <code>b</code> son 0 y 1, respectivamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dunif</span>(<span class="at">x=</span><span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(<span class="at">q=</span><span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.382302539 0.009313886 0.351767001 0.294007361 0.071581515</code></pre>
</div>
</div>
<p><strong>Cálculos con <code>Python</code></strong></p>
<p>Sea <span class="math inline">\(X\)</span> una <span class="math inline">\(v.a.\)</span> <span class="math inline">\(U(-1,1)\)</span>. Tomando como “base” la v.a. <span class="math inline">\(U(0,1)\)</span>, los parámetros <code>loc</code> y <code>scale</code> valen: <code>loc</code><span class="math inline">\(=-1\)</span> y <code>scale</code><span class="math inline">\(=2\)</span>, ya que como hemos visto <span class="math inline">\(X=2*U(0,1)-1=U(-1,1)\)</span>.</p>
<p>En <code>Python</code>, hay que usar dichos parámetros para calcular la función de densidad y de distribución:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> uniform</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>uniform.pdf(<span class="fl">0.5</span>,loc<span class="op">=-</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>uniform.ppf(<span class="fl">0.5</span>,loc<span class="op">=-</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0</code></pre>
</div>
</div>
<p>Para generar una muestra de valores aleatorios, hay que usar la función <code>uniform.rvs</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>uniform.rvs(size<span class="op">=</span><span class="dv">30</span>,loc<span class="op">=-</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([-0.46029716, -0.34498285, -0.2767083 , -0.12818905, -0.96811061,
       -0.31136321, -0.69897762, -0.77363762,  0.29742925,  0.73818078,
       -0.92204654, -0.27979008, -0.73919678, -0.26917781,  0.21037103,
       -0.89429298, -0.18190193,  0.30496477,  0.98543466,  0.76324483,
        0.67251934, -0.82561707, -0.21232468,  0.29661697,  0.80642791,
        0.4196325 ,  0.46232967, -0.32752918, -0.3494945 , -0.92258221])</code></pre>
</div>
</div>
<p>Los valores de los parámetros por defecto son <code>loc</code>=0, <code>scale</code>=1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>uniform.pdf(<span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>uniform.ppf(<span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>uniform.rvs(size<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0.79948668, 0.29038236, 0.25591743, 0.28172549, 0.22280437])</code></pre>
</div>
</div>
</section>
<section id="distribución-exponencial" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" data-anchor-id="distribución-exponencial"><span class="header-section-number">4.3.2</span> Distribución exponencial</h3>
<p><strong>Distribución del tiempo entre dos eventos Poisson</strong></p>
<p>Supongamos que tenemos un proceso Poisson con parámetro <span class="math inline">\(\lambda\)</span> en una unidad de tiempo.</p>
<p>Dado un tiempo <span class="math inline">\(t\)</span>, definimos <span class="math inline">\(N_{t}\)</span> como el número de eventos en el intervalo de tiempo <span class="math inline">\((0,t]\)</span>. La distribución de <span class="math inline">\(N(t)\)</span> es una <span class="math inline">\(Po(\lambda\cdot t)\)</span>. Consideremos la v.a. <span class="math inline">\(T\)</span> como el tiempo transcurrido entre dos eventos Poisson consecutivos.</p>
<p>Sea <span class="math inline">\(t&gt;0\)</span>, entonces</p>
<p><span class="math display">\[
\begin{array}{rl}
P(T&gt;t)&amp;=P(\mbox{Cero eventos en el intervalo}(0,t])\\
&amp;=P(N_{t}=0)=
         \frac{(\lambda t)^0}{0!} e^{-\lambda
         t}=e^{-\lambda t}.
\end{array}
\]</span></p>
<p>Tomando complementarios, la función de distribución de <span class="math inline">\(T\)</span> será: <span class="math display">\[
F_{T}(t)= P(T\leq t)=1-P(T&gt;t)=\left\{\begin{array}{ll} 0, &amp;\mbox{ si } t\leq 0,\\
  1-e^{-\lambda t},&amp; \mbox{ si } t&gt;0,\end{array}\right.
\]</span></p>
<p>Para hallar la función de densidad de <span class="math inline">\(T\)</span>, basta derivar la expresión anterior:</p>
<p><span class="math display">\[
f_{T}(t)=\left\{\begin{array}{ll}\lambda \cdot e^{-\lambda t}, &amp; \mbox{ si }  t&gt;0,\\
0, &amp; \mbox{ si } t\leq 0. \end{array}\right.
\]</span></p>
<p>Llamaremos a la variable <span class="math inline">\(T\)</span> exponencial de parámetro <span class="math inline">\(\lambda\)</span> y la denotaremos por <span class="math inline">\(Exp(\lambda)\)</span>.</p>
<p><strong>Propiedad de la falta de memoria</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una v.a. <span class="math inline">\(Exp(\lambda)\)</span>, entonces</p>
<p><span class="math display">\[P(X&gt;s+t\big|X&gt;s)=P(X&gt;t)\mbox{  para todo } s,t\in \mathbb{R}\]</span></p>
<div class="dem">
<p><strong>Demostración</strong></p>
<p>Si <span class="math inline">\(X\)</span> es una v.a. <span class="math inline">\(Exp(\lambda)\)</span> tenemos que <span class="math inline">\(P(X&gt;x)=1-P(X\leq x)=1-(1-e^{-\lambda\cdot x})=e^{-\lambda\cdot x}\)</span> para todo <span class="math inline">\(x&gt;0\)</span>.</p>
<p>Por tanto, <span class="math display">\[
\begin{array}{rl}
P(X&gt;s+t\big|X&gt;s) &amp; =\frac{P(\{X&gt;s+t\}\cap \{X&gt;s\})}{P(X&gt;s)}=\frac{P(X&gt;s+t)}{P(X&gt;s)}=\frac{e^{-\lambda\cdot (s+t)}}{e^{-\lambda\cdot s}}=
\frac{e^{-\lambda\cdot s}\cdot e^{-\lambda\cdot t} }{e^{-\lambda\cdot s}}\\ &amp; =e^{-\lambda\cdot t}=P(X&gt;t).
\end{array}
\]</span></p>
</div>
<div class="example">
<p><strong>Ejemplo: el clásico problema del peluquero.</strong></p>
<p>Una pequeña peluquería es regentada por un único peluquero. El peluquero está esperando al próximo cliente mientras lee el periódico.</p>
<p>Supongamos que la v.a. <span class="math inline">\(N_T\)</span>, que representa el número de clientes que llegan en el intervalo <span class="math inline">\([0,t)\)</span>, es una <span class="math inline">\(Po(\lambda\cdot t)\)</span> entonces la variable <span class="math inline">\(T\)</span>, tiempo entre dos clientes consecutivos, sigue una ley <span class="math inline">\(Exp(\lambda)\)</span>.</p>
<p>Supongamos que <span class="math inline">\(t\)</span> se mide en horas y que <span class="math inline">\(\lambda=4\)</span> es el promedio de clientes por hora.</p>
<p>Se pide:</p>
<ol type="1">
<li>El tiempo esperado (en horas) y la varianza hasta el siguiente cliente.</li>
<li>¿Cuál es la probabilidad de que nuestro peluquero esté sin clientes (leyendo el periódico) más de 30 minutos (0.5 horas)?</li>
</ol>
<div class="example-sol">
<p>En este ejemplo, la propiedad de la pérdida de memoria significa que por ejemplo, si el peluquero lleva ya esperando más de <span class="math inline">\(s&gt;0.25\)</span> (un cuarto de hora), la probabilidad de que espere <span class="math inline">\(t=1/6\)</span> de hora más (10 minutos) no cambia, sigue siendo <span class="math inline">\(P(T&gt;0.25+1/6|T&gt;0.25)=P(T&gt;1/6).\)</span></p>
<p><strong>Solución de 1. El tiempo esperado (en horas) y la varianza hasta el siguiente cliente.</strong></p>
<p>El tiempo esperado (en horas) hasta el siguiente cliente es</p>
<p><span class="math display">\[
E(X)=\frac{1}{\lambda}=\frac{1}{4}=0.25,
\]</span> y la varianza es <span class="math display">\[
Var(X)=\frac{1}{\lambda^2}=\frac{1}{4^2}=0.0625.
\]</span> <strong>Solución de 2. ¿Cuál es la probabilidad de que nuestro peluquero esté sin clientes (leyendo el periódico) más de 30 minutos (0.5 horas)?</strong></p>
<p>La probabilidad pedida vale: <span class="math display">\[
P(X&gt;0.5)=1-P(X\leq 0.5)=1-(1-e^{-4\cdot 0.5 })=e^{-2}=0.1353353.
\]</span></p>
<p>Usando <code>R</code>, la probabilidad anterior puede ser calculada de la forma siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(<span class="fl">0.5</span>,<span class="at">rate=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7768698</code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pexp</span>(<span class="fl">0.5</span>,<span class="at">rate=</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2231302</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(<span class="fl">0.5</span>,<span class="at">rate=</span><span class="dv">3</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2231302</code></pre>
</div>
</div>
</div>
</div>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Las funciones de densidad y de distribución de una variable exponencial de parámetro <span class="math inline">\(\lambda\)</span> en un valor <code>x</code> se pueden obtener en <code>R</code> usando las funciones <code>dexp(x,lambda)</code> y <code>pexp(x,lambda)</code>, respectivamente. Para generar <code>n</code> valores aleatorios de una variable exponencial de parámetro <span class="math inline">\(\lambda\)</span>, hay que usar la función <code>rexp(n,lambda)</code>. Veamos un ejemplo de aplicación de las tres funciones anteriores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dexp</span>(<span class="fl">0.001</span>,<span class="at">rate=</span><span class="dv">3</span>) <span class="co"># Alerta! No es una probabilidad, es una densidad y puede ser &gt; 1</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.991013</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(<span class="fl">0.5</span>,<span class="at">rate=</span><span class="dv">3</span>) <span class="co"># P(X&lt;0.5)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7768698</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rexp</span>(<span class="dv">10</span>,<span class="dv">3</span>) <span class="co"># Diez tiempos de una exponencial con lambda = 3</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.32072389 0.57998323 0.26019628 0.48896233 0.31041354 0.11871455
 [7] 0.10798351 0.18699902 0.10023100 0.03619832</code></pre>
</div>
</div>
<p><strong>Cálculos con <code>Python</code></strong></p>
<p>Las funciones de densidad y de distribución de una variable exponencial de parámetro <span class="math inline">\(\lambda\)</span> en un valor <code>x</code> se pueden obtener en <code>Python</code> usando las funciones <code>expon.pdf(x,scale=1/lambda)</code> y <code>expon.cdf(x,scale=1/lambda)</code>, respectivamente. Para generar <code>n</code> valores aleatorios de una variable exponencial de parámetro <span class="math inline">\(\lambda\)</span>, hay que usar la función <code>expon.rvs(scale=1/lambda,size=n)</code>. Veamos un ejemplo de aplicación de las tres funciones anteriores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> expon</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>expon.pdf(<span class="fl">0.0001</span>,scale<span class="op">=</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.9991001349865014</code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>expon.cdf(<span class="fl">0.5</span>,scale<span class="op">=</span> <span class="fl">1.</span><span class="op">/</span><span class="dv">3</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7768698398515702</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>expon.rvs(scale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">3</span>,size<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0.3172856 , 0.24314435, 0.11107456, 0.02691132, 0.05826914,
       0.19055301, 1.87109608, 0.368045  , 0.36402383, 0.00541118])</code></pre>
</div>
</div>
<p><strong>Resumen v.a con distribución exponencial, <span class="math inline">\(Exp(\lambda)\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X\)</span></th>
<th style="text-align: left;"><span class="math inline">\(Exp(\lambda)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X=\)</span></td>
<td style="text-align: left;"><span class="math inline">\((0,+\infty)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(f_{X}(x)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} \lambda e^{-\lambda x}, &amp; \mbox{ si } x&gt;0,\\ 0, &amp; \mbox{ si } x\leq 0. \end{array}\right.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\left\{\begin{array}{ll} 0, &amp;\mbox{si } x\leq 0,\\ 1-e^{-\lambda x},&amp; \mbox{si } x&gt;0.\end{array}\right.\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=\frac{1}{\lambda}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=\frac{1}{\lambda^2}\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Gráficas de las funciones de densidad y de distribución de la variable aleatoria <span class="math inline">\(Exp(\lambda=10)\)</span></strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dexp</span>(x,<span class="at">rate=</span>lambda),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fu">round</span>(<span class="fu">qexp</span>(<span class="fl">0.99</span>,<span class="at">rate=</span>lambda,<span class="dv">2</span>),<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.25</span>),</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dexp</span>(<span class="dv">0</span>,lambda)<span class="sc">+</span><span class="fl">0.1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función densidad Exp("</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"dexp(x,rate="</span>,lambda,<span class="st">")"</span>))</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pexp</span>(x,<span class="at">rate=</span>lambda),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fu">qexp</span>(<span class="fl">0.999</span>,<span class="dv">10</span>)),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función de distribución Exp("</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"pexp(x,rate="</span>,lambda,<span class="st">")"</span>))</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Consultad en el manual de <code>Python</code> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.expon.html"><code>scipy.stats</code></a>.</p>
<p>Dibujad la función de densidad y de distribución de una <span class="math inline">\(Exp(\lambda=10).\)</span></p>
</div>
<p><strong>Gráficas interactivas de una variable <span class="math inline">\(Exp(\lambda)\)</span></strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"le"</span>, <span class="at">label =</span> <span class="st">"lambda"</span>,</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="fl">0.1</span>, <span class="at">max =</span> <span class="dv">3</span>, <span class="at">value =</span><span class="dv">1</span> , <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"xe"</span>, <span class="at">label =</span> <span class="st">"X=x"</span>,</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">5</span>, <span class="at">value =</span> <span class="dv">5</span>, <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">4</span>,</span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"pe"</span>, <span class="at">label =</span> <span class="st">"Cuantil p"</span>,</span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span> <span class="fl">0.01</span>, <span class="at">max =</span> <span class="dv">1</span>, <span class="at">value =</span> <span class="fl">0.75</span>, <span class="at">step =</span> <span class="fl">0.01</span>)</span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb269-19"><a href="#cb269-19" aria-hidden="true" tabindex="-1"></a>  lambda<span class="ot">=</span>input<span class="sc">$</span>le</span>
<span id="cb269-20"><a href="#cb269-20" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">=</span>input<span class="sc">$</span>pe</span>
<span id="cb269-21"><a href="#cb269-21" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span>input<span class="sc">$</span>xe</span>
<span id="cb269-22"><a href="#cb269-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lambda=10;p=0.75;x=0.4</span></span>
<span id="cb269-23"><a href="#cb269-23" aria-hidden="true" tabindex="-1"></a>  xx<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,x,<span class="at">by=</span><span class="fl">0.001</span>)</span>
<span id="cb269-24"><a href="#cb269-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb269-25"><a href="#cb269-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dexp</span>(x,<span class="at">rate=</span>lambda),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fu">round</span>(<span class="fu">qexp</span>(<span class="fl">0.999</span>,<span class="at">rate=</span>lambda),<span class="dv">2</span>)),</span>
<span id="cb269-26"><a href="#cb269-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dexp</span>(<span class="dv">0</span>,lambda)<span class="sc">+</span><span class="fl">0.1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb269-27"><a href="#cb269-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función densidad Exp("</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb269-28"><a href="#cb269-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"dexp(x,"</span>,lambda,<span class="st">")"</span>),<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb269-29"><a href="#cb269-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,x,<span class="fu">round</span>(<span class="fu">qexp</span>(<span class="fl">0.999</span>,<span class="at">rate=</span>lambda),<span class="dv">2</span>)),<span class="at">cex.axis=</span><span class="fl">0.8</span>)</span>
<span id="cb269-30"><a href="#cb269-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,xx,<span class="fu">max</span>(x,xx)),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dexp</span>(xx, <span class="at">rate=</span>lambda),<span class="dv">0</span>),</span>
<span id="cb269-31"><a href="#cb269-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">density=</span><span class="dv">20</span>,<span class="at">col=</span><span class="st">"skyblue"</span>)</span>
<span id="cb269-32"><a href="#cb269-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">pexp</span>(x,<span class="at">rate=</span>lambda),<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fu">qexp</span>(<span class="fl">0.999</span>,<span class="at">rate=</span>lambda)<span class="sc">+</span><span class="fl">0.1</span>),</span>
<span id="cb269-33"><a href="#cb269-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),<span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb269-34"><a href="#cb269-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">"Función de distribución Exp("</span>,lambda,<span class="st">")"</span>),</span>
<span id="cb269-35"><a href="#cb269-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"pexp(x,"</span>,lambda,<span class="st">")"</span>),<span class="at">xaxt=</span><span class="st">"n"</span>,<span class="at">yaxt=</span><span class="st">"n"</span>)</span>
<span id="cb269-36"><a href="#cb269-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0=</span><span class="fu">qexp</span>(p,lambda),<span class="at">x1=</span><span class="fu">qexp</span>(p,lambda),<span class="at">y0=</span><span class="dv">0</span>,<span class="at">y1=</span>p,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb269-37"><a href="#cb269-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0=</span><span class="dv">0</span><span class="fl">-0.05</span>,<span class="at">y0=</span>p,<span class="at">x1=</span><span class="fu">qexp</span>(p,lambda),<span class="at">y1=</span>p,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb269-38"><a href="#cb269-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>), <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb269-39"><a href="#cb269-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">at=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">round</span>(<span class="fu">qexp</span>(<span class="fl">0.999</span>,<span class="at">rate=</span>lambda),<span class="dv">2</span>),<span class="at">by=</span><span class="fl">0.1</span>), <span class="at">labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb269-40"><a href="#cb269-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb269-41"><a href="#cb269-41" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_exponencial1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<div class="exercise">
<p><strong>Ejercicio: las bombillas que no envejecen.</strong></p>
<p>Supongamos que compramos una bombilla led que promete un <strong>valor esperado</strong> de duración de 10000 (1.14 años) horas de funcionamiento continuo. Además, nos aseguran que la distribución de <span class="math inline">\(X\)</span>, el número de horas de funcionamiento continuo de una bombilla led, sigue una ley exponencial.</p>
<ul>
<li>Si <span class="math inline">\(X\)</span> es <span class="math inline">\(Exp(\lambda)\)</span> ¿cuál es el valor del parámetro <span class="math inline">\(\lambda\)</span>?.</li>
<li>¿Cuál es la probabilidad de que una bombilla led ilumine más de 2 años?</li>
<li>Supongamos que ya tengo una bombilla led funcionando 1 año ¿Cuál es la probabilidad de que dure dos años más?</li>
<li>¿Cuál es la varianza de la duración en horas de este tipo de bombillas?</li>
</ul>
</div>
</section>
<section id="distribución-normal-o-gaussiana" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" data-anchor-id="distribución-normal-o-gaussiana"><span class="header-section-number">4.3.3</span> Distribución normal o Gaussiana</h3>
<p>Una de las variables aleatorias continua más populares es la llamada distribución normal o <a href="https://es.wikipedia.org/wiki/Distribuci%C3%B3n_normal">Gaussiana</a>.</p>
<p><l class="def"> <strong>Distribución normal o de Gauss</strong></l> Diremos que una v.a. <span class="math inline">\(X\)</span> sigue una ley normal de parámetros <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> y la denotaremos por <span class="math inline">\(N(\mu,\sigma)\)</span> si tiene por función de densidad:</p>
<p><span class="math display">\[
f_{X}(x)=\frac1{\sqrt{2\cdot\pi\cdot\sigma^2}}
e^{-\frac{1}{2}\cdot\left(\frac{x-\mu}{\sigma}\right)^2},
\]</span> para todo <span class="math inline">\(x\in \mathbb{R}.\)</span></p>
<p>La gráfica de esta función de densidad es conocida como <strong>campana de Gauss.</strong></p>
<p>La v.a. normal con <span class="math inline">\(\mu=0\)</span> y <span class="math inline">\(\sigma=1\)</span> recibe el nombre de normal estándar y se suele denotar por la letra <span class="math inline">\(Z\sim N(0,1)\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x),<span class="at">main=</span><span class="st">"Función de densidad de una normal estándar"</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.9</span>,<span class="fl">3.9</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/normaldensidad1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><l class="prop"> <strong>Propiedades de la función de densidad de la distribución normal</strong></l></p>
<p>Sea <span class="math inline">\(X\)</span> una v.a. <span class="math inline">\(N(\mu,\sigma)\)</span> y sean <span class="math inline">\(f_{X}\)</span> su función de densidad y <span class="math inline">\(F_X(x)=\displaystyle\int_{-\infty}^x f_X(t)\, dt\)</span> su función de distribución. Entonces:</p>
<ol type="1">
<li>La función <span class="math inline">\(f_{X}\)</span> verifica todas las propiedades de las funciones de densidad: <span class="math inline">\(f_X(x)&gt;0\)</span>, para todo <span class="math inline">\(x\in\mathbb{R}\)</span> y <span class="math inline">\(\displaystyle\int_{-\infty}^\infty f_X(x)\,dx=1\)</span>.</li>
<li>La función <span class="math inline">\(f_X(x)\)</span> es simétrica respecto de la recta <span class="math inline">\(x=\mu\)</span>: <span class="math inline">\(f_{X}(\mu-x)=f_{X}(\mu+x)\)</span>, para todo <span class="math inline">\(x\in\mathbb{R}\)</span>.</li>
<li><span class="math inline">\(f_{X}\)</span> tiene un único máximo absoluto en <span class="math inline">\(x=\mu\)</span> que vale <span class="math inline">\(f_X(\mu)=\frac1{\sqrt{2\pi\sigma^2}}\)</span>.</li>
<li>Si <span class="math inline">\(F_{X}\)</span> es la función de distribución de <span class="math inline">\(X\)</span>, entonces <span class="math inline">\(F_{X}(\mu+x)=1-F_{X}(\mu-x)\)</span>, para todo <span class="math inline">\(x\in\mathbb{R}\)</span>.</li>
<li>En particular, si <span class="math inline">\(Z\)</span> es una <span class="math inline">\(N(0,1)\)</span>, entonces <span class="math inline">\(F_{Z}(-x)=1-F_{Z}(x)\)</span> para todo <span class="math inline">\(x\in\mathbb{R}\)</span>.</li>
<li><span class="math inline">\(Z=\frac{X-\mu}{\sigma}\)</span> es una v.a. <span class="math inline">\(N(0,1)\)</span> y <span class="math inline">\(X=\sigma\cdot Z+\mu\)</span> es una <span class="math inline">\(N(\mu,\sigma)\)</span> donde <span class="math inline">\(Z\)</span> es la normal estándar.</li>
<li>La función <span class="math inline">\(f_X\)</span> es continua.</li>
<li><span class="math inline">\(\lim\limits_{x\to+\infty}f(x)=\lim\limits_{x\to-\infty}f(x)=0\)</span> es decir tiene asíntota horizontal a derecha e izquierda.</li>
<li><span class="math inline">\(f\)</span> es estrictamente creciente si <span class="math inline">\(x&lt;\mu\)</span> y decreciente si <span class="math inline">\(x&gt;\mu\)</span>.</li>
<li>Tiene dos puntos de inflexión en <span class="math inline">\(x=\mu+\sigma\)</span> y en <span class="math inline">\(x=\mu-\sigma\)</span>.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="3_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Función de distribución de la N(0,1)</strong></p>
<p>Su función de distribución es, como sabemos:</p>
<p><span class="math display">\[
F(x)=\displaystyle\int_{-\infty}^{x} {1\over{\sqrt{2\cdot \pi}}}
e^{-{{x^2}\over 2}} dt.
\]</span></p>
<p>La función <span class="math inline">\(F(x)\)</span> no tiene ninguna expresión algebraica “decente”. Es por esta razón, y por comodidad, que esta función está tabulada o hay que calcularla usando un software estadístico.</p>
<p><strong>Resumen v.a con distribución normal, <span class="math inline">\(N(\mu,\sigma)\)</span></strong></p>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"><span class="math inline">\(X\)</span></th>
<th style="text-align: left;"><span class="math inline">\(N(\mu,\sigma)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(D_X=\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\mathbb{R}=(-\infty,+\infty)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(f_{X}(x)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(=\frac{1}{\sqrt{2\pi\cdot\sigma^2}}\cdot e^{\frac{-(x-\mu)^2}{2\cdot \sigma^2}}\mbox{ para todo }x\in \mathbb{R}.\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(F_X(x)=P(X\leq X)=\)</span></td>
<td style="text-align: left;">Utilizad la función de <code>R</code> <code>pnorm(x,mean=mu,sd=sigma)</code> o la función correspondiente en <code>Python</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="math inline">\(E(X)=\mu.\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Var(X)=\sigma^2.\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Cálculos con <code>R</code></strong></p>
<p>Las funciones que calculan la función de densidad y de distribución de una variable <span class="math inline">\(N(\mu,\sigma)\)</span> en un valor <code>x</code> son <code>dnorm(x,mean=mu,sd=sigma)</code> y <code>pnorm(x,mean=mu,sd=sigma)</code>, respectivamente. Por ejemplo, para una variable <span class="math inline">\(X\sim N(\mu=1,\sigma=2)\)</span>, la función de densidad <span class="math inline">\(f_X(2)\)</span> se puede calcular de la forma siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="dv">2</span>,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1760327</code></pre>
</div>
</div>
<p>y la función de distribución <span class="math inline">\(F_X(2) = P(X\leq 2)\)</span> de la forma siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">2</span>,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6914625</code></pre>
</div>
</div>
<p>Si queremos calcular el cuantil <span class="math inline">\(x_{q}\)</span> de una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span> que, recordemos es el valor que cumple que <span class="math inline">\(P(X\leq x_{q})=q\)</span>, tenemos que usar la función <code>qnorm(q,mean=mu,sd=sigma)</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.95</span>,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.289707</code></pre>
</div>
</div>
<p>Para generar <code>n</code> valores aleatorios de una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span>, hay que usar la función <code>rnorm(n,mean=mu,sd=sigma)</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">5</span>,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.7813382  0.7320555  2.7209162  2.9098518  2.5098235</code></pre>
</div>
</div>
<p><strong>Cálculos con <code>Python</code></strong></p>
<p>Para poder trabajar con una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span> en <code>Python</code>, tenemos que importar <code>norm</code> de <code>scipy.stas</code>. Los parámetros <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> son <code>loc</code> y <code>scale</code>, respectivamente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Por ejemplo, para una variable <span class="math inline">\(X\sim N(\mu=1,\sigma=2)\)</span>, la función de densidad <span class="math inline">\(f_X(2)\)</span> se puede calcular de la forma siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>norm.pdf(<span class="dv">2</span>,loc<span class="op">=</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.17603266338214976</code></pre>
</div>
</div>
<p>y la función de distribución <span class="math inline">\(F_X(2) = P(X\leq 2)\)</span>, de la forma siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>norm.cdf(<span class="dv">2</span>,loc<span class="op">=</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.6914624612740131</code></pre>
</div>
</div>
<p>Si queremos calcular el cuantil <span class="math inline">\(x_{q}\)</span> de una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span>, tenemos que usar la función <code>norm.ppf(q,loc=mu,scale=sigma)</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>norm.ppf(<span class="fl">0.95</span>,loc<span class="op">=</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4.289707253902945</code></pre>
</div>
</div>
<p>Para generar <code>n</code> valores aleatorios de una distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span>, hay que usar la función <code>norm.rvs(loc=mu,scale=sigma,size=n)</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>norm.rvs(loc<span class="op">=</span><span class="dv">1</span>,scale<span class="op">=</span><span class="dv">2</span>,size<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([ 0.00632078,  0.50263671,  0.41757297,  0.84675575, -2.82744019])</code></pre>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Consultad <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html">SciPy.org</a> para dibujar las funciones de densidad y de distribución con <code>Python</code>.</p>
</div>
<p><strong>Gráficas interactivas usando los parámetros de la distribución normal</strong></p>
<p>Para ejecutar el siguiente gráfico interactivo, solamente tienes que cargar el paquete <code>shiny</code> en tu ordenador y luego copiar/pegar las siguientes instrucciones. De este modo podrás observar los cambios en las distribuciones variando los parámetros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidPage</span>(</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fluidRow</span>(</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">3</span>,</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"m1"</span>, <span class="at">label =</span> <span class="st">"mu1"</span>,</span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">min =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">max =</span> <span class="dv">10</span>, <span class="at">value =</span><span class="dv">0</span> , <span class="at">step =</span> <span class="fl">0.05</span>)</span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">3</span>,</span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"s1"</span>, <span class="at">label =</span> <span class="st">"sigma1"</span>,</span>
<span id="cb288-9"><a href="#cb288-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span><span class="fl">0.1</span>, <span class="at">max =</span> <span class="dv">5</span>, <span class="at">value =</span> <span class="dv">1</span>, <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb288-10"><a href="#cb288-10" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb288-11"><a href="#cb288-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">3</span>,</span>
<span id="cb288-12"><a href="#cb288-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">sliderInput</span>(<span class="st">"m2"</span>, <span class="at">label=</span><span class="st">"mu2"</span>, <span class="at">value=</span><span class="dv">4</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">max =</span> <span class="dv">10</span>, <span class="at">step =</span> <span class="fl">0.05</span>)</span>
<span id="cb288-13"><a href="#cb288-13" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb288-14"><a href="#cb288-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column</span>(<span class="dv">3</span>,</span>
<span id="cb288-15"><a href="#cb288-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sliderInput</span>(<span class="st">"s2"</span>, <span class="at">label =</span> <span class="st">"sigma2"</span>,</span>
<span id="cb288-16"><a href="#cb288-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">min =</span><span class="fl">0.1</span>, <span class="at">max =</span> <span class="dv">5</span>, <span class="at">value =</span> <span class="dv">1</span>, <span class="at">step =</span> <span class="fl">0.1</span>)</span>
<span id="cb288-17"><a href="#cb288-17" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb288-18"><a href="#cb288-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb288-19"><a href="#cb288-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb288-20"><a href="#cb288-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb288-21"><a href="#cb288-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-22"><a href="#cb288-22" aria-hidden="true" tabindex="-1"></a><span class="fu">renderPlot</span>({</span>
<span id="cb288-23"><a href="#cb288-23" aria-hidden="true" tabindex="-1"></a>  m1<span class="ot">=</span>input<span class="sc">$</span>m1</span>
<span id="cb288-24"><a href="#cb288-24" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">=</span>input<span class="sc">$</span>m2</span>
<span id="cb288-25"><a href="#cb288-25" aria-hidden="true" tabindex="-1"></a>  s1<span class="ot">=</span>input<span class="sc">$</span>s1</span>
<span id="cb288-26"><a href="#cb288-26" aria-hidden="true" tabindex="-1"></a>  s2<span class="ot">=</span>input<span class="sc">$</span>s2</span>
<span id="cb288-27"><a href="#cb288-27" aria-hidden="true" tabindex="-1"></a>  mins2<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(s1<span class="sc">^</span><span class="dv">2</span>,s2<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb288-28"><a href="#cb288-28" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">min</span>(<span class="fu">c</span>(<span class="fu">qnorm</span>(<span class="fl">0.01</span>,m1,s1),<span class="fu">qnorm</span>(<span class="fl">0.01</span>,m2,s2)))</span>
<span id="cb288-29"><a href="#cb288-29" aria-hidden="true" tabindex="-1"></a>M<span class="ot">=</span><span class="fu">max</span>(<span class="fu">c</span>(<span class="fu">qnorm</span>(<span class="fl">0.99</span>,m1,s1),<span class="fu">qnorm</span>(<span class="fl">0.99</span>,m2,s2)))</span>
<span id="cb288-30"><a href="#cb288-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-31"><a href="#cb288-31" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,m1,s1),<span class="at">xlim=</span><span class="fu">c</span>(m,M),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>mins2)),<span class="at">col=</span><span class="st">"red"</span>,<span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb288-32"><a href="#cb288-32" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"toplef"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">N</span>(mu[<span class="dv">1</span>],sigma[<span class="dv">1</span>])),</span>
<span id="cb288-33"><a href="#cb288-33" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">expression</span>(<span class="fu">N</span>(mu[<span class="dv">2</span>],sigma[<span class="dv">2</span>]))),</span>
<span id="cb288-34"><a href="#cb288-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb288-35"><a href="#cb288-35" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x,m2,s2),<span class="at">add=</span><span class="cn">TRUE</span>,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb288-36"><a href="#cb288-36" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!--[![](Images/noshinyImages/interactiva_normal1.png)](https://joanby.shinyapps.io/DistribucionesNotables/)-->
<p><strong>Transformaciones lineales de variables aleatorias normales</strong></p>
<p><l class="prop"> <strong>Propiedad: transformación lineal la distribución normal</strong> </l></p>
<p>Sea <span class="math inline">\(X\)</span> una variable <span class="math inline">\(N(\mu,\sigma)\)</span> entonces la variable <span class="math inline">\(Y=a X+b\)</span> con <span class="math inline">\(a\not=0,b\in\mathbb{R}\)</span> tiene distribución <span class="math inline">\(N(a\mu+b, |a|\cdot\sigma)\)</span></p>
<p>En el caso particular en que <span class="math inline">\(a=\frac1{\sigma}\)</span> y <span class="math inline">\(b= \frac{-\mu}{\sigma}\)</span> obtenemos la v.a. <span class="math inline">\(Z={{X-\mu}\over {\sigma}}\)</span>, que se distribuye según una normal estándar <span class="math inline">\(N(0,1)\)</span>, es decir <span class="math inline">\(E(X)=0\)</span> y <span class="math inline">\(Var(X)=1\)</span>. Dicha operación se denomina estandarización de la distribución normal.</p>
<p>La propiedad anterior nos permite calcular la función de distribución de cualquier v.a. <span class="math inline">\(N(\mu,\sigma)\)</span> a partir de la función de distribución de la distribución <span class="math inline">\(Z=N(0,1)\)</span>: <span class="math display">\[
F_X(x)=P(X\leq x)=P\left(\frac{X-\mu}{\sigma}\leq \frac{x-\mu}{\sigma}\right)=P\left(Z\leq \frac{x-\mu}{\sigma}\right)=F_Z \left(\frac{x-\mu}{\sigma}\right).
\]</span> Entonces, basta conocer la manera de calcular <span class="math inline">\(F_Z\)</span> para poder calcular <span class="math inline">\(F_X\)</span>, para <span class="math inline">\(X=N(\mu,\sigma)\)</span>, para cualquier <span class="math inline">\(\mu\)</span> y cualquier <span class="math inline">\(\sigma&gt;0\)</span>.</p>
<p><strong>Propiedades de la distribución normal estándar</strong></p>
<p>Sea <span class="math inline">\(Z\)</span> una <span class="math inline">\(N(0,1)\)</span>.</p>
<p>En este caso, <span class="math inline">\(\mu=0\)</span> y <span class="math inline">\(\sigma=1\)</span>. Podemos escribir algunas de las propiedades vistas para una distribución normal cualquiera de la forma siguiente:</p>
<ul>
<li>La propiedad <span class="math inline">\(f_X(\mu-x)=f_X(\mu+x)\)</span> se traduce a <span class="math inline">\(f_Z(-x)=f_Z(x)\)</span></li>
<li>La propiedad <span class="math inline">\(F_X(\mu-x)=1-F_X(\mu+x)\)</span> se traduce a <span class="math inline">\(F_Z(-x)=1-F(x).\)</span></li>
<li>Dado <span class="math inline">\(\delta&gt;0\)</span>, <span class="math display">\[
P(-\delta\leq Z \leq \delta)=F_{Z}(\delta)-F_{Z}(-\delta)=F_Z(\delta)-(1-F_Z(\delta))=
2\cdot F_Z(\delta)-1.
\]</span></li>
</ul>
<div class="exercise">
<p><strong>Ejercicio: cálculos con la distribución normal estándar</strong></p>
<p>Sea <span class="math inline">\(Z\)</span> una distribución <span class="math inline">\(N(0,1)\)</span>. Calcular las siguientes probabilidades en función de <span class="math inline">\(F_Z\)</span>:</p>
<ul>
<li><span class="math inline">\(P(-4\leq Z \leq 4).\)</span></li>
<li><span class="math inline">\(P(-2\leq Z \leq 2).\)</span></li>
<li><span class="math inline">\(P(Z\leq -2).\)</span></li>
<li><span class="math inline">\(P( Z \leq 2).\)</span></li>
<li><span class="math inline">\(P( Z \geq 2).\)</span></li>
<li><span class="math inline">\(P( Z &gt; 2).\)</span></li>
<li><span class="math inline">\(P( Z = 2).\)</span></li>
<li><span class="math inline">\(P( Z \geq -2).\)</span></li>
</ul>
<div class="example-sol">
<p>Resolución:</p>
<ul>
<li><span class="math inline">\(P(-4\leq Z \leq 4)=F_{Z}(4)-F_{Z}(-4)=2\cdot F_Z(4)-1\)</span>.</li>
<li><span class="math inline">\(P(-2\leq Z \leq 2)=F_{Z}(2)-F_{Z}(-2)=2\cdot F_Z(2)-1\)</span>.</li>
<li><span class="math inline">\(P(Z\leq -2)=F_Z(-2)=1-F_Z(2)\)</span>.</li>
<li><span class="math inline">\(P( Z \leq 2)=F_{Z}(2)\)</span>.</li>
<li><span class="math inline">\(P( Z \geq 2)=1-P(Z&lt;2)=1-F_{Z}(2)\)</span>.</li>
<li><span class="math inline">\(P( Z &gt; 2)=1-P(Z\leq 2)=1-F_{Z}(2)\)</span>.</li>
<li><span class="math inline">\(P( Z = 2)=0\)</span> ya que es una distribución continua.</li>
<li><span class="math inline">\(P( Z \geq -2)=1-P(Z&lt; -2)=1-F_{Z}(-2)=1-(1-F_Z(2))=F_Z(2).\)</span></li>
</ul>
</div>
</div>
<p><strong>Cálculo de probabilidades de la distribución normal <span class="math inline">\(X=N(\mu,\sigma)\)</span> en un intervalo usando la distribución <span class="math inline">\(Z=N(0,1)\)</span></strong></p>
<p>Para hallar la probabilidad de que <span class="math inline">\(X\)</span> esté en un intervalo <span class="math inline">\((a,b)\)</span> cualquiera, podemos usar la función de distribución de <span class="math inline">\(Z\)</span> de la siguiente manera: <span class="math display">\[
\begin{array}{ll}
P(a&lt;X&lt;b)&amp;=P\left(\frac{a-\mu}{\sigma}&lt;\frac{X-\mu}{\sigma}&lt;\frac{b-\mu}{\sigma}\right)= \\
&amp;=P\left(\frac{a-\mu}{\sigma}&lt;Z&lt;\frac{b-\mu}{\sigma}\right)=F_{Z}\left(\frac{b-\mu}{\sigma}\right)-
F_{Z}\left(\frac{a-\mu}{\sigma}\right).
\end{array}
\]</span></p>
<p>Para el caso particular en que el intervalo esté centrado en la media <span class="math inline">\(\mu\)</span>, o sea existe un valor <span class="math inline">\(\delta&gt;0\)</span> tal que <span class="math inline">\((a,b)=(\mu-\delta,\mu+\delta)\)</span>, obtenemos: <span class="math display">\[
P\left(\mu-\delta\leq X \leq\mu+\delta\right)=2\cdot  F_Z\left(\frac{\delta}{\sigma}\right)-1.
\]</span></p>
<div class="exercise">
<p><strong>Ejercicio: cálculo de probabilidades de una distribución normal</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una normal con media <span class="math inline">\(2\)</span> y varianza <span class="math inline">\(4\)</span>. Calcular</p>
<ul>
<li><span class="math inline">\(P(1&lt; X&lt; 2).\)</span></li>
<li><span class="math inline">\(P(X&gt;3).\)</span></li>
</ul>
<div class="example-sol">
<p><strong>Solución</strong></p>
<p>La primera probabilidad se calcula de la forma siguiente: <span class="math display">\[
\begin{array}{ll}
P(1&lt; X&lt; 2)&amp;= P\left(\frac{1-2}{2}&lt;\frac{X-2}{2}&lt;\frac{2-2}{2}\right)= P\left(\frac{-1}{2}&lt;Z&lt;0\right)\\
&amp;= F_{Z}(0)-F_{Z}(-0.5)=\frac12-1+F_{Z}(0.5)=-\frac12+F_Z(0.5).
\end{array}
\]</span></p>
<p>La segunda probabilidad se calcular de la forma siguiente: <span class="math display">\[
P(X&gt;3)=P\left(\frac{X-2}2&gt;\frac{3-2}{2}\right)=P(Z&gt;0.5)=1-F_{Z}(0.5).
\]</span></p>
</div>
</div>
<div class="exercise">
<p><strong>Ejercicio</strong></p>
<p>Sea <span class="math inline">\(X\)</span> una normal con media <span class="math inline">\(2\)</span> y varianza <span class="math inline">\(4\)</span>. Calcular usando <code>R</code> y con <code>Python</code> las probabilidades siguientes:</p>
<ul>
<li><span class="math inline">\(P(1&lt; X&lt; 2).\)</span></li>
<li><span class="math inline">\(P(X&gt;3).\)</span></li>
</ul>
<div class="example-sol">
<p><strong>Solución usando <code>R</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">2</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">2</span>) <span class="co">#P(1&lt; X&lt; 2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1914625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">3</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">2</span>,<span class="at">lower.tail =</span><span class="cn">FALSE</span>) <span class="co">#P(X&gt;3)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3085375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">3</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">2</span>,<span class="at">lower.tail=</span><span class="cn">TRUE</span>) <span class="co">#P(X&gt;3) = 1-P(X&lt;=3)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3085375</code></pre>
</div>
</div>
<p><strong>Solución usando <code>Python</code></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>norm.cdf(<span class="dv">2</span>,loc<span class="op">=</span><span class="dv">2</span>,scale<span class="op">=</span><span class="dv">2</span>)<span class="op">-</span>norm.cdf(<span class="dv">1</span>,loc<span class="op">=</span><span class="dv">2</span>,scale<span class="op">=</span><span class="dv">2</span>) <span class="co">#P(1&lt; X&lt; 2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.19146246127401312</code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>norm.cdf(<span class="dv">3</span>,loc<span class="op">=</span><span class="dv">2</span>,scale<span class="op">=</span><span class="dv">2</span>) <span class="co">#P(X&gt;3) = 1-P(X&lt;=3)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.3085375387259869</code></pre>
</div>
</div>
</div>
</div>
<p><strong>La distribución normal aproxima otras distribuciones</strong></p>
<p>En los temas que siguen veremos como, bajo determinadas condiciones,</p>
<ul>
<li>la distribución normal puede aproximar la distribución binomial,</li>
<li>la distribución normal puede aproximar la distribución Poisson</li>
<li>la distribución normal es la distribución límite de la media aritmética de una muestra de variables aleatorias.</li>
</ul>


</section>
</section>

 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Variables Aleatorias</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Variables Aleatorias. Complementos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
 <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Introducción a la probabilidad para el análisis de datos: Con R y python.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Este libro se ha creado con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>